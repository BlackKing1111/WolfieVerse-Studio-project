try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="5b584533-a60b-47be-953e-d2538fe5df11",e._sentryDebugIdIdentifier="sentry-dbid-5b584533-a60b-47be-953e-d2538fe5df11")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1225],{49e3:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[id]/settings",function(){return a(85865)}])},85865:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>eF});var s=a(74848),r=a(96540),l=a(86715),n=a(13368),i=a.n(n),d=a(91106),o=a.n(d),c=a(66010),x=a(80204),m=a(59345),u=a(50802),g=a(62636),h=a(99965);function p(e){let{isOpen:t,onClose:a,onSubmit:l,error:n}=e,[i,d]=(0,r.useState)(""),[o,c]=(0,r.useState)(!1),x=async e=>{e.preventDefault(),c(!0);try{await l(i)}finally{c(!1)}};return((0,r.useEffect)(()=>{t||(d(""),c(!1))},[t]),t)?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50","data-sentry-component":"AddDomainModal","data-sentry-source-file":"AddDomainModal.tsx",children:(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Add Custom Domain"}),(0,s.jsxs)("form",{onSubmit:x,children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Domain"}),(0,s.jsx)("input",{type:"text",value:i,onChange:e=>d(e.target.value),placeholder:"example.com or app.example.com",disabled:o,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed"}),n&&(0,s.jsx)("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:n})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{type:"button",onClick:a,disabled:o,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:o,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Adding...":"Add Domain"})]})]})]})})}):null}function y(e){let{isOpen:t,onClose:a,domain:l}=e,{subdomain:n,domainName:i}=(0,x.i)(l),d=!n,[o,c]=(0,r.useState)({}),[m,u]=(0,r.useState)(!1),[h,p]=(0,r.useState)(!1),[y,b]=(0,r.useState)(!1);(0,r.useEffect)(()=>{t&&l?(p(!0),fetch("/api/domains/is-owner?domain=".concat(encodeURIComponent(l))).then(e=>e.json()).then(e=>{u(e.isOwner||!1)}).catch(e=>{console.error("Failed to check domain ownership:",e),u(!1)}).finally(()=>{p(!1)})):t||(u(!1),p(!1),b(!1))},[t,l]);let j=async(e,t)=>{try{await navigator.clipboard.writeText(e),c(e=>({...e,[t]:!0})),setTimeout(()=>{c(e=>({...e,[t]:!1}))},2e3)}catch(e){console.error("Failed to copy text:",e)}},f=async()=>{b(!0);try{let e=d?"@":n,t=await fetch("/api/domains/create-record?domain=".concat(encodeURIComponent(i)),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:d?"A":"CNAME",name:e,value:d?"52.6.250.82":"cname.aiagentconnections.com",ttl:3600})});if(201===t.status)g.Ay.success("DNS record updated successfully!"),a();else{let e=await t.json();throw Error(e.error||"Failed to update DNS record")}}catch(e){g.Ay.error(e.message||"Failed to update DNS record")}finally{b(!1)}};return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50","data-sentry-component":"DomainInstructionsModal","data-sentry-source-file":"DomainInstructionsModal.tsx",children:(0,s.jsx)("div",{className:"bg-gray-800 rounded-lg max-w-lg w-full",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-xl font-medium text-white mb-4",children:"DNS Instructions"}),(0,s.jsxs)("div",{className:"bg-gray-700 rounded-md p-4 mb-6",children:[(0,s.jsx)("p",{className:"text-gray-300 mb-4",children:"Add the following DNS record to your domain:"}),d?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-lg font-medium text-white mb-2",children:"A Record:"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Name:"}),(0,s.jsxs)("div",{className:"flex items-center bg-gray-600 rounded",children:[(0,s.jsx)("p",{className:"text-white font-mono text-sm p-2 flex-1",children:"@"}),(0,s.jsx)("button",{onClick:()=>j("@","name"),className:"px-2 hover:text-gray-200 text-gray-400",children:o.name?(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Value:"}),(0,s.jsxs)("div",{className:"flex items-center bg-gray-600 rounded",children:[(0,s.jsx)("p",{className:"text-white font-mono text-sm p-2 flex-1 break-all",children:"52.6.250.82"}),(0,s.jsx)("button",{onClick:()=>j("52.6.250.82","value"),className:"px-2 hover:text-gray-200 text-gray-400",children:o.value?(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})})]})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-lg font-medium text-white mb-2",children:"CNAME Record:"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Name:"}),(0,s.jsxs)("div",{className:"flex items-center bg-gray-600 rounded",children:[(0,s.jsx)("p",{className:"text-white font-mono text-sm p-2 flex-1 break-all",children:n.toLowerCase()}),(0,s.jsx)("button",{onClick:()=>j(n.toLowerCase(),"cname-name"),className:"px-2 hover:text-gray-200 text-gray-400",children:o["cname-name"]?(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Value:"}),(0,s.jsxs)("div",{className:"flex items-center bg-gray-600 rounded",children:[(0,s.jsx)("p",{className:"text-white font-mono text-sm p-2 flex-1 break-all",children:"cname.aiagentconnections.com"}),(0,s.jsx)("button",{onClick:()=>j("cname.aiagentconnections.com","cname-value"),className:"px-2 hover:text-gray-200 text-gray-400",children:o["cname-value"]?(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})})]})]})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{children:!h&&m&&(0,s.jsx)("button",{onClick:f,disabled:y,className:"bg-green-600 hover:bg-green-700 text-white font-medium rounded-md px-6 py-2 text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:y?"Updating...":"Do it for me"})}),(0,s.jsx)("button",{onClick:a,className:"bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md px-6 py-2 text-sm transition-colors",children:"Close"})]})]})})}):null}function b(e){let{isOpen:t,onClose:a,onConfirm:l,isCloning:n}=e,[i,d]=(0,r.useState)(!1),[o,c]=(0,r.useState)("create");return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50","data-sentry-component":"CloneProjectModal","data-sentry-source-file":"CloneProjectModal.tsx",children:(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"Clone Project"}),(0,s.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:"Create a copy of this project."}),(0,s.jsx)("div",{className:"space-y-4 mb-6",children:(0,s.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600 rounded",checked:i,onChange:e=>d(e.target.checked)}),(0,s.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:"Include chat history"})]})}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md",disabled:n,children:"Cancel"}),(0,s.jsx)("button",{type:"button",onClick:()=>l(i,o),disabled:n,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md flex items-center ".concat(n?"opacity-50 cursor-not-allowed":""),children:n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Cloning Project..."]}):"Clone Project"})]})]})})}):null}function j(e){let{isOpen:t,onClose:a,onConfirm:l,projectId:n,isInternalDatabase:i}=e,[d,o]=(0,r.useState)(""),[c,x]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1),[g,h]=(0,r.useState)(!1),[p,y]=(0,r.useState)(null),[b,j]=(0,r.useState)(null),f=i&&0===p,v=f?"DELETE":"DETACH";(0,r.useEffect)(()=>{t&&(o(""),x(!1),u(!1),j(null),i&&n?(h(!0),fetch("/api/projects/database-usage?projectId=".concat(n)).then(e=>e.json()).then(e=>{e.error?j(e.error):y(e.otherProjectsCount)}).catch(e=>{console.error("Error fetching database usage:",e),j("Failed to check database usage")}).finally(()=>{h(!1)})):y(null))},[t,i,n]);let k=async()=>{if(c){u(!0);try{await l(f)}finally{u(!1)}}};return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50","data-sentry-component":"DetachSupabaseModal","data-sentry-source-file":"DetachSupabaseModal.tsx",children:(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full",children:(0,s.jsxs)("div",{className:"p-6",children:[g?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsxs)("svg",{className:"animate-spin h-8 w-8 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):b?(0,s.jsx)("div",{className:"text-red-600 dark:text-red-400 mb-4",children:b}):i?null!==p&&p>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-yellow-600 dark:text-yellow-400 mb-4",children:"Detach Database"}),(0,s.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:"This will remove the database connection from this application."}),(0,s.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-700 rounded-md p-3 mb-4",children:(0,s.jsxs)("p",{className:"text-blue-800 dark:text-blue-200 text-sm",children:[(0,s.jsxs)("strong",{children:[p," other project",1===p?"":"s"]})," ",1===p?"is":"are"," using the same database, so the database will ",(0,s.jsx)("strong",{children:"not"})," be deleted."]})}),(0,s.jsxs)("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:["To confirm, please type ",(0,s.jsx)("strong",{children:"DETACH"})," below:"]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-red-600 dark:text-red-400 mb-4",children:"Delete Database"}),(0,s.jsx)("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-700 rounded-md p-3 mb-4",children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-red-600 dark:text-red-400 mt-0.5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"DetachSupabaseModal.tsx",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z","data-sentry-element":"path","data-sentry-source-file":"DetachSupabaseModal.tsx"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-red-800 dark:text-red-200 font-medium",children:"Warning: This action is irreversible!"}),(0,s.jsxs)("p",{className:"text-red-700 dark:text-red-300 text-sm mt-1",children:["No other projects are using this database. Detaching will ",(0,s.jsx)("strong",{children:"permanently delete"})," the database and all its data."]})]})]})}),(0,s.jsxs)("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:["To confirm deletion, please type ",(0,s.jsx)("strong",{children:"DELETE"})," below:"]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-red-600 dark:text-red-400 mb-4",children:"Detach Supabase Project"}),(0,s.jsxs)("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:["This will remove the Supabase project connection from this application. The Supabase project itself will not be deleted. To confirm, please type ",(0,s.jsx)("strong",{children:"DETACH"})," below:"]})]}),!g&&!b&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"text",value:d,onChange:e=>{let t=e.target.value;o(t),x(t===v)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 dark:bg-gray-700 dark:text-white mb-4",placeholder:"Type ".concat(v," to confirm"),autoComplete:"off"}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md",disabled:m,children:"Cancel"}),(0,s.jsx)("button",{type:"button",onClick:k,disabled:!c||m,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md ".concat(!c||m?"opacity-50 cursor-not-allowed":""),children:m?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),f?"Deleting...":"Detaching..."]}):f?"Delete Database":"Detach Project"})]})]}),b&&(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md",children:"Close"})})]})})}):null}function f(e){let{isOpen:t,onClose:a,onConfirm:l,projectId:n,currentDatabaseId:i,isCurrentInternalDatabase:d}=e,[o,c]=(0,r.useState)("select"),[x,m]=(0,r.useState)([]),[u,g]=(0,r.useState)(null),[p,y]=(0,r.useState)(!1),[b,j]=(0,r.useState)(null),{isWhitelabel:f,whitelabelConfig:v}=(0,h.p)(),[k,N]=(0,r.useState)(""),[w,C]=(0,r.useState)(!1),[S,A]=(0,r.useState)(!1),[T,L]=(0,r.useState)(null),[E,D]=(0,r.useState)(!1),P=!0===d&&0===T,F=P?"delete and attach":"detach and attach";(0,r.useEffect)(()=>{t&&(c("select"),g(null),N(""),C(!1),A(!1),j(null),L(null),y(!0),fetch("/api/projects/list-databases").then(e=>e.json()).then(e=>{e.error?j(e.error):m((e.databases||[]).filter(e=>e.id!==i))}).catch(e=>{console.error("Error fetching databases:",e),j("Failed to load available databases")}).finally(()=>{y(!1)}))},[t,i]),(0,r.useEffect)(()=>{"confirm"===o&&d&&n?(D(!0),fetch("/api/projects/database-usage?projectId=".concat(n)).then(e=>e.json()).then(e=>{e.error?(console.error("Error checking database usage:",e.error),L(0)):L(e.otherProjectsCount)}).catch(e=>{console.error("Error checking database usage:",e),L(0)}).finally(()=>{D(!1)})):"confirm"===o&&L(null)},[o,d,n]);let I=e=>{g(e)},M=async()=>{if(w&&u){A(!0);try{await l(u.id,P)}finally{A(!1)}}};return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50","data-sentry-component":"ChangeSupabaseModal","data-sentry-source-file":"ChangeSupabaseModal.tsx",children:(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-lg w-full",children:(0,s.jsx)("div",{className:"p-6",children:"select"===o?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"Change Database"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Select a database to connect to this project:"}),p?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsxs)("svg",{className:"animate-spin h-8 w-8 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):b?(0,s.jsx)("div",{className:"text-red-600 dark:text-red-400 mb-4",children:b}):0===x.length?(0,s.jsx)("div",{className:"text-gray-500 dark:text-gray-400 py-4 text-center",children:"No other databases available"}):(0,s.jsx)("div",{className:"max-h-64 overflow-y-auto mb-4 border border-gray-200 dark:border-gray-600 rounded-md",children:x.map(e=>(0,s.jsx)("button",{onClick:()=>I(e),className:"w-full px-4 py-3 text-left border-b border-gray-200 dark:border-gray-600 last:border-b-0 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ".concat((null==u?void 0:u.id)===e.id?"bg-blue-50 dark:bg-blue-900/30":""),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[e.isInternal?(0,s.jsxs)("svg",{className:"w-5 h-5 text-blue-400 mr-2",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}),(0,s.jsx)("path",{d:"M3 5V19A9 3 0 0 0 21 19V5"}),(0,s.jsx)("path",{d:"M3 12A9 3 0 0 0 21 12"})]}):(0,s.jsx)("svg",{className:"w-5 h-5 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),(0,s.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.isInternal?f?(null==v?void 0:v.siteName)?"".concat(v.siteName," Database"):"Database":"Famous.ai Database":"Supabase Project",e.region&&" • ".concat(e.region)]}),(0,s.jsx)("div",{className:"text-xs text-gray-400 dark:text-gray-500 font-mono mt-0.5",children:e.id})]})]}),(null==u?void 0:u.id)===e.id&&(0,s.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]})},e.id))}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md",children:"Cancel"}),(0,s.jsx)("button",{type:"button",onClick:()=>{u&&(c("confirm"),N(""),C(!1))},disabled:!u,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md ".concat(u?"":"opacity-50 cursor-not-allowed"),children:"Continue"})]})]}):(0,s.jsxs)(s.Fragment,{children:[E?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsxs)("svg",{className:"animate-spin h-8 w-8 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}):d?null!==T&&T>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-yellow-600 dark:text-yellow-400 mb-4",children:"Confirm Database Change"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"You are about to change the database for this project."}),(0,s.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-md p-3 mb-4",children:(0,s.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)("span",{className:"text-gray-500 dark:text-gray-400 mr-2",children:"Current:"}),(0,s.jsx)("span",{className:"font-medium",children:i}),(0,s.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:"(will be detached)"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"text-gray-500 dark:text-gray-400 mr-2",children:"New:"}),(0,s.jsx)("span",{className:"font-medium text-blue-600 dark:text-blue-400",children:null==u?void 0:u.name}),(0,s.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(",(null==u?void 0:u.isInternal)?f?(null==v?void 0:v.siteName)?"".concat(null==v?void 0:v.siteName," Database"):"Database":"Famous.ai Database":"Supabase",")"]})]})]})}),(0,s.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-700 rounded-md p-3 mb-4",children:(0,s.jsxs)("p",{className:"text-blue-800 dark:text-blue-200 text-sm",children:[(0,s.jsxs)("strong",{children:[T," other project",1===T?"":"s"]})," ",1===T?"is":"are"," using the current database, so it will ",(0,s.jsx)("strong",{children:"not"})," be deleted."]})}),(0,s.jsxs)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:["To confirm, please type ",(0,s.jsx)("strong",{children:"detach and attach"})," below:"]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-red-600 dark:text-red-400 mb-4",children:"Confirm Database Change"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"You are about to change the database for this project."}),(0,s.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-md p-3 mb-4",children:(0,s.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)("span",{className:"text-gray-500 dark:text-gray-400 mr-2",children:"Current:"}),(0,s.jsx)("span",{className:"font-medium",children:i}),(0,s.jsx)("span",{className:"ml-2 text-xs text-red-500 font-medium",children:"(will be DELETED)"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"text-gray-500 dark:text-gray-400 mr-2",children:"New:"}),(0,s.jsx)("span",{className:"font-medium text-blue-600 dark:text-blue-400",children:null==u?void 0:u.name}),(0,s.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(",(null==u?void 0:u.isInternal)?f?"".concat(null==v?void 0:v.siteName," Database")||0:"Famous.ai Database":"Supabase",")"]})]})]})}),(0,s.jsx)("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-700 rounded-md p-3 mb-4",children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-red-600 dark:text-red-400 mt-0.5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"ChangeSupabaseModal.tsx",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z","data-sentry-element":"path","data-sentry-source-file":"ChangeSupabaseModal.tsx"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-red-800 dark:text-red-200 font-medium",children:"Warning: This action is irreversible!"}),(0,s.jsxs)("p",{className:"text-red-700 dark:text-red-300 text-sm mt-1",children:["No other projects are using the current database. Changing databases will ",(0,s.jsx)("strong",{children:"permanently delete"})," the current database and all its data."]})]})]})}),(0,s.jsxs)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:["To confirm deletion, please type ",(0,s.jsx)("strong",{children:"delete and attach"})," below:"]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"Confirm Database Change"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"You are about to change the database for this project."}),(0,s.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-md p-3 mb-4",children:(0,s.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)("span",{className:"text-gray-500 dark:text-gray-400 mr-2",children:"Current:"}),(0,s.jsx)("span",{className:"font-medium",children:i}),(0,s.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:"(Supabase - will be detached)"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"text-gray-500 dark:text-gray-400 mr-2",children:"New:"}),(0,s.jsx)("span",{className:"font-medium text-blue-600 dark:text-blue-400",children:null==u?void 0:u.name}),(0,s.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(",(null==u?void 0:u.isInternal)?f?(null==v?void 0:v.siteName)?"".concat(v.siteName," Database"):"Database":"Famous.ai Database":"Supabase",")"]})]})]})}),(0,s.jsxs)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:["To confirm, please type ",(0,s.jsx)("strong",{children:"detach and attach"})," below:"]})]}),!E&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"text",value:k,onChange:e=>{let t=e.target.value;N(t),C(t.toLowerCase()===F)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white mb-4",placeholder:'Type "'.concat(F,'" to confirm'),autoComplete:"off"}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{c("select"),N(""),C(!1)},className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md",disabled:S,children:"← Back"}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md",disabled:S,children:"Cancel"}),(0,s.jsx)("button",{type:"button",onClick:M,disabled:!w||S,className:"px-4 py-2 text-sm font-medium text-white rounded-md ".concat(P?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"," ").concat(!w||S?"opacity-50 cursor-not-allowed":""),children:S?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):P?"Delete & Attach":"Change Database"})]})]})]})]})})})}):null}function v(e){let{isOpen:t,onClose:a,onConfirm:l,isDeleting:n}=e,[i,d]=(0,r.useState)(""),[o,c]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{t&&(d(""),c(!1))},[t]),t)?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50","data-sentry-component":"DeleteConfirmationModal","data-sentry-source-file":"DeleteConfirmationModal.tsx",children:(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-red-600 dark:text-red-400 mb-4",children:"Delete Project"}),(0,s.jsxs)("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:["This action cannot be undone. To confirm, please type ",(0,s.jsx)("strong",{children:"DELETE"})," below:"]}),(0,s.jsx)("input",{type:"text",value:i,onChange:e=>{let t=e.target.value;d(t),c("DELETE"===t)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-red-500 focus:border-red-500 dark:bg-gray-700 dark:text-white mb-4",placeholder:"Type DELETE to confirm",autoComplete:"off"}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{d(""),c(!1),a()},className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md",disabled:n,children:"Cancel"}),(0,s.jsx)("button",{type:"button",onClick:l,disabled:!o||n,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md ".concat(!o||n?"opacity-50 cursor-not-allowed":""),children:n?"Deleting...":"Delete Project"})]})]})})}):null}function k(e){let{isOpen:t,onClose:a,currentTitle:l,onSubmit:n,error:i}=e,[d,o]=(0,r.useState)(l),[c,x]=(0,r.useState)(!1),[m,u]=(0,r.useState)();(0,r.useEffect)(()=>{t&&(o(l),u(void 0))},[t,l]);let g=async e=>{if(e.preventDefault(),u(void 0),!d||""===d.trim()){u("Title is required");return}if(d.length>100){u("Title must be 100 characters or less");return}try{x(!0),await n(d.trim())}catch(e){}finally{x(!1)}};return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50","data-sentry-component":"EditTitleModal","data-sentry-source-file":"EditTitleModal.tsx",children:(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Edit Project Title"}),(0,s.jsxs)("form",{onSubmit:g,children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Title"}),(0,s.jsx)("input",{type:"text",value:d,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter project title",maxLength:100}),(0,s.jsxs)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:[d.length,"/100 characters"]})]}),m&&(0,s.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400",children:m}),i&&(0,s.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400",children:i})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,s.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:c,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md ".concat(c?"opacity-70 cursor-not-allowed":""),children:c?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save"})]})]})]})})}):null}function N(e){let{isOpen:t,onClose:a,currentDescription:l,onSubmit:n,error:i}=e,[d,o]=(0,r.useState)(l),[c,x]=(0,r.useState)(!1),[m,u]=(0,r.useState)();(0,r.useEffect)(()=>{t&&(o(l),u(void 0))},[t,l]);let g=async e=>{if(e.preventDefault(),u(void 0),d.length>500){u("Description must be 500 characters or less");return}try{x(!0),await n(d.trim())}catch(e){}finally{x(!1)}};return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50","data-sentry-component":"EditDescriptionModal","data-sentry-source-file":"EditDescriptionModal.tsx",children:(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Edit Project Description"}),(0,s.jsxs)("form",{onSubmit:g,children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),(0,s.jsx)("textarea",{value:d,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Enter project description",rows:4,maxLength:500}),(0,s.jsxs)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:[d.length,"/500 characters"]})]}),m&&(0,s.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400",children:m}),i&&(0,s.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400",children:i})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,s.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:c,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md ".concat(c?"opacity-70 cursor-not-allowed":""),children:c?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save"})]})]})]})})}):null}var w=a(13874);function C(e){let{projectData:t,subscriptionData:a,onProjectUpdate:n,onTabChange:i}=e,d=(0,l.useRouter)(),{id:o}=d.query,[c,C]=(0,r.useState)(!1),[S,A]=(0,r.useState)(!1),[T,L]=(0,r.useState)(""),[E,D]=(0,r.useState)(),[P,F]=(0,r.useState)(!1),[I,M]=(0,r.useState)(!1),[z,U]=(0,r.useState)(!1),[R,_]=(0,r.useState)(!1),[O,B]=(0,r.useState)(!1),[W,V]=(0,r.useState)(!1),[q,H]=(0,r.useState)(!1),[J,Y]=(0,r.useState)(!1),[G,K]=(0,r.useState)(!1),[Q,X]=(0,r.useState)(!1),[$,Z]=(0,r.useState)(!1),[ee,et]=(0,r.useState)(!1),[ea,es]=(0,r.useState)(!1),[er,el]=(0,r.useState)(!1),[en,ei]=(0,r.useState)(!1),[ed,eo]=(0,r.useState)(""),[ec,ex]=(0,r.useState)(!1),[em,eu]=(0,r.useState)(!1),[eg,eh]=(0,r.useState)(!1),[ep,ey]=(0,r.useState)(!1),[eb,ej]=(0,r.useState)(),[ef,ev]=(0,r.useState)(),{isWhitelabel:ek,whitelabelConfig:eN}=(0,h.p)();(0,r.useEffect)(()=>{(null==t?void 0:t.shareToken)?eo("".concat(window.location.origin,"/share/").concat(t.id,"?token=").concat(t.shareToken)):eo("")},[t]);let ew=(0,r.useCallback)(async e=>{try{if(!e||!e.trim()||!e.includes(".")){g.Ay.error("Please enter a valid domain");return}let t=e.trim().toLowerCase(),a=await fetch("/api/projects/domains",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:o,domain:t})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to add domain")}let s=!1;try{let{domainName:e,subdomain:a}=(0,x.i)(t),r=await fetch("/api/domains/create-record?domain=".concat(encodeURIComponent(e)),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:a?"CNAME":"A",name:a||"@",value:a?"cname.aiagentconnections.com":"52.6.250.82",ttl:3600})});201===r.status&&(s=!0)}catch(e){console.error("Failed to create DNS record:",e)}await n(),C(!1),s?g.Ay.success("Domain added and configured successfully!"):(g.Ay.success("Domain added successfully! Please configure DNS records."),L(t),A(!0))}catch(e){g.Ay.error(e.message||"Failed to add domain")}},[o,n]);(0,r.useEffect)(()=>{let e=async e=>{let t=e.detail;console.log("Entri closed with details:",t),t.success&&t.domain?await ew(t.domain):!t.success&&t.domain&&g.Ay.error("Domain setup was not completed. Please try again.")};return window.addEventListener("onEntriClose",e,!1),()=>{window.removeEventListener("onEntriClose",e,!1)}},[ew]);let eC=async()=>{if(o)try{M(!0);let e=await fetch("/api/projects/delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:o})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to delete project")}d.push("/")}catch(e){console.error("Error deleting project:",e),alert("Failed to delete project: ".concat(e.message))}finally{M(!1),eu(!1)}},eS=async e=>{if(!o)return;let a=(null==t?void 0:t.isInternalDatabase)===!0,s=null;try{K(!0),s=g.Ay.loading("".concat(e?"Deleting database":a?"Detaching database":"Detaching Supabase project","..."));let t=await fetch("/api/projects/supabase",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:o,deleteDatabase:e})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to detach database")}g.Ay.success(e?"Database deleted successfully":a?"Database detached successfully":"Supabase project detached successfully",{id:s||void 0}),H(!1),await n()}catch(e){console.error("Error detaching database:",e),g.Ay.error("Error: ".concat(e.message),{id:s||void 0})}finally{K(!1)}},eA=async(e,t)=>{if(!o)return;let a=null;try{X(!0),a=g.Ay.loading("".concat(t?"Changing database (deleting old)":"Changing database","..."));let s=await fetch("/api/projects/supabase",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:o,newDatabaseId:e,deleteOldDatabase:t})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to change database")}g.Ay.success(t?"Database changed and old database deleted":"Database changed successfully",{id:a||void 0}),Y(!1),await n()}catch(e){console.error("Error changing database:",e),g.Ay.error("Error: ".concat(e.message),{id:a||void 0})}finally{X(!1)}},eT=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"create";if(o)try{et(!0);let a=await fetch("/api/projects/clone",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:o,includeHistory:e,supabaseOption:t})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to clone project")}let s=await a.json();g.Ay.success("Project cloned successfully!"),d.push("/project/".concat(s.project._id))}catch(e){console.error("Error cloning project:",e),g.Ay.error("Failed to clone project: ".concat(e.message))}finally{et(!1),Z(!1)}},eL=async e=>{let t=null;try{es(!0),t=g.Ay.loading("Updating sharing settings...");let a=await fetch("/api/projects/sharing",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:o,allowSharing:e})});if(!a.ok)throw Error("Failed to update sharing settings");let s=await a.json();s.project.shareToken&&eo("".concat(window.location.origin,"/share/").concat(s.project._id,"?token=").concat(s.project.shareToken)),g.Ay.success("Sharing settings updated successfully",{id:t||void 0}),await n()}catch(e){console.error("Error updating sharing settings:",e),g.Ay.error("Failed to update sharing settings",{id:t||void 0})}finally{es(!1)}},eE=async e=>{let t=null;try{el(!0),t=g.Ay.loading("Updating pinning settings...");let a=await fetch("/api/projects/pinning",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:o,isPinned:e})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to update pinning settings")}g.Ay.success("Pinning settings updated successfully",{id:t||void 0}),await n()}catch(e){console.error("Error updating pinning settings:",e),g.Ay.error(e.message||"Failed to update pinning settings",{id:t||void 0})}finally{el(!1)}},eD=async e=>{let a=null;try{if((!(null==t?void 0:t.userTier)||t.userTier===m.i.FREE)&&!1===e){U(!0);return}ei(!0),a=g.Ay.loading("Updating sleep mode...");let s=await fetch("/api/projects/sleep",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:o,isSleeping:e})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to update sleep mode")}g.Ay.success("Sleep mode updated successfully",{id:a||void 0}),await n()}catch(e){console.error("Error updating sleep mode:",e),g.Ay.error(e.message||"Failed to update sleep mode",{id:a||void 0})}finally{ei(!1)}},eP=async()=>{let e=null;try{if(ea||!confirm("Are you sure you want to generate a new share link? Generating a new token will invalidate any previously shared links."))return;es(!0),e=g.Ay.loading("Generating new share link...");let t=await fetch("/api/projects/sharing",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:o,allowSharing:!0,generateNewToken:!0})});if(!t.ok)throw Error("Failed to generate new share link");let a=await t.json();a.project.allowSharing&&a.project.shareToken&&eo("".concat(window.location.origin,"/share/").concat(a.project._id,"?token=").concat(a.project.shareToken)),g.Ay.success("New share link generated successfully",{id:e||void 0}),await n()}catch(t){console.error("Error generating new share link:",t),g.Ay.error("Failed to generate new share link",{id:e||void 0})}finally{es(!1)}},eF=async()=>{if(ed)try{await navigator.clipboard.writeText(ed),ex(!0),setTimeout(()=>{ex(!1)},2e3),g.Ay.success("Share URL copied to clipboard!")}catch(e){console.error("Failed to copy:",e),g.Ay.error("Failed to copy URL")}},eI=async e=>{try{ej(void 0);let t=await fetch("/api/projects/update-title",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:o,title:e})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to update title")}g.Ay.success("Project title updated successfully!"),eh(!1),await n()}catch(e){ej(e.message)}},eM=async e=>{try{ev(void 0);let t=await fetch("/api/projects/update-description",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:o,description:e})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to update description")}g.Ay.success("Project description updated successfully!"),ey(!1),await n()}catch(e){ev(e.message)}},ez=async()=>{(null==t?void 0:t.userTier)&&t.userTier!==m.i.FREE?C(!0):U(!0)},eU=e=>{if((!(null==t?void 0:t.userTier)||t.userTier===m.i.FREE)&&!1===e){U(!0);return}eR(e)},eR=async e=>{let t=null;try{B(!0),t=g.Ay.loading("Updating badge settings...");let a=await fetch("/api/projects/badge",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:o,showBadge:e})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to update badge settings")}e?g.Ay.success("Badge shown successfully!",{id:t,duration:5e3}):g.Ay.success("Badge hidden successfully!",{id:t,duration:5e3}),await n()}catch(e){console.error("Error updating badge settings:",e),g.Ay.error(e.message||"Failed to update badge settings",{id:t||void 0})}finally{B(!1)}},e_=e=>{if((!(null==t?void 0:t.userTier)||t.userTier===m.i.FREE)&&!1===e){U(!0);return}eO(e)},eO=async e=>{let t=null;try{if(V(!0),t=g.Ay.loading("Updating visibility settings..."),!(await fetch("/api/projects/set-public",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:o,isPublic:e})})).ok)throw Error("Failed to update visibility settings");e?g.Ay.success("Project is now public.",{id:t}):g.Ay.success("Project is now private.",{id:t}),await n()}catch(e){console.error("Error updating visibility settings:",e),g.Ay.error("Failed to update visibility settings",{id:t||void 0})}finally{V(!1)}},eB=e=>{L(e),A(!0)};return t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{className:"text-xl font-medium text-gray-900 dark:text-white mb-4",children:"Basic Settings"}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-md",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center mb-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Project Title"}),(0,s.jsx)("button",{onClick:()=>eh(!0),className:"ml-3 text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm",children:"Edit"})]}),(0,s.jsx)("div",{className:"text-gray-900 dark:text-white",children:t.title||"No title set"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Project Slug"}),(0,s.jsx)("div",{className:"text-gray-900 dark:text-white",children:t.slug||"No slug available"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Created At"}),(0,s.jsx)("div",{className:"text-gray-900 dark:text-white",children:t.createdAt?new Date(t.createdAt).toLocaleString():"Unknown"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Updated At"}),(0,s.jsx)("div",{className:"text-gray-900 dark:text-white",children:t.updatedAt?new Date(t.updatedAt).toLocaleString():"Unknown"})]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("div",{className:"flex items-center mb-1",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Project Description"}),(0,s.jsx)("button",{onClick:()=>ey(!0),className:"ml-3 text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm",children:"Edit"})]}),(0,s.jsx)("div",{className:"text-gray-900 dark:text-white",children:t.description||"No description provided"})]}),t.supabaseProjectId&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:!0===t.isInternalSupabase||!0===t.isInternalDatabase?"Database Project":"Supabase Project"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 bg-gray-100 dark:bg-gray-600 p-3 rounded-md border border-gray-200 dark:border-gray-500",children:[(0,s.jsx)("div",{className:"flex items-center min-w-0",children:!0===t.isInternalSupabase||!0===t.isInternalDatabase?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"w-5 h-5 text-blue-400 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}),(0,s.jsx)("path",{d:"M3 5V19A9 3 0 0 0 21 19V5"}),(0,s.jsx)("path",{d:"M3 12A9 3 0 0 0 21 12"})]}),(0,s.jsx)("a",{onClick:()=>i("database"),href:"#",className:"text-blue-400 hover:underline font-medium cursor-pointer truncate",children:t.supabaseProjectId})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-blue-400 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),(0,s.jsx)("a",{href:"https://supabase.com/dashboard/project/".concat(t.supabaseProjectId),target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline font-medium truncate",children:t.supabaseProjectId})]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[(0,s.jsx)("button",{onClick:()=>Y(!0),className:"px-3 py-1 bg-blue-50 text-blue-600 hover:bg-blue-100 dark:bg-blue-900/20 dark:hover:bg-blue-900/30 dark:text-blue-400 rounded-md text-sm font-medium transition-colors",children:"Change"}),(0,s.jsx)("button",{onClick:()=>H(!0),className:"px-3 py-1 bg-red-50 text-red-500 hover:bg-red-100 dark:bg-red-900/20 dark:hover:bg-red-900/30 dark:text-red-400 rounded-md text-sm font-medium transition-colors",children:"Detach"})]})]}),(0,s.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:!0===t.isInternalSupabase||!0===t.isInternalDatabase?"A database provides backend storage, functionality, and authentication for your application.":"Supabase provides backend storage, functionality, and authentication for your application."})]})]})]}),"mobile"!==t.platform&&(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{className:"text-xl font-medium text-gray-900 dark:text-white mb-4",children:"Domains"}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-md",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[("live"===t.status||"completed"===t.status)&&(0,s.jsxs)("div",{className:"flex items-center justify-between bg-gray-100 dark:bg-gray-600 p-2 rounded",children:[(0,s.jsxs)("span",{className:"text-gray-900 dark:text-gray-100",children:[t.slug,".","deploypad.app"]}),(0,s.jsx)("button",{onClick:()=>window.open("https://".concat(t.slug,".").concat("deploypad.app"),"_blank"),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})})]}),t.domains&&t.domains.map(e=>(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 bg-gray-100 dark:bg-gray-600 p-2 rounded",children:[(0,s.jsx)("span",{className:"text-gray-900 dark:text-gray-100 truncate min-w-0",children:e}),(0,s.jsxs)("div",{className:"flex items-center space-x-3 flex-shrink-0",children:[(0,s.jsx)("button",{onClick:()=>eB(e),className:"text-gray-300 dark:text-gray-300 hover:text-gray-200 dark:hover:text-gray-200 text-sm border border-gray-300 dark:border-gray-500 rounded px-2 py-0.5",children:"Instructions"}),(0,s.jsx)("button",{onClick:async()=>{try{if(!confirm("Are you sure you want to remove ".concat(e,"?")))return;if(!(await fetch("/api/projects/domains?projectId=".concat(o,"&domain=").concat(e),{method:"DELETE"})).ok)throw Error("Failed to remove domain");await n()}catch(e){console.error("Error deleting domain:",e)}},className:"text-gray-300 dark:text-gray-300 hover:text-gray-200 dark:hover:text-gray-200 text-sm border border-gray-300 dark:border-gray-500 rounded px-2 py-0.5",children:"Remove"}),(0,s.jsx)("button",{onClick:()=>window.open("https://".concat(e),"_blank"),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})})]})]},e))]}),(0,s.jsxs)("div",{className:"flex space-x-4 mt-4",children:[(0,s.jsx)("button",{onClick:ez,disabled:P,className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:P?"Please wait...":ek?"Add a domain":"Add a domain you own"}),(0,s.jsx)("button",{onClick:()=>_(!0),className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md text-sm transition-colors",children:"Buy a domain"})]})]})]}),"mobile"!==t.platform&&(0,s.jsxs)("section",{children:[(0,s.jsxs)("h2",{className:"text-xl font-medium text-gray-900 dark:text-white mb-4",children:[ek?(null==eN?void 0:eN.siteName)||"":"Famous.ai"," ","Badge"]}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-md",children:[(0,s.jsxs)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:["Change the visibility of the 'Built on"," ",ek?(null==eN?void 0:eN.siteName)||"":"Famous.ai","' badge on your published site."]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{id:"hide-badge",name:"badge-visibility",type:"radio",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600",checked:!1===t.showBadge,disabled:O,onChange:()=>eU(!1)}),(0,s.jsx)("label",{htmlFor:"hide-badge",className:"ml-3 block text-gray-700 dark:text-gray-300",children:"Hide badge"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{id:"show-badge",name:"badge-visibility",type:"radio",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600",checked:!1!==t.showBadge,disabled:O,onChange:()=>eU(!0)}),(0,s.jsx)("label",{htmlFor:"show-badge",className:"ml-3 block text-gray-700 dark:text-gray-300",children:"Show badge"})]})]})]})]}),(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{className:"text-xl font-medium text-gray-900 dark:text-white mb-4",children:"Project Visibility"}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-md",children:[(0,s.jsxs)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:["Public projects can be featured on the ",ek?"".concat((null==eN?void 0:eN.siteName)?"".concat(eN.siteName):"platform"):"Famous.ai"," homepage, giving you extra visibility and helping more people discover your work. You can switch between public and private at any time."]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{id:"private-project",name:"project-visibility",type:"radio",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600",checked:!1===t.isPublic,disabled:W,onChange:()=>e_(!1)}),(0,s.jsx)("label",{htmlFor:"private-project",className:"ml-3 block text-gray-700 dark:text-gray-300",children:"Private project"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{id:"public-project",name:"project-visibility",type:"radio",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600",checked:!1!==t.isPublic,disabled:W,onChange:()=>e_(!0)}),(0,s.jsx)("label",{htmlFor:"public-project",className:"ml-3 block text-gray-700 dark:text-gray-300",children:"Public project"})]})]})]})]}),(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{className:"text-xl font-medium text-gray-900 dark:text-white mb-4",children:"Clone Project"}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-md",children:[(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Create a copy of this project."}),(0,s.jsx)("button",{onClick:()=>Z(!0),className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md text-sm transition-colors",children:"Clone this project"})]})]}),(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{className:"text-xl font-medium text-gray-900 dark:text-white mb-4",children:"Project Sharing"}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-md",children:[(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Allow others to clone this project using a shareable link."}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:!0===t.allowSharing,disabled:ea,onChange:e=>eL(e.target.checked)}),(0,s.jsx)("div",{className:"relative w-11 h-6 bg-gray-600 dark:bg-gray-400 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,s.jsx)("span",{className:"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300",children:t.allowSharing?"Sharing Enabled":"Sharing Disabled"})]})}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Shareable Link"}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("input",{type:"text",readOnly:!0,value:ed,className:"flex-1 bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-3 py-2 rounded-l-md border border-gray-300 dark:border-gray-600 focus:outline-none ".concat(t.allowSharing?"":"opacity-50")}),(0,s.jsx)("button",{onClick:eF,className:"bg-gray-200 dark:bg-gray-500 hover:bg-gray-300 dark:hover:bg-gray-400 px-3 py-2 rounded-r-md border-t border-r border-b border-gray-300 dark:border-gray-600 ".concat(t.allowSharing?"":"opacity-50"),disabled:!ed||!t.allowSharing,children:ec?(0,s.jsx)("svg",{className:"w-5 h-5 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):(0,s.jsx)("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})})})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("button",{onClick:eP,disabled:ea||!t.allowSharing,className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium ".concat(t.allowSharing?"":"opacity-50 cursor-not-allowed"),children:"Generate new share link"})})]})]})]})]}),!ek&&(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{className:"text-xl font-medium text-gray-900 dark:text-white mb-4",children:"Pin to White Label"}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-md",children:[(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Pin this project to your white label site, so your users can see and clone it from their dashboard."}),(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:!!t.pinnedAt,disabled:er,onChange:e=>eE(e.target.checked)}),(0,s.jsx)("div",{className:"relative w-11 h-6 bg-gray-600 dark:bg-gray-400 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,s.jsx)("span",{className:"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300",children:t.pinnedAt?"Pinned":"Not Pinned"})]})})})]})]}),(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{className:"text-xl font-medium text-gray-900 dark:text-white mb-4",children:"Sleep Mode"}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-md",children:[(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"If you are not using a project, put it to sleep so it doesn't use compute resources."}),(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:!0===t.isSleeping,disabled:en,onChange:e=>eD(e.target.checked)}),(0,s.jsx)("div",{className:"relative w-11 h-6 bg-gray-600 dark:bg-gray-400 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,s.jsx)("span",{className:"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300",children:!0===t.isSleeping?"Sleeping":"Not Sleeping"})]})})})]})]}),(0,s.jsx)("div",{className:"flex justify-end mt-8 border-t dark:border-gray-700 pt-6",children:(0,s.jsxs)("button",{className:"text-red-500 hover:text-red-600 text-sm font-medium flex items-center",onClick:()=>eu(!0),children:[(0,s.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"GeneralTab.tsx",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16","data-sentry-element":"path","data-sentry-source-file":"GeneralTab.tsx"})}),"Delete Project"]})})]}),z&&a&&(0,s.jsx)(u.A,{isOpen:z,onClose:()=>U(!1),currentTier:a.tier,currentUsage:a.messageCount,currentLimit:a.limit,subscriptionData:a}),c&&(0,s.jsx)(p,{isOpen:c,onClose:()=>{C(!1),D(void 0)},onSubmit:ew,error:E}),S&&(0,s.jsx)(y,{isOpen:S,onClose:()=>A(!1),domain:T}),q&&(0,s.jsx)(j,{isOpen:q,onClose:()=>H(!1),onConfirm:eS,projectId:o,isInternalDatabase:(null==t?void 0:t.isInternalDatabase)===!0}),J&&(0,s.jsx)(f,{isOpen:J,onClose:()=>Y(!1),onConfirm:eA,projectId:o,currentDatabaseId:null==t?void 0:t.supabaseProjectId,isCurrentInternalDatabase:(null==t?void 0:t.isInternalDatabase)===!0}),$&&(0,s.jsx)(b,{isOpen:$,onClose:()=>Z(!1),onConfirm:eT,isCloning:ee,supabaseProjectId:null==t?void 0:t.supabaseProjectId}),em&&(0,s.jsx)(v,{isOpen:em,onClose:()=>eu(!1),onConfirm:eC,isDeleting:I}),eg&&(0,s.jsx)(k,{isOpen:eg,onClose:()=>{eh(!1),ej(void 0)},currentTitle:(null==t?void 0:t.title)||"",onSubmit:eI,error:eb}),ep&&(0,s.jsx)(N,{isOpen:ep,onClose:()=>{ey(!1),ev(void 0)},currentDescription:(null==t?void 0:t.description)||"",onSubmit:eM,error:ef}),(0,s.jsx)(w.A,{isOpen:R,onClose:()=>_(!1),redirectAfterPurchase:!1,onSuccess:async e=>{_(!1);try{await ew(e)}catch(e){console.error("Failed to add domain:",e)}},"data-sentry-element":"BuyDomainModal","data-sentry-source-file":"GeneralTab.tsx"})]}):null}function S(e){let{projectData:t,onProjectUpdate:a}=e,{id:n}=(0,l.useRouter)().query,[i,d]=(0,r.useState)(!0),[o,c]=(0,r.useState)(null),[x,m]=(0,r.useState)(null),[u,h]=(0,r.useState)("30d"),[p,y]=(0,r.useState)(!1),[b,j]=(0,r.useState)(null),[f,v]=(0,r.useState)({x:0,y:0}),k=(0,r.useCallback)(async()=>{try{let e=await fetch("/api/projects/".concat(n,"/analytics?range=").concat(u));if(!e.ok)throw Error("Failed to fetch analytics data");let t=await e.json();c(t),d(!1)}catch(e){console.error("Error fetching analytics:",e),m("Could not load analytics data"),d(!1)}},[n,u]);(0,r.useEffect)(()=>{n&&k()},[n,k]);let N=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"k":e.toString(),w=e=>{let t=e>0?"+":"";return"".concat(t).concat(e,"%")},C=(e,t,a)=>{let s=window.innerWidth,r=e.clientX,l=e.clientY,n=r;r+100>s-10?n=r-100:r-100<10&&(n=110),v({x:n,y:l-60-5}),j({index:t,data:a})},S=(e,t,a)=>{if(b&&b.index===t){let t=window.innerWidth,a=e.clientX,s=e.clientY,r=a;a+100>t-10?r=a-100:a-100<10&&(r=110),v({x:r,y:s-60-5})}},A=()=>{j(null)},T=(e,t)=>{if(!e||0===e.length)return[];let a=new Date,s=[];for(let e=("7d"===t?7:"90d"===t?90:30)-1;e>=0;e--){let t=new Date(a);t.setDate(t.getDate()-e),s.push(t.toISOString().split("T")[0])}let r=new Map;return e.forEach(e=>{r.set(e.date,e)}),s.map(e=>r.has(e)?r.get(e):{date:e,visitors:0,pageviews:0})},L=async e=>{if(!e&&!confirm("Are you sure you want to disable analytics collection? This will stop collecting visitor data for this project. You can re-enable it later."))return;let t=null;try{y(!0),t=g.Ay.loading("Updating analytics collection...");let s=await fetch("/api/projects/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:n,includeEvents:e})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to update analytics collection setting")}e?g.Ay.success("Analytics collection enabled successfully!",{id:t,duration:5e3}):g.Ay.success("Analytics collection disabled successfully!",{id:t,duration:5e3}),await a()}catch(e){console.error("Error updating analytics collection setting:",e),g.Ay.error(e.message||"Failed to update analytics collection setting",{id:t||void 0})}finally{y(!1)}};return i?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("svg",{className:"animate-spin h-10 w-10 text-blue-500 mx-auto mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("p",{className:"text-gray-300",children:"Loading analytics..."})]})}):x?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-red-500 mb-4",children:(0,s.jsx)("svg",{className:"h-12 w-12 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,s.jsx)("p",{className:"text-gray-300 text-xl font-medium mb-4",children:x})]}):t?(0,s.jsxs)("div",{className:"space-y-8","data-sentry-component":"AnalyticsTab","data-sentry-source-file":"AnalyticsTab.tsx",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between ".concat(t&&new Date(t.createdAt)<new Date("2025-06-15")?"mb-2":""),children:[(0,s.jsx)("h2",{className:"text-xl font-medium text-gray-900 dark:text-white mb-4 sm:mb-0",children:"Analytics Dashboard"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Time range:"}),(0,s.jsxs)("select",{value:u,onChange:e=>h(e.target.value),className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"7d",children:"Last 7 days"}),(0,s.jsx)("option",{value:"30d",children:"Last 30 days"}),(0,s.jsx)("option",{value:"90d",children:"Last 90 days"})]})]})]}),t&&new Date(t.createdAt)<new Date("2025-06-15")&&(0,s.jsx)("div",{className:"mb-4 flex justify-end",children:(0,s.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center",children:[(0,s.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Analytics collection started Jun 15, 2025"]})}),o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[(0,s.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg shadow",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Visitors"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:N(o.summary.totalVisitors)})]}),(0,s.jsx)("div",{className:"text-sm font-medium ".concat(o.summary.visitorsChange>=0?"text-green-600":"text-red-600"),children:w(o.summary.visitorsChange)})]})}),(0,s.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg shadow",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Pageviews"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:N(o.summary.totalPageviews)})]}),(0,s.jsx)("div",{className:"text-sm font-medium ".concat(o.summary.pageviewsChange>=0?"text-green-600":"text-red-600"),children:w(o.summary.pageviewsChange)})]})}),(0,s.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg shadow",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Avg Session Duration"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(e=>{if(e<60)return"".concat(Math.round(e),"s");let t=Math.floor(e/60),a=Math.round(e%60);return"".concat(t,"m ").concat(a,"s")})(o.summary.avgSessionDuration)})]}),(0,s.jsx)("div",{className:"text-sm font-medium ".concat(o.summary.sessionDurationChange>=0?"text-green-600":"text-red-600"),children:w(o.summary.sessionDurationChange)})]})}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg shadow",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full mr-2"}),(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Live pageviews"})]})}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2",children:o.summary.livePageviews})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,s.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg shadow",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"New Users"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:N(o.summary.newUsers)}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:o.summary.totalVisitors>0?"".concat(Math.round(o.summary.newUsers/o.summary.totalVisitors*100),"% of total"):"0% of total"})]}),(0,s.jsx)("div",{className:"text-sm font-medium ".concat(o.summary.newUsersChange>=0?"text-green-600":"text-red-600"),children:w(o.summary.newUsersChange)})]})}),(0,s.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg shadow",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Returning Users"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:N(o.summary.returningUsers)}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:o.summary.totalVisitors>0?"".concat(Math.round(o.summary.returningUsers/o.summary.totalVisitors*100),"% of total"):"0% of total"})]}),(0,s.jsx)("div",{className:"text-sm font-medium ".concat(o.summary.returningUsersChange>=0?"text-green-600":"text-red-600"),children:w(o.summary.returningUsersChange)})]})})]}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg shadow mb-8",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Visitors Over Time"}),(0,s.jsxs)("div",{className:"h-80 relative",children:[(0,s.jsx)("div",{className:"h-full flex items-end justify-between relative",children:(()=>{let e=T(o.chartData,u),t=Math.max(...e.map(e=>e.visitors),1);return e.map((e,a)=>{let r=Math.max(e.visitors/t*200,2),l=e.visitors>0;return(0,s.jsxs)("div",{className:"flex flex-col items-center relative flex-1 min-w-0",children:[l&&(0,s.jsx)("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1 absolute -top-6",children:N(e.visitors)}),(0,s.jsx)("div",{className:"bg-blue-500 hover:bg-blue-600 w-full rounded-t transition-colors cursor-pointer mx-px",style:{height:"".concat(r,"px")},onMouseEnter:t=>C(t,a,e),onMouseMove:t=>S(t,a,e),onMouseLeave:A}),(0,s.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 whitespace-nowrap transform -rotate-45 origin-center",children:[new Date(e.date).getMonth()+1,"/",new Date(e.date).getDate()]})]},a)})})()}),b&&(0,s.jsxs)("div",{className:"absolute z-10 bg-gray-900 dark:bg-gray-800 text-white text-sm rounded-lg p-3 shadow-lg border border-gray-700 pointer-events-none max-w-48 whitespace-nowrap",style:{left:f.x,top:f.y,transform:"translate(-50%, -100%)"},children:[(0,s.jsx)("div",{className:"font-medium",children:new Date(b.data.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})}),(0,s.jsxs)("div",{className:"text-blue-300",children:[b.data.visitors," visitor",1===b.data.visitors?"":"s"]})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Referrals"}),(0,s.jsx)("div",{className:"space-y-3",children:o.referrals.slice(0,10).map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center flex-1",children:(0,s.jsx)("span",{className:"text-sm text-gray-900 dark:text-white",children:e.source})}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.percentage,"%"]}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:N(e.visitors)})]})]},t))})]}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Pages"}),(0,s.jsx)("div",{className:"space-y-3",children:o.pages.slice(0,10).map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center flex-1",children:(0,s.jsx)("span",{className:"text-sm text-gray-900 dark:text-white truncate",children:e.path})}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.percentage,"%"]}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:N(e.visitors)})]})]},t))})]}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Devices"}),(0,s.jsx)("div",{className:"space-y-3",children:o.devices.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center flex-1",children:(0,s.jsx)("span",{className:"text-sm text-gray-900 dark:text-white capitalize",children:e.type})}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.percentage,"%"]}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:N(e.visitors)})]})]},t))})]}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Countries"}),(0,s.jsx)("div",{className:"space-y-3",children:o.countries.slice(0,10).map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center flex-1",children:(0,s.jsx)("span",{className:"text-sm text-gray-900 dark:text-white",children:e.country})}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.percentage,"%"]}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:N(e.visitors)})]})]},t))})]}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Browsers"}),(0,s.jsx)("div",{className:"space-y-3",children:o.browsers.slice(0,10).map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center flex-1",children:(0,s.jsx)("span",{className:"text-sm text-gray-900 dark:text-white",children:e.browser})}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.percentage,"%"]}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:N(e.visitors)})]})]},t))})]})]}),(0,s.jsx)("div",{className:"mt-12 pt-8 border-t border-gray-200 dark:border-gray-700",children:(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-6 rounded-lg shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Toggle Analytics"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Control whether analytics data is collected for this project."}),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:(null==t?void 0:t.includeEvents)!==!1,disabled:p,onChange:e=>L(e.target.checked)}),(0,s.jsx)("div",{className:"relative w-11 h-6 bg-gray-600 dark:bg-gray-400 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),(0,s.jsx)("span",{className:"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300",children:(null==t?void 0:t.includeEvents)!==!1?"Analytics Collection Enabled":"Analytics Collection Disabled"})]})}),(null==t?void 0:t.includeEvents)===!1&&(0,s.jsx)("div",{className:"mt-3 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,s.jsx)("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:"Analytics collection is disabled. No new data will be collected until re-enabled."})]})})]})})]})]}):null}var A=a(26451),T=a(25677),L=a(82447),E=a(82100),D=a(22058),P=a(82742),F=a(16449),I=a(23925);function M(e){let{stripeAccountId:t,projectId:a}=e,[l,n]=(0,r.useState)("account"),[i,d]=(0,r.useState)(null),[o,c]=(0,r.useState)(!0),[x,m]=(0,r.useState)(null),{isWhitelabel:u}=(0,h.p)(),g=(0,r.useCallback)(async()=>{try{c(!0),m(null);let e=await fetch("/api/projects/stripe-account-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:a,stripeAccountId:t})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to create account session")}let{clientSecret:s,publishableKey:r}=await e.json(),l=await (0,F.e)({publishableKey:r,fetchClientSecret:async()=>s,appearance:{variables:{colorPrimary:"#3b82f6",colorBackground:"#1f2937",colorText:"#f3f4f6",colorSecondaryText:"#9ca3af",colorBorder:"#374151",colorDanger:"#ef4444",borderRadius:"8px",spacingUnit:"4px",fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'}}});d(l)}catch(e){console.error("Error setting up Stripe Connect:",e),m(e instanceof Error?e.message:"Failed to connect to Stripe")}finally{c(!1)}},[a,t]);(0,r.useEffect)(()=>{g()},[g]),(0,r.useEffect)(()=>{let e=window.location.hash.replace("#","");if(e.startsWith("payments-")){let t=e.replace("payments-","");["account","payments","payouts","balances","tax","documents"].includes(t)&&n(t)}},[]);let p=[{id:"account",label:"Account",icon:A.A},{id:"payments",label:"Payments",icon:T.A},{id:"payouts",label:"Payouts",icon:L.A},{id:"balances",label:"Balances",icon:E.A},{id:"tax",label:"Tax",icon:D.A},{id:"documents",label:"Documents",icon:P.A}],y=e=>{n(e),window.history.pushState(null,"","#payments-".concat(e))};return o?(0,s.jsx)("div",{className:"flex items-center justify-center py-16",children:(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsxs)("svg",{className:"animate-spin h-10 w-10 text-blue-600 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Loading payments dashboard..."})]})}):x?(0,s.jsx)("div",{className:"flex items-center justify-center py-16",children:(0,s.jsxs)("div",{className:"flex flex-col items-center max-w-md",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center mb-4",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Connection Error"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-center mb-4",children:x}),(0,s.jsx)("button",{onClick:g,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Try Again"})]})}):i?(0,s.jsxs)(I.MT,{connectInstance:i,"data-sentry-element":"ConnectComponentsProvider","data-sentry-component":"PaymentsDashboard","data-sentry-source-file":"dashboard.tsx",children:[(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsx)(I.Ex,{"data-sentry-element":"ConnectNotificationBanner","data-sentry-source-file":"dashboard.tsx"})}),(0,s.jsxs)("div",{className:"flex min-h-[600px] overflow-hidden",children:[(0,s.jsxs)("div",{className:"w-64 text-gray-900 dark:text-white flex flex-col bg-gray-700 rounded-lg",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("nav",{className:"space-y-1 px-4 pt-4",children:p.map(e=>{let t=e.icon;return(0,s.jsxs)("button",{onClick:()=>y(e.id),className:"w-full flex items-center gap-3 px-4 py-2 rounded-lg transition-colors ".concat(l===e.id?"bg-blue-600 text-white":"hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300"),children:[(0,s.jsx)(t,{size:20}),(0,s.jsx)("span",{children:e.label})]},e.id)})})}),(0,s.jsx)("div",{className:"p-4",children:(0,s.jsxs)("div",{className:"border border-gray-300 dark:border-gray-600 px-3 py-3 rounded-2xl text-center backdrop-blur-sm",children:[(0,s.jsx)("div",{className:"text-xs opacity-60 font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Stripe Account:"}),(0,s.jsx)("div",{className:"font-mono text-xs font-medium text-gray-700 dark:text-gray-300 select-text break-all leading-tight",onClick:e=>{let t=window.getSelection(),a=document.createRange();a.selectNodeContents(e.currentTarget),null==t||t.removeAllRanges(),null==t||t.addRange(a)},children:t})]})})]}),(0,s.jsx)("div",{className:"flex-1 overflow-auto bg-white dark:bg-gray-800",children:(0,s.jsxs)("div",{className:"p-6",children:["account"===l&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Account Management"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"View and manage your connected account details."}),(0,s.jsx)("div",{className:"stripe-component-container",children:(0,s.jsx)(I.LM,{})})]}),"payments"===l&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Payments"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"View your payment history, issue refunds, and manage disputes."}),(0,s.jsx)("div",{className:"stripe-component-container",children:(0,s.jsx)(I.qf,{})})]}),"payouts"===l&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Payouts"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Manage payouts to your bank account and view payout history."}),(0,s.jsx)("div",{className:"stripe-component-container",children:(0,s.jsx)(I.SO,{})})]}),"balances"===l&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Balances"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"View your current balance and available funds."}),(0,s.jsx)("div",{className:"stripe-component-container",children:(0,s.jsx)(I.gH,{})})]}),"tax"===l&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Tax Settings"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Configure tax settings and manage tax registrations."}),(0,s.jsxs)("div",{className:"stripe-component-container space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Tax Configuration"}),(0,s.jsx)(I.D_,{})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Tax Registrations"}),(0,s.jsx)(I.Ce,{})]})]})]}),"documents"===l&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Documents"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Access your tax forms, invoices, and other documents."}),(0,s.jsx)("div",{className:"stripe-component-container",children:(0,s.jsx)(I.Vs,{})})]})]})})]})]}):(0,s.jsx)("div",{className:"flex items-center justify-center py-16",children:(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Unable to load payments dashboard."})})}function z(e){let{projectData:t,subscriptionData:a,onProjectUpdate:r}=e;return t?t.stripeAccountId?(0,s.jsx)("div",{className:"mt-8","data-sentry-component":"PaymentsTab","data-sentry-source-file":"PaymentsTab.tsx",children:(0,s.jsx)(M,{stripeAccountId:t.stripeAccountId,projectId:t.id||t._id,"data-sentry-element":"PaymentsDashboard","data-sentry-source-file":"PaymentsTab.tsx"})}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mb-4",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Payments Profile Connected"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-center max-w-md mb-6",children:"To manage payments for this project, you'll need to set up a payments profile first. Ask the AI assistant to add payment functionality to your app."}),(0,s.jsx)("div",{className:"text-sm text-gray-400 dark:text-gray-500",children:"Powered by Stripe Connect"})]}):null}var U=a(53891),R=a(66798),_=a(53915),O=a(88196),B=a(57807),W=a(2679),V=a(96456),q=a.n(V),H=a(97665),J=a(65251),Y=a(82309),G=a(94335);let K=G.A.create({baseURL:"/api/databasepad/proxy"});function Q(){let e=(0,H.jE)();return{useApiQuery:(e,t,a)=>(0,J.I)({queryKey:(null==a?void 0:a.queryKey)||[e,t,null==a?void 0:a.limit,null==a?void 0:a.offset],queryFn:async()=>{if("functions"===t)return(await G.A.get("/api/databasepad/functions",{params:{projectId:e,action:"list"}})).data;let s={projectId:e,endpoint:t};return(null==a?void 0:a.limit)!==void 0&&(s.limit=a.limit),(null==a?void 0:a.offset)!==void 0&&(s.offset=a.offset),(await K.get("",{params:s})).data},...a}),useApiMutation:function(t,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return(0,Y.n)({mutationFn:async e=>(await K({method:s,url:"",data:e,params:{projectId:t,endpoint:a}})).data,onSuccess:()=>{e.invalidateQueries({queryKey:[t]})}})},useDbQuery:e=>(0,Y.n)({mutationFn:async t=>{let{query:a,params:s,readOnly:r}=t;if("migrations"===function(e){let t=e.trim();return/^\s*(CREATE|ALTER|DROP|TRUNCATE|COMMENT|GRANT|REVOKE|ANALYZE|VACUUM|REINDEX)\b/i.test(t)?"migrations":/\b(ROW LEVEL SECURITY|ENABLE ROW LEVEL SECURITY|DISABLE ROW LEVEL SECURITY|CREATE POLICY|ALTER POLICY|DROP POLICY)\b/i.test(t)||t.split(";").map(e=>e.trim()).filter(e=>e&&!e.startsWith("--")&&!/^\/\*[\s\S]*\*\/$/.test(e)).length>1?"migrations":"query"}(a)){let t=Date.now(),s=(await K.post("",{id:"sql_editor_".concat(t),sql:a},{params:{projectId:e,endpoint:"v1/projects/"+e+"/database/migrations/apply"}})).data;return{rows:[],rowCount:0,fields:[],migration:{applied:s.applied,idempotent:s.idempotent,statements:s.statements,durationMs:s.durationMs},message:s.applied?"✓ Migration applied successfully (".concat(s.statements," statement").concat(1!==s.statements?"s":"",", ").concat(s.durationMs,"ms)"):"✓ Migration already applied (idempotent)"}}{let t=(await K.post("",{sql:a,params:s,readOnly:r},{params:{projectId:e,endpoint:"v1/projects/"+e+"/database/query"}})).data;if(Array.isArray(t)){let e=t.length>0?Object.keys(t[0]).map(e=>({name:e})):[];return{rows:t,rowCount:t.length,fields:e}}return t}}})}}var X=a(83666),$=a(57972),Z=a(79160),ee=a(34624),et=a(36703),ea=a(84891),es=a(34117);function er(e){let{isOpen:t,onClose:a,onConfirm:r,title:l,message:n,confirmText:i="Confirm",cancelText:d="Cancel",confirmButtonClass:o="bg-red-600 hover:bg-red-700",isProcessing:c=!1}=e;return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[100]","data-sentry-component":"ConfirmationDialog","data-sentry-source-file":"ConfirmationDialog.tsx",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full shadow-xl",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center mb-4",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mr-3",children:(0,s.jsx)("svg",{className:"w-5 h-5 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"ConfirmationDialog.tsx",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 3 1.732 3z","data-sentry-element":"path","data-sentry-source-file":"ConfirmationDialog.tsx"})})}),(0,s.jsx)("div",{children:(0,s.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white",children:l})})]}),(0,s.jsx)("p",{className:"text-gray-700 dark:text-gray-300 text-sm",children:n})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:a,className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors font-medium rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700",disabled:c,children:d}),(0,s.jsx)("button",{onClick:r,disabled:c,className:"px-4 py-2 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors flex items-center ".concat(o),children:c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):i})]})]})}):null}let el=(e,t)=>{if(null==e)return"NULL";if(Array.isArray(e)){if(0===e.length)return"'{}'";let t=e.length>0&&"number"==typeof e[0],a=e.map(e=>t?String(e):'"'.concat(String(e).replace(/"/g,'\\"'),'"')).join(",");return"'{".concat(a,"}'")}let a=t.toLowerCase();return a.includes("array")||a.includes("[]")?"'{}'":a.includes("int")||a.includes("numeric")||a.includes("serial")?String(e):a.includes("bool")?!0===e||"true"===e?"true":"false":a.includes("json")?"'".concat(JSON.stringify(e).replace(/'/g,"''"),"'::jsonb"):"'".concat(String(e).replace(/'/g,"''"),"'")};function en(e){var t,a,l,n,i,d,o,c;let{projectId:x}=e,{useDbQuery:m}=Q(),[u,g]=(0,r.useState)([]),[h,p]=(0,r.useState)(null),[y,b]=(0,r.useState)(null),[j,f]=(0,r.useState)(""),[v,k]=(0,r.useState)(null),[N,w]=(0,r.useState)(!0),[C,S]=(0,r.useState)(!1),[A,T]=(0,r.useState)(null),[L,E]=(0,r.useState)(!1),[D,P]=(0,r.useState)(!1),[F,I]=(0,r.useState)(!1),[M,z]=(0,r.useState)(null),[U,R]=(0,r.useState)(!1),[_,O]=(0,r.useState)(null),[B,W]=(0,r.useState)(!1),[V,H]=(0,r.useState)(!1),[J,Y]=(0,r.useState)(null),[G,K]=(0,r.useState)("row"),en=m(x);(0,r.useEffect)(()=>{eo()},[x]);let eo=async()=>{w(!0),T(null);try{let e=await fetch("/api/databasepad/proxy?projectId=".concat(x,"&endpoint=v1/projects/").concat(x,"/database/tables"));if(!e.ok){let t=await e.json();if("project_not_found"===t.error||404===e.status){console.log("\uD83D\uDD04 Project ".concat(x," not found in DatabasePad, attempting to allocate..."));let t=await fetch("/api/databasepad/proxy?projectId=".concat(x,"&endpoint=v1/projects/").concat(x,"/database/allocate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mode:"shared"})});if(t.ok){if(console.log("✅ Successfully allocated project ".concat(x," in DatabasePad")),!(e=await fetch("/api/databasepad/proxy?projectId=".concat(x,"&endpoint=v1/projects/").concat(x,"/database/tables"))).ok){let t=await e.json();throw Error(t.error||t.details||"Failed to fetch tables after allocation")}}else{let e=await t.json();throw Error("Failed to allocate project: ".concat(e.error||e.details||"Unknown error"))}}else throw Error(t.error||t.details||"Failed to fetch tables")}let t=await e.json(),a=Array.isArray(t)?t.map(e=>({schema:e.table_schema,name:e.table_name,rls_enabled:!1,columns:(e.columns||[]).map(e=>({name:e.column_name||e.name,data_type:e.data_type,is_nullable:!1!==e.is_nullable&&"NO"!==e.is_nullable,default_value:e.column_default||e.default_value,is_primary:e.is_primary_key||e.is_primary||!1}))})):[];g(a)}catch(e){console.error("Error fetching tables:",e),T(e.message||"Failed to fetch tables")}finally{w(!1)}},ec=async e=>{S(!0),T(null);try{var t,a;let s=h&&(null===(t=u.find(t=>t.name===e))||void 0===t?void 0:t.schema)?"".concat(null===(a=u.find(t=>t.name===e))||void 0===a?void 0:a.schema,".").concat(e):e,r=await en.mutateAsync({query:"SELECT * FROM ".concat(s," LIMIT 100")});b(r)}catch(e){T(e.message||"Failed to fetch table data")}finally{S(!1)}},ex=async()=>{if(j.trim()){T(null);try{let e=await en.mutateAsync({query:j});k(e),e.migration&&eo()}catch(a){var e,t;T((null===(t=a.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.details)||a.message||"Query failed")}}},em=e=>{p(e),b(null),k(null),ec(e),P(!0)},eu=e=>{Y(e),H(!0)},eg=async()=>{var e,t,a;if(h&&y&&J){W(!0),T(null);try{let t=u.find(e=>e.name===h);if(!t)throw Error("Table not found");let a=(null===(e=t.columns)||void 0===e?void 0:e.filter(e=>e.is_primary))||[],s="";s=a.length>0?a.map(e=>{let t=J[e.name];if(null==t)return"".concat(e.name," IS NULL");let a=e.data_type||"";return"".concat(e.name," = ").concat(el(t,a))}).join(" AND "):Object.keys(J).map(e=>{var a;let s=J[e];if(null==s)return"".concat(e," IS NULL");let r=null===(a=t.columns)||void 0===a?void 0:a.find(t=>t.name===e),l=(null==r?void 0:r.data_type)||"";return"".concat(e," = ").concat(el(s,l))}).join(" AND ");let r=t.schema?t.schema.match(/[^a-z0-9_]/i)?'"'.concat(t.schema,'"'):t.schema:null,l=h.match(/[^a-z0-9_]/i)?'"'.concat(h,'"'):h,n=r?"".concat(r,".").concat(l):l,i="DELETE FROM ".concat(n," WHERE ").concat(s);await en.mutateAsync({query:i}),H(!1),Y(null),ec(h)}catch(e){T((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.details)||e.message||"Failed to delete row"),H(!1),Y(null)}finally{W(!1)}}},eh=e=>{O(e),R(!0)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-2 text-gray-900 dark:text-white",children:"Database"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"View and manage the data stored in your app."})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:()=>{z(null),K("row"),I(!0),T(null)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[(0,s.jsx)(X.A,{size:16,"data-sentry-element":"Plus","data-sentry-source-file":"database.tsx"}),"Insert"]}),(0,s.jsxs)("button",{onClick:()=>{E(!0),T(null)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,s.jsx)($.A,{size:16,"data-sentry-element":"Play","data-sentry-source-file":"database.tsx"}),"SQL Editor"]})]})]}),N?(0,s.jsx)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"Loading tables..."}):0===u.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(Z.A,{size:48,className:"mx-auto mb-4 text-gray-300 dark:text-gray-600"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No tables found"}),(0,s.jsx)("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create tables in your database to see them here"})]}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(e=>(0,s.jsxs)("div",{onClick:()=>em(e.name),className:"bg-white dark:bg-gray-900 rounded-lg shadow p-6 hover:shadow-lg transition-shadow cursor-pointer",children:[(0,s.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(Z.A,{className:"text-blue-600 dark:text-blue-400",size:24}),(0,s.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:e.name})]})}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Click to view table data"}),e.rls_enabled&&(0,s.jsx)("div",{className:"text-xs text-green-600 dark:text-green-400 font-medium",children:"✓ RLS Enabled"})]},e.name))})]}),L&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"SQL Editor"}),(0,s.jsx)("button",{onClick:()=>{E(!1),f(""),k(null),T(null),eo()},className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,s.jsx)(ee.A,{size:20})})]}),A&&(0,s.jsx)("div",{className:"mx-6 mt-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 animate-in fade-in slide-in-from-top-2 duration-300",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h4",{className:"font-semibold text-red-800 dark:text-red-300 mb-1",children:"Query Error"}),(0,s.jsx)("p",{className:"text-sm text-red-700 dark:text-red-400 font-mono break-words whitespace-pre-wrap",children:A})]}),(0,s.jsx)("button",{onClick:()=>T(null),className:"flex-shrink-0 p-1 text-red-400 hover:text-red-600 dark:hover:text-red-300 transition-colors",title:"Dismiss",children:(0,s.jsx)(ee.A,{size:16})})]})}),(0,s.jsxs)("div",{className:"p-6 flex-1 overflow-auto",children:[(0,s.jsx)("textarea",{value:j,onChange:e=>f(e.target.value),className:"w-full h-40 font-mono text-sm p-3 border dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",placeholder:"-- SQL Editor - Supports both DDL (schema changes) and DML (data operations)\n\n-- Create tables:\nCREATE TABLE posts (\n  id SERIAL PRIMARY KEY,\n  title TEXT NOT NULL,\n  content TEXT,\n  created_at TIMESTAMP DEFAULT NOW()\n);\n\n-- Query data:\nSELECT * FROM profiles LIMIT 10;\n\n-- Insert data:\nINSERT INTO posts (title, content) VALUES ('Hello', 'World');\n\n-- Note: Auth tables available as auth.users, etc.",autoFocus:!0}),(0,s.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[(0,s.jsx)("span",{className:"font-medium",children:"Auto-routing:"})," ","DDL/schema changes use migrations, data queries use query endpoint"]}),(0,s.jsx)("button",{onClick:ex,disabled:!j.trim()||en.isPending,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:en.isPending?"Running...":"Run Query"})]}),v&&(0,s.jsx)("div",{className:"mt-6",children:v.migration?(0,s.jsx)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-green-600 dark:text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-semibold text-green-800 dark:text-green-300 mb-1",children:"Schema Change Applied"}),(0,s.jsx)("p",{className:"text-sm text-green-700 dark:text-green-400",children:v.message}),v.migration.idempotent&&(0,s.jsx)("p",{className:"text-xs text-green-600 dark:text-green-500 mt-2",children:"Note: This migration was already applied previously (idempotent)."})]})]})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white",children:"Query Results"}),(0,s.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[v.rowCount," rows"]})]}),(0,s.jsx)("div",{className:"overflow-x-auto max-h-[400px] overflow-y-auto border dark:border-gray-700 rounded-lg",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,s.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800 sticky top-0",children:(0,s.jsx)("tr",{children:null===(t=v.fields)||void 0===t?void 0:t.map(e=>(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:e.name},e.name))})}),(0,s.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:(null===(a=v.rows)||void 0===a?void 0:a.length)===0?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:(null===(l=v.fields)||void 0===l?void 0:l.length)||1,className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"No data found"})}):null===(n=v.rows)||void 0===n?void 0:n.map((e,t)=>{var a;return(0,s.jsx)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:null===(a=v.fields)||void 0===a?void 0:a.map(t=>(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:null===e[t.name]?(0,s.jsx)("span",{className:"text-gray-400 dark:text-gray-500 italic",children:"NULL"}):"object"==typeof e[t.name]?(0,s.jsx)("code",{className:"text-xs bg-gray-100 dark:bg-gray-800 px-1 py-0.5 rounded",children:JSON.stringify(e[t.name])}):String(e[t.name])},t.name))},t)})})]})})]})})]})]})}),D&&h&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-6xl max-h-[90vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Table: ",h]}),(0,s.jsx)("button",{onClick:()=>{P(!1),p(null),b(null),T(null),eo()},className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,s.jsx)(ee.A,{size:20})})]}),A&&(0,s.jsx)("div",{className:"mx-6 mt-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 animate-in fade-in slide-in-from-top-2 duration-300",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h4",{className:"font-semibold text-red-800 dark:text-red-300 mb-1",children:"Error Loading Table"}),(0,s.jsx)("p",{className:"text-sm text-red-700 dark:text-red-400 font-mono break-words whitespace-pre-wrap",children:A})]}),(0,s.jsx)("button",{onClick:()=>T(null),className:"flex-shrink-0 p-1 text-red-400 hover:text-red-600 dark:hover:text-red-300 transition-colors",title:"Dismiss",children:(0,s.jsx)(ee.A,{size:16})})]})}),(0,s.jsx)("div",{className:"p-6 flex-1 overflow-auto",children:C?(0,s.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"Loading data..."}):y&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Showing first ",y.rows.length," rows"]}),(0,s.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Total: ",y.rowCount," rows"]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:()=>{z(h),K("column"),I(!0),T(null)},className:"flex items-center gap-2 px-3 py-1.5 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition-colors",children:[(0,s.jsx)(X.A,{size:16}),"Add Column"]}),(0,s.jsxs)("button",{onClick:()=>{z(h),K("csv"),I(!0),T(null)},className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors",children:[(0,s.jsx)(et.A,{size:16}),"Import CSV"]}),(0,s.jsxs)("button",{onClick:()=>{z(h),K("row"),I(!0),T(null)},className:"flex items-center gap-2 px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors",children:[(0,s.jsx)(X.A,{size:16}),"Add Row"]})]})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute right-0 top-0 bottom-0 w-8 bg-gradient-to-l from-white dark:from-gray-800 to-transparent pointer-events-none z-20 rounded-r-lg"}),(0,s.jsxs)("div",{style:{scrollbarWidth:"thin"},className:"jsx-b47993244c14b7f2 relative overflow-x-auto border dark:border-gray-700 rounded-lg max-h-[500px] overflow-y-auto",children:[(0,s.jsx)(q(),{id:"b47993244c14b7f2",children:"div.jsx-b47993244c14b7f2::-webkit-scrollbar{height:12px}div.jsx-b47993244c14b7f2::-webkit-scrollbar-track{background:rgb(31 41 55/.5);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px}div.jsx-b47993244c14b7f2::-webkit-scrollbar-thumb{background:rgb(75 85 99);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px}div.jsx-b47993244c14b7f2::-webkit-scrollbar-thumb:hover{background:rgb(107 114 128)}"}),(0,s.jsxs)("table",{className:"jsx-b47993244c14b7f2 min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,s.jsx)("thead",{className:"jsx-b47993244c14b7f2 bg-gray-50 dark:bg-gray-800",children:(0,s.jsxs)("tr",{className:"jsx-b47993244c14b7f2",children:[null===(i=y.fields)||void 0===i?void 0:i.map(e=>(0,s.jsx)("th",{className:"jsx-b47993244c14b7f2 sticky top-0 z-10 px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider bg-gray-50 dark:bg-gray-800",children:e.name},e.name)),(0,s.jsx)("th",{className:"jsx-b47993244c14b7f2 sticky top-0 right-0 z-20 px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider bg-gray-50 dark:bg-gray-800 border-l dark:border-gray-700",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"jsx-b47993244c14b7f2 bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:(null===(d=y.rows)||void 0===d?void 0:d.length)===0?(0,s.jsx)("tr",{className:"jsx-b47993244c14b7f2",children:(0,s.jsx)("td",{colSpan:((null===(o=y.fields)||void 0===o?void 0:o.length)||1)+1,className:"jsx-b47993244c14b7f2 px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"No data found"})}):null===(c=y.rows)||void 0===c?void 0:c.map((e,t)=>{var a;return(0,s.jsxs)("tr",{className:"jsx-b47993244c14b7f2 group hover:bg-gray-50 dark:hover:bg-gray-800",children:[null===(a=y.fields)||void 0===a?void 0:a.map(t=>(0,s.jsx)("td",{className:"jsx-b47993244c14b7f2 px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:null===e[t.name]?(0,s.jsx)("span",{className:"jsx-b47993244c14b7f2 text-gray-400 dark:text-gray-500 italic",children:"NULL"}):"object"==typeof e[t.name]?(0,s.jsx)("code",{className:"jsx-b47993244c14b7f2 text-xs bg-gray-100 dark:bg-gray-800 px-1 py-0.5 rounded",children:JSON.stringify(e[t.name])}):String(e[t.name])},t.name)),(0,s.jsx)("td",{className:"jsx-b47993244c14b7f2 sticky right-0 z-10 px-6 py-4 whitespace-nowrap text-right text-sm bg-white dark:bg-gray-900 group-hover:bg-gray-50 dark:group-hover:bg-gray-800 border-l dark:border-gray-700 transition-colors",children:(0,s.jsxs)("div",{className:"jsx-b47993244c14b7f2 flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:()=>eh(e),title:"Edit row",className:"jsx-b47993244c14b7f2 p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",children:(0,s.jsx)(ea.A,{size:16})}),(0,s.jsx)("button",{onClick:()=>eu(e),disabled:B,title:"Delete row",className:"jsx-b47993244c14b7f2 p-1.5 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:(0,s.jsx)(es.A,{size:16})})]})})]},t)})})]})]})]})]})})]})}),F&&(0,s.jsx)(ei,{projectId:x,tables:u,selectedTable:M,initialTab:G,onClose:()=>{I(!1),z(null),K("row"),T(null),eo(),h&&ec(h)},onTableSelect:z,dbQuery:en,onError:T}),U&&_&&h&&(0,s.jsx)(ed,{projectId:x,table:u.find(e=>e.name===h),row:_,onClose:()=>{R(!1),O(null),T(null),h&&ec(h)},dbQuery:en,onError:T}),(0,s.jsx)(er,{isOpen:V,onClose:()=>{H(!1),Y(null)},onConfirm:eg,title:"Delete Row",message:"Are you sure you want to delete this row? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",confirmButtonClass:"bg-red-600 hover:bg-red-700",isProcessing:B,"data-sentry-element":"ConfirmationDialog","data-sentry-source-file":"database.tsx"})]})}function ei(e){var t;let{projectId:a,tables:l,selectedTable:n,onClose:i,onTableSelect:d,dbQuery:o,onError:c,initialTab:x="row"}=e,[m,u]=(0,r.useState)(x),[g,h]=(0,r.useState)(n),[p]=(0,r.useState)(!!n),[y,b]=(0,r.useState)({}),[j,f]=(0,r.useState)(!1),[v,k]=(0,r.useState)(null),[N,w]=(0,r.useState)([]),[C,S]=(0,r.useState)(null),[A,T]=(0,r.useState)({name:"",dataType:"TEXT",isNullable:!0,defaultValue:"",isPrimary:!1}),L=l.find(e=>e.name===g);(0,r.useEffect)(()=>{if(g&&L&&"row"===m){var e;let t={};null===(e=L.columns)||void 0===e||e.forEach(e=>{var a;let s=(null===(a=e.default_value)||void 0===a?void 0:a.toLowerCase())||"";s.includes("gen_random_uuid")||s.includes("uuid_generate")?t[e.name]=crypto.randomUUID():s.includes("now()")||s.includes("current_timestamp")?t[e.name]=new Date().toISOString():s.includes("''::text")||"''::character varying"===s?t[e.name]="":s.includes("nextval")?t[e.name]="":e.is_nullable?t[e.name]=null:t[e.name]=""}),b(t)}},[g,m]);let E=async()=>{if(!g||!L){S("Please select a table");return}f(!0),S(null),c(null);try{let e=L.schema?L.schema.match(/[^a-z0-9_]/i)?'"'.concat(L.schema,'"'):L.schema:null,t=g.match(/[^a-z0-9_]/i)?'"'.concat(g,'"'):g,a=e?"".concat(e,".").concat(t):t,s=Object.keys(y).filter(e=>{let t=y[e];return null!=t&&""!==t});if(0===s.length){S("At least one column must have a value"),c("At least one column must have a value"),f(!1);return}let r=s.map(e=>{var t,a;let s=y[e],r=null===(t=L.columns)||void 0===t?void 0:t.find(t=>t.name===e),l=(null==r?void 0:null===(a=r.data_type)||void 0===a?void 0:a.toLowerCase())||"";return null==s||""===s?"NULL":l.includes("int")||l.includes("numeric")||l.includes("serial")?s:l.includes("bool")?!0===s||"true"===s?"true":"false":l.includes("json")||l.includes("jsonb")?"'".concat(JSON.stringify(s).replace(/'/g,"''"),"'::jsonb"):"'".concat(String(s).replace(/'/g,"''"),"'")}),l="INSERT INTO ".concat(a," (").concat(s.join(", "),") VALUES (").concat(r.join(", "),") RETURNING *"),n=await o.mutateAsync({query:l});if(n.rows&&n.rows.length>0)i();else{let e="Insert succeeded but no data returned";S(e),c(e)}}catch(s){var e,t;let a=(null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.details)||s.message||"Failed to insert row";S(a),c(a)}finally{f(!1)}},D=async()=>{if(!g||!L){S("Please select a table"),c("Please select a table");return}if(!A.name.trim()){S("Column name is required"),c("Column name is required");return}f(!0),S(null),c(null);try{let e=L.schema?L.schema.match(/[^a-z0-9_]/i)?'"'.concat(L.schema,'"'):L.schema:null,t=g.match(/[^a-z0-9_]/i)?'"'.concat(g,'"'):g,a=e?"".concat(e,".").concat(t):t,s="ALTER TABLE ".concat(a," ADD COLUMN ").concat(A.name," ").concat(A.dataType);if(A.isNullable||(s+=" NOT NULL"),A.defaultValue){let e=A.dataType.includes("int")||A.dataType.includes("numeric")?A.defaultValue:"'".concat(A.defaultValue.replace(/'/g,"''"),"'");s+=" DEFAULT ".concat(e)}A.isPrimary&&(s+=" PRIMARY KEY"),await o.mutateAsync({query:s}),i()}catch(s){var e,t;let a=(null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.details)||s.message||"Failed to add column";S(a),c(a)}finally{f(!1)}},P=async e=>{k(e),S(null);let t=(await e.text()).split("\n").filter(e=>e.trim());if(0===t.length){let e="CSV file is empty";S(e),c(e);return}let a=e=>{let t=[],a="",s=!1;for(let r=0;r<e.length;r++){let l=e[r];'"'===l?s=!s:","!==l||s?a+=l:(t.push(a.trim()),a="")}return t.push(a.trim()),t},s=a(t[0]);w(t.slice(1,Math.min(6,t.length)).map(e=>{let t=a(e),r={};return s.forEach((e,a)=>{r[e]=t[a]||""}),r}))},F=async()=>{if(!g||!L||!v){let e="Please select a table and upload a CSV file";S(e),c(e);return}f(!0),S(null),c(null);try{let e=(await v.text()).split("\n").filter(e=>e.trim());if(e.length<2){let e="CSV file must have at least a header row and one data row";S(e),c(e),f(!1);return}let t=e=>{let t=[],a="",s=!1;for(let r=0;r<e.length;r++){let l=e[r];'"'===l?s=!s:","!==l||s?a+=l:(t.push(a.trim()),a="")}return t.push(a.trim()),t},a=t(e[0]),s=L.schema?L.schema.match(/[^a-z0-9_]/i)?'"'.concat(L.schema,'"'):L.schema:null,r=g.match(/[^a-z0-9_]/i)?'"'.concat(g,'"'):g,l=s?"".concat(s,".").concat(r):r,n=[];for(let s=1;s<e.length;s++){let r=t(e[s]),l=a.map((e,t)=>{var a,s;let l=r[t]||"",n=null===(a=L.columns)||void 0===a?void 0:a.find(t=>t.name===e),i=(null==n?void 0:null===(s=n.data_type)||void 0===s?void 0:s.toLowerCase())||"";return""===l||null==l?"NULL":i.includes("int")||i.includes("numeric")||i.includes("serial")?l:i.includes("bool")?"true"===l||"1"===l?"true":"false":"'".concat(String(l).replace(/'/g,"''"),"'")});n.push("(".concat(l.join(", "),")"))}let d="INSERT INTO ".concat(l," (").concat(a.join(", "),") VALUES ").concat(n.join(", ")," RETURNING *"),x=await o.mutateAsync({query:d});if(x.rows&&x.rows.length>0)i();else{let e="Insert succeeded but no data returned";S(e),c(e)}}catch(s){var e,t;let a=(null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.details)||s.message||"Failed to insert CSV data";S(a),c(a)}finally{f(!1)}};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4","data-sentry-component":"InsertModal","data-sentry-source-file":"database.tsx",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Insert Data"}),(0,s.jsx)("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,s.jsx)(ee.A,{size:20,"data-sentry-element":"X","data-sentry-source-file":"database.tsx"})})]}),(0,s.jsxs)("div",{className:"px-6 pt-4 border-b dark:border-gray-700 flex gap-4",children:[(0,s.jsx)("button",{onClick:()=>u("row"),className:"pb-3 px-2 border-b-2 font-medium text-sm ".concat("row"===m?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:"Insert Row"}),(0,s.jsx)("button",{onClick:()=>u("column"),className:"pb-3 px-2 border-b-2 font-medium text-sm ".concat("column"===m?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:"Add Column"}),(0,s.jsx)("button",{onClick:()=>u("csv"),className:"pb-3 px-2 border-b-2 font-medium text-sm ".concat("csv"===m?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:"Import CSV"})]}),(0,s.jsxs)("div",{className:"p-6 flex-1 overflow-auto",children:[C&&(0,s.jsx)("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h4",{className:"font-semibold text-red-800 dark:text-red-300 mb-1",children:"Error"}),(0,s.jsx)("p",{className:"text-sm text-red-700 dark:text-red-400 font-mono break-words whitespace-pre-wrap",children:C})]}),(0,s.jsx)("button",{onClick:()=>{S(null),c(null)},className:"flex-shrink-0 p-1 text-red-400 hover:text-red-600 dark:hover:text-red-300 transition-colors",title:"Dismiss",children:(0,s.jsx)(ee.A,{size:16})})]})}),!p&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select Table"}),(0,s.jsxs)("select",{value:g||"",onChange:e=>{h(e.target.value||null),d(e.target.value||null)},className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:[(0,s.jsx)("option",{value:"",children:"-- Select a table --"}),l.map(e=>(0,s.jsx)("option",{value:e.name,children:e.name},e.name))]})]}),p&&g&&(0,s.jsx)("div",{className:"mb-6 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(U.A,{size:16,className:"text-blue-600 dark:text-blue-400"}),(0,s.jsxs)("span",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:["Adding row to: ",(0,s.jsx)("span",{className:"font-mono",children:g})]})]})}),"row"===m&&L&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"Insert New Row"}),null===(t=L.columns)||void 0===t?void 0:t.map((e,t)=>{var a,r,l,n;if(!e.name)return console.error("Column missing name:",e),null;let i=null===(a=e.data_type)||void 0===a?void 0:a.toLowerCase().includes("bool"),d=(null===(r=e.data_type)||void 0===r?void 0:r.toLowerCase().includes("int"))||(null===(l=e.data_type)||void 0===l?void 0:l.toLowerCase().includes("numeric"))||(null===(n=e.data_type)||void 0===n?void 0:n.toLowerCase().includes("serial")),o=y[e.name];return e.default_value&&(e.default_value.includes("(")||e.default_value.includes("::")||e.default_value.toLowerCase().includes("nextval")||e.default_value.toLowerCase().includes("current_timestamp")),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,s.jsx)("span",{className:"font-semibold",children:e.name}),!e.is_nullable&&(0,s.jsx)("span",{className:"text-red-500 ml-1",children:"*"}),(0,s.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:["(",e.data_type,")"]})]}),i?(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:!0===o||"true"===o,onChange:t=>{b(a=>({...a,[e.name]:t.target.checked}))},className:"w-4 h-4 rounded border-gray-300 dark:border-gray-600"}),(0,s.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:!0===o||"true"===o?"True":"False"})]}):(0,s.jsx)("input",{type:d?"number":"text",value:null!=o?String(o):"",onChange:t=>{let a=d?""===t.target.value?null:parseFloat(t.target.value):t.target.value;b(t=>({...t,[e.name]:a}))},placeholder:e.is_nullable?"Leave empty for NULL":"Required",className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]},"".concat(e.name,"-").concat(t))}),(0,s.jsx)("button",{onClick:E,disabled:j||!g,className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:j?"Inserting...":"Insert Row"})]}),"column"===m&&L&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"Add New Column"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Column Name ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{type:"text",value:A.name,onChange:e=>T({...A,name:e.target.value}),placeholder:"e.g., email, created_at",className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Data Type ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsxs)("select",{value:A.dataType,onChange:e=>T({...A,dataType:e.target.value}),className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:[(0,s.jsx)("option",{value:"TEXT",children:"TEXT"}),(0,s.jsx)("option",{value:"VARCHAR(255)",children:"VARCHAR(255)"}),(0,s.jsx)("option",{value:"INTEGER",children:"INTEGER"}),(0,s.jsx)("option",{value:"BIGINT",children:"BIGINT"}),(0,s.jsx)("option",{value:"NUMERIC",children:"NUMERIC"}),(0,s.jsx)("option",{value:"BOOLEAN",children:"BOOLEAN"}),(0,s.jsx)("option",{value:"TIMESTAMP",children:"TIMESTAMP"}),(0,s.jsx)("option",{value:"DATE",children:"DATE"}),(0,s.jsx)("option",{value:"JSONB",children:"JSONB"}),(0,s.jsx)("option",{value:"UUID",children:"UUID"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:A.isNullable,onChange:e=>T({...A,isNullable:e.target.checked}),className:"rounded"}),(0,s.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Allow NULL"})]}),(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:A.isPrimary,onChange:e=>T({...A,isPrimary:e.target.checked}),className:"rounded"}),(0,s.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Primary Key"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Default Value (optional)"}),(0,s.jsx)("input",{type:"text",value:A.defaultValue,onChange:e=>T({...A,defaultValue:e.target.value}),placeholder:"e.g., NOW(), 0, 'default'",className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]}),(0,s.jsx)("button",{onClick:D,disabled:j||!A.name.trim()||!g,className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:j?"Adding Column...":"Add Column"})]}),"csv"===m&&L&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"Import CSV File"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Upload CSV File"}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center",children:[(0,s.jsx)(et.A,{className:"mx-auto mb-2 text-gray-400",size:32}),(0,s.jsx)("input",{type:"file",accept:".csv",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&P(a)},className:"hidden",id:"csv-upload"}),(0,s.jsx)("label",{htmlFor:"csv-upload",className:"cursor-pointer text-blue-600 dark:text-blue-400 hover:underline",children:"Click to upload CSV"}),v&&(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:v.name})]})]}),N.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h5",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Preview (first 5 rows)"}),(0,s.jsx)("div",{className:"overflow-x-auto border dark:border-gray-700 rounded-lg max-h-64 overflow-y-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,s.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,s.jsx)("tr",{children:Object.keys(N[0]||{}).map(e=>(0,s.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:e},e))})}),(0,s.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:N.map((e,t)=>(0,s.jsx)("tr",{children:Object.values(e).map((e,t)=>(0,s.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 dark:text-gray-100",children:String(e)},t))},t))})]})})]}),(0,s.jsx)("button",{onClick:F,disabled:j||!v||!g,className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:j?"Importing...":"Import CSV"})]}),!g&&(0,s.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"Please select a table to continue"})]})]})})}function ed(e){var t;let{projectId:a,table:l,row:n,onClose:i,dbQuery:d,onError:o}=e,[c,x]=(0,r.useState)({...n}),[m,u]=(0,r.useState)(!1),[g,h]=(0,r.useState)(null),p=async()=>{var e,t,a;u(!0),h(null),o(null);try{let t=Object.keys(c).filter(e=>c[e]!==n[e]);if(0===t.length){let e="No changes detected";h(e),o(e),u(!1);return}let a=l.schema?l.schema.match(/[^a-z0-9_]/i)?'"'.concat(l.schema,'"'):l.schema:null,s=l.name.match(/[^a-z0-9_]/i)?'"'.concat(l.name,'"'):l.name,r=a?"".concat(a,".").concat(s):s,x=t.map(e=>{var t,a;let s=c[e],r=null===(t=l.columns)||void 0===t?void 0:t.find(t=>t.name===e),n=(null==r?void 0:null===(a=r.data_type)||void 0===a?void 0:a.toLowerCase())||"";return null==s||""===s?"".concat(e," = NULL"):n.includes("int")||n.includes("numeric")||n.includes("serial")?"".concat(e," = ").concat(s):n.includes("bool")?"".concat(e," = ").concat(!0===s||"true"===s?"true":"false"):n.includes("json")||n.includes("jsonb")?"".concat(e," = '").concat(JSON.stringify(s).replace(/'/g,"''"),"'::jsonb"):"".concat(e," = '").concat(String(s).replace(/'/g,"''"),"'")}).join(", "),m=(null===(e=l.columns)||void 0===e?void 0:e.filter(e=>e.is_primary))||[],g="";g=m.length>0?m.map(e=>{let t=n[e.name];if(null==t)return"".concat(e.name," IS NULL");let a=e.data_type||"";return"".concat(e.name," = ").concat(el(t,a))}).join(" AND "):Object.keys(n).map(e=>{var t;let a=n[e];if(null==a)return"".concat(e," IS NULL");let s=null===(t=l.columns)||void 0===t?void 0:t.find(t=>t.name===e),r=(null==s?void 0:s.data_type)||"";return"".concat(e," = ").concat(el(a,r))}).join(" AND ");let p="UPDATE ".concat(r," SET ").concat(x," WHERE ").concat(g," RETURNING *"),y=await d.mutateAsync({query:p});if(y.rows&&y.rows.length>0)i();else{let e="Update succeeded but no data returned";h(e),o(e)}}catch(s){let e=(null===(a=s.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.details)||s.message||"Failed to update row";h(e),o(e)}finally{u(!1)}};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4","data-sentry-component":"EditRowModal","data-sentry-source-file":"database.tsx",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Edit Row - ",l.name]}),(0,s.jsx)("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,s.jsx)(ee.A,{size:20,"data-sentry-element":"X","data-sentry-source-file":"database.tsx"})})]}),(0,s.jsxs)("div",{className:"p-6 flex-1 overflow-auto",children:[g&&(0,s.jsx)("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h4",{className:"font-semibold text-red-800 dark:text-red-300 mb-1",children:"Error"}),(0,s.jsx)("p",{className:"text-sm text-red-700 dark:text-red-400 font-mono break-words whitespace-pre-wrap",children:g})]}),(0,s.jsx)("button",{onClick:()=>{h(null),o(null)},className:"flex-shrink-0 p-1 text-red-400 hover:text-red-600 dark:hover:text-red-300 transition-colors",title:"Dismiss",children:(0,s.jsx)(ee.A,{size:16})})]})}),(0,s.jsx)("div",{className:"space-y-4",children:null===(t=l.columns)||void 0===t?void 0:t.map((e,t)=>{var a,r,l,n;if(!e.name)return null;let i=null===(a=e.data_type)||void 0===a?void 0:a.toLowerCase().includes("bool"),d=(null===(r=e.data_type)||void 0===r?void 0:r.toLowerCase().includes("int"))||(null===(l=e.data_type)||void 0===l?void 0:l.toLowerCase().includes("numeric"))||(null===(n=e.data_type)||void 0===n?void 0:n.toLowerCase().includes("serial")),o=c[e.name],m=e.is_primary;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[(0,s.jsx)("span",{className:"font-semibold",children:e.name}),m&&(0,s.jsx)("span",{className:"ml-2 text-xs bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-2 py-0.5 rounded",children:"PRIMARY KEY"}),!e.is_nullable&&(0,s.jsx)("span",{className:"text-red-500 ml-1",children:"*"}),(0,s.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:["(",e.data_type,")"]})]}),i?(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:!0===o||"true"===o,onChange:t=>{x(a=>({...a,[e.name]:t.target.checked}))},disabled:m,className:"w-4 h-4 rounded border-gray-300 dark:border-gray-600 disabled:opacity-50"}),(0,s.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:!0===o||"true"===o?"True":"False"})]}):(0,s.jsx)("input",{type:d?"number":"text",value:null!=o?String(o):"",onChange:t=>{let a=d?""===t.target.value?null:parseFloat(t.target.value):t.target.value;x(t=>({...t,[e.name]:a}))},disabled:m,placeholder:e.is_nullable?"Leave empty for NULL":"Required",className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 disabled:opacity-50 disabled:bg-gray-100 dark:disabled:bg-gray-800"}),m&&(0,s.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Primary key cannot be modified"})]},"".concat(e.name,"-").concat(t))})})]}),(0,s.jsxs)("div",{className:"px-6 py-4 border-t dark:border-gray-700 flex justify-end gap-3",children:[(0,s.jsx)("button",{onClick:i,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:p,disabled:m,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Updating...":"Update Row"})]})]})})}var eo=a(46745),ec=a(14265),ex=a(33191),em=a(84574),eu=a(56878);function eg(e){var t;let{projectId:a,projectUrl:l}=e,{useApiMutation:n}=Q(),[i,d]=(0,r.useState)(null),[o,c]=(0,r.useState)([]),[x,m]=(0,r.useState)(!1),[u,g]=(0,r.useState)([]),[h,p]=(0,r.useState)(!1),[y,b]=(0,r.useState)(!1),[j,f]=(0,r.useState)(""),[v,k]=(0,r.useState)(!1),[N,w]=(0,r.useState)(!1),[C,S]=(0,r.useState)(!1),[A,T]=(0,r.useState)(""),[L,E]=(0,r.useState)(!1),[D,P]=(0,r.useState)(null),[F,I]=(0,r.useState)(!1),[M,z]=(0,r.useState)(null),[U,_]=(0,r.useState)(!1),[O,B]=(0,r.useState)(!1),[W,V]=(0,r.useState)(null),[q,H]=(0,r.useState)(null),[J,Y]=(0,r.useState)(null),G=(0,r.useRef)(null),K=async()=>{m(!0);try{let e=await fetch("/api/databasepad/storage/list-buckets?projectId=".concat(a));if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to fetch buckets")}let t=await e.json();console.log("Raw buckets response:",t);let s=Array.isArray(t)?t.map(e=>({name:e.bucketName||e.name,public:e.public,created_at:e.createdAt||e.created_at})):[];c(s)}catch(e){console.error("Failed to fetch buckets:",e),c([])}finally{m(!1)}};(0,r.useEffect)(()=>{K()},[a]);let $=n(a,"v1/projects/".concat(a,"/storage/buckets"));(0,r.useEffect)(()=>{i&&N&&Z(i)},[i,N]);let Z=async e=>{p(!0);try{let t=await fetch("/api/databasepad/storage/list-files?projectId=".concat(a,"&bucketName=").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prefix:"",limit:100,offset:0})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to fetch files")}let s=await t.json();console.log("Raw file list response:",s);let r=s.items||s.objects||s||[],l=(Array.isArray(r)?r:[]).map(e=>{var t;let a=e.name||e.key||e.path||"";return a&&!a.startsWith("public/")&&""!==a.trim()&&(a="public/".concat(a)),{name:a,size:e.size||(null===(t=e.metadata)||void 0===t?void 0:t.size)||0,lastModified:e.lastModified||e.last_modified||e.updated_at||e.created_at||new Date().toISOString(),etag:e.etag||e.id}}).filter(e=>e.name&&""!==e.name.trim()&&"public/"!==e.name);console.log("Normalized files:",l),g(l)}catch(e){console.error("Failed to fetch files:",e),g([])}finally{p(!1)}},ea=async()=>{if(j.trim())try{await $.mutateAsync({name:j,public:v}),f(""),k(!1),b(!1),K(),Y('Bucket "'.concat(j,'" created successfully as ').concat(v?"public":"private","!")),setTimeout(()=>Y(null),3e3)}catch(a){var e,t;H((null===(t=a.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"Failed to create bucket"),setTimeout(()=>H(null),5e3)}},el=e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},en=()=>{var e;if(!i)return!1;let t=o.find(e=>e.name===i);return null!==(e=null==t?void 0:t.public)&&void 0!==e&&e},ei=(e,t)=>{if(!l||!e||!t)return null;let a=o.find(t=>t.name===e);if(!(null==a?void 0:a.public))return null;let s=t.split("/").map(encodeURIComponent).join("/");return"".concat(l,"/storage/v1/object/public/").concat(e,"/").concat(s)},ed=async(e,t)=>{let a=ei(e,t);if(!a){console.error("Unable to generate public URL",{bucketName:e,filePath:t}),H("Unable to generate public URL"),setTimeout(()=>H(null),3e3);return}console.log("\uD83D\uDCCB Copying URL to clipboard:",a);try{await navigator.clipboard.writeText(a),z(a),console.log("✅ URL copied successfully"),setTimeout(()=>z(null),2e3)}catch(e){console.error("❌ Failed to copy URL:",e);try{let e=document.createElement("textarea");e.value=a,e.style.position="fixed",e.style.left="-999999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),z(a),console.log("✅ URL copied successfully (fallback method)"),setTimeout(()=>z(null),2e3)}catch(e){console.error("❌ Fallback copy failed:",e),H("Failed to copy URL. Please copy manually from the table."),setTimeout(()=>H(null),5e3)}}},eg=(e,t)=>{let a=ei(e,t);a&&window.open(a,"_blank")},eh=e=>{d(e),w(!0)},ep=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&i&&await ey(a),G.current&&(G.current.value="")},ey=async e=>{if(i){S(!0),T("Uploading ".concat(e.name,"..."));try{let t=new FormData;t.append("file",e);let s="public/".concat(e.name),r=await fetch("/api/databasepad/storage/upload?projectId=".concat(a,"&bucketName=").concat(i,"&filePath=").concat(encodeURIComponent(s)),{method:"POST",body:t});if(!r.ok){let e=await r.json();throw Error(e.error||"Upload failed")}let l=await r.json();if(console.log("Upload successful:",l),await Z(i),l.publicURL){console.log("✅ Public URL from DatabasePad:",l.publicURL),T("Upload complete! URL: ".concat(l.publicURL));try{await navigator.clipboard.writeText(l.publicURL),z(l.publicURL),setTimeout(()=>z(null),3e3)}catch(e){console.error("Failed to auto-copy URL:",e)}setTimeout(()=>T(""),5e3)}else T("Upload complete!"),setTimeout(()=>T(""),2e3)}catch(e){console.error("Upload error:",e),H("Upload failed: ".concat(e.message)),setTimeout(()=>H(null),5e3),T("")}finally{S(!1)}}},eb=async e=>{if(i&&e.name)try{var t;let s=await fetch("/api/databasepad/storage/download?projectId=".concat(a,"&bucketName=").concat(i,"&filePath=").concat(encodeURIComponent(e.name)));if(!s.ok){let e=await s.json();throw Error(e.error||"Download failed")}let r=await s.blob(),l=window.URL.createObjectURL(r),n=document.createElement("a");n.href=l,n.download=(null===(t=e.name)||void 0===t?void 0:t.split("/").pop())||"download",document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(l),document.body.removeChild(n)}catch(e){console.error("Download error:",e),H("Download failed: ".concat(e.message||"Unknown error")),setTimeout(()=>H(null),5e3)}},ej=e=>{P(e),E(!0)},ef=async()=>{if(!i||!D||!D.name)return;I(!0);let e="/api/databasepad/storage/delete?projectId=".concat(a,"&bucketName=").concat(i,"&filePath=").concat(encodeURIComponent(D.name));console.log("\uD83D\uDDD1️  Deleting file:",{bucket:i,filePath:D.name,url:e});try{let t=await fetch(e,{method:"DELETE"});console.log("\uD83D\uDCE5 Delete response status:",t.status);let a=await t.json();if(console.log("\uD83D\uDCE5 Delete response data:",a),!t.ok)throw Error(a.error||"Delete failed");console.log("✅ Delete successful"),await Z(i),E(!1),P(null),Y("File deleted successfully"),setTimeout(()=>Y(null),3e3)}catch(e){console.error("❌ Delete error:",e),H("Delete failed: ".concat(e.message)),setTimeout(()=>H(null),5e3),E(!1),P(null)}finally{I(!1)}},ev=e=>{let t=o.find(t=>t.name===e);t&&(V({name:e,currentlyPublic:t.public}),B(!0))},ek=async()=>{if(!W)return;let{name:e,currentlyPublic:t}=W,s=!t,r=s?"public":"private";_(!0),B(!1);try{let t=await fetch("/api/databasepad/storage/update-bucket?projectId=".concat(a,"&bucketName=").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({public:s})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to update bucket")}console.log("✅ Bucket visibility updated"),await K(),i===e&&await Z(e),Y('Bucket "'.concat(e,'" is now ').concat(r,"!")),setTimeout(()=>Y(null),3e3)}catch(e){var l,n;console.error("❌ Toggle visibility error:",e),(null===(l=e.message)||void 0===l?void 0:l.includes("not_found"))||(null===(n=e.message)||void 0===n?void 0:n.includes("404"))?H("Toggle visibility feature coming soon!\n\nDatabasePad is deploying this feature. For now:\n• Delete bucket and recreate as ".concat(r,"\n• Or create a new ").concat(r," bucket")):H("Failed to update bucket: ".concat(e.message)),setTimeout(()=>H(null),8e3)}finally{_(!1),V(null)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(er,{isOpen:L,onClose:()=>{E(!1),P(null)},onConfirm:ef,title:"Delete File?",message:'Are you sure you want to delete "'.concat((null==D?void 0:null===(t=D.name)||void 0===t?void 0:t.split("/").pop())||"this file",'"? This action cannot be undone.'),confirmText:"Delete",cancelText:"Cancel",isProcessing:F,"data-sentry-element":"ConfirmationDialog","data-sentry-source-file":"storage.tsx"}),(0,s.jsx)(er,{isOpen:O,onClose:()=>{B(!1),V(null)},onConfirm:ek,title:'Make "'.concat(null==W?void 0:W.name,'" ').concat((null==W?void 0:W.currentlyPublic)?"Private":"Public","?"),message:(null==W?void 0:W.currentlyPublic)?"Files will require authentication to access. Public URLs will stop working.":"Files will be accessible via public URLs without authentication.",confirmText:(null==W?void 0:W.currentlyPublic)?"Make Private":"Make Public",cancelText:"Cancel",isProcessing:U,"data-sentry-element":"ConfirmationDialog","data-sentry-source-file":"storage.tsx"}),(0,s.jsxs)("div",{className:"space-y-6",children:[q&&(0,s.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-red-600 dark:text-red-400 mt-0.5",children:"⚠"}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("p",{className:"text-sm font-medium text-red-700 dark:text-red-300 whitespace-pre-wrap",children:q})}),(0,s.jsx)("button",{onClick:()=>H(null),className:"text-red-400 hover:text-red-600 dark:hover:text-red-200",children:(0,s.jsx)(ee.A,{size:16})})]})}),J&&(0,s.jsx)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-green-600 dark:text-green-400 mt-0.5",children:"✓"}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("p",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:J})}),(0,s.jsx)("button",{onClick:()=>Y(null),className:"text-green-400 hover:text-green-600 dark:hover:text-green-200",children:(0,s.jsx)(ee.A,{size:16})})]})}),(0,s.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-2 text-gray-900 dark:text-white",children:"File Buckets"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Store and serve files for your app. Public buckets provide direct URLs."})]}),(0,s.jsxs)("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex-shrink-0 mt-1",children:[(0,s.jsx)(X.A,{size:16,"data-sentry-element":"Plus","data-sentry-source-file":"storage.tsx"}),"New Bucket"]})]}),y&&(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-6 mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"Create New Bucket"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("input",{type:"text",value:j,onChange:e=>f(e.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"-")),placeholder:"bucket-name",className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"}),(0,s.jsxs)("label",{className:"flex items-start gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:v,onChange:e=>k(e.target.checked),className:"rounded text-blue-600 focus:ring-blue-500 mt-1"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-700 dark:text-gray-300 font-medium",children:"Public bucket"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:"Files get public URLs for use in your app (e.g., image sources). Uncheck for sensitive files that should only be downloaded."})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:ea,disabled:!j.trim()||$.isPending,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:$.isPending?"Creating...":"Create Bucket"}),(0,s.jsx)("button",{onClick:()=>{b(!1),f(""),k(!1)},className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:"Cancel"})]})]})]}),x?(0,s.jsx)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"Loading buckets..."}):o&&0!==o.length?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(e=>(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-6 hover:shadow-lg transition-shadow min-w-[280px]",children:[(0,s.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1 cursor-pointer",onClick:()=>eh(e.name),children:[(0,s.jsx)(R.A,{className:"text-blue-600 dark:text-blue-400",size:24}),(0,s.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:e.name})]})}),(0,s.jsxs)("div",{className:"mb-4 cursor-pointer",onClick:()=>eh(e.name),children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Click to view files"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:e.public?"Files have public URLs":"Files require authentication"})]}),(0,s.jsxs)("button",{onClick:t=>{t.stopPropagation(),ev(e.name)},disabled:U,className:"flex items-center gap-1.5 text-xs px-3 py-1.5 rounded-full transition-all w-full justify-center ".concat(e.public?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-900/40":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"," disabled:opacity-50 disabled:cursor-not-allowed"),title:"Click to make ".concat(e.public?"private":"public"),children:[e.public?(0,s.jsx)(eo.A,{size:14}):(0,s.jsx)(ec.A,{size:14}),(0,s.jsx)("span",{className:"font-medium",children:U?"Updating...":e.public?"Public":"Private"}),(0,s.jsx)("span",{className:"text-xs opacity-60",children:"• Click to toggle"})]})]},e.name))}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(R.A,{size:48,className:"mx-auto mb-4 text-gray-300 dark:text-gray-600"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No buckets yet"}),(0,s.jsx)("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create your first bucket to start storing files"})]})]}),N&&i&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Files in ",i]}),(0,s.jsxs)("button",{onClick:()=>i&&ev(i),disabled:U,className:"flex items-center gap-1.5 text-xs px-2 py-1 rounded-full transition-colors ".concat(en()?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-900/40":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700"," disabled:opacity-50 disabled:cursor-not-allowed"),title:"Click to make ".concat(en()?"private":"public"),children:[en()?(0,s.jsx)(eo.A,{size:12}):(0,s.jsx)(ec.A,{size:12}),U?"Updating...":en()?"Public":"Private"]})]}),!en()&&(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Private bucket - files must be downloaded. Click badge to make public."}),en()&&(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Public bucket - files have direct URLs for use in your app"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("button",{onClick:()=>{var e;null===(e=G.current)||void 0===e||e.click()},disabled:C,className:"flex items-center gap-2 px-3 py-1.5 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 disabled:opacity-50",children:[(0,s.jsx)(et.A,{size:16}),C?"Uploading...":"Upload File"]}),(0,s.jsx)("input",{ref:G,type:"file",accept:"*/*",onChange:ep,className:"hidden",title:"Upload any file type (images, videos, documents, audio, etc.)"}),(0,s.jsx)("button",{onClick:()=>{w(!1),d(null),g([])},className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,s.jsx)(ee.A,{size:20})})]})]}),(0,s.jsxs)("div",{className:"p-6 flex-1 overflow-auto",children:[A&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:A.startsWith("Upload complete! URL:")?(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-blue-600 dark:text-blue-400 mt-0.5",children:"✓"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-blue-700 dark:text-blue-300 mb-1",children:"Upload complete! URL copied to clipboard"}),(0,s.jsx)("code",{className:"text-xs text-blue-600 dark:text-blue-400 bg-blue-100 dark:bg-blue-900/40 px-2 py-1 rounded block truncate",children:A.replace("Upload complete! URL: ","")})]})]}):(0,s.jsx)("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:A})}),M&&!A&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-green-600 dark:text-green-400 mt-0.5",children:"✓"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-green-700 dark:text-green-300 mb-1",children:"URL copied to clipboard!"}),(0,s.jsx)("p",{className:"text-xs text-green-600 dark:text-green-400 truncate",children:M})]})]})}),h?(0,s.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"Loading files..."}):0===u.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(R.A,{size:48,className:"mx-auto mb-4 text-gray-300 dark:text-gray-600"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No files in this bucket"}),(0,s.jsx)("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Upload files to get started"})]}):(0,s.jsx)("div",{className:"overflow-x-auto border dark:border-gray-700 rounded-lg",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,s.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Name"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Size"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Last Modified"}),l&&(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"URL (for use in your app)"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:u.map((e,t)=>{var a;let r=i&&e.name?ei(i,e.name):null,n=M===r;return(0,s.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:(null===(a=e.name)||void 0===a?void 0:a.split("/").pop())||"Unknown"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:el(e.size||0)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.lastModified?new Date(e.lastModified).toLocaleDateString():"N/A"}),l&&(0,s.jsx)("td",{className:"px-6 py-4 text-sm",children:r?(0,s.jsx)("div",{className:"max-w-sm",children:(0,s.jsxs)("div",{className:"relative group",children:[(0,s.jsx)("code",{className:"text-xs text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded block truncate",title:r,children:r}),(0,s.jsx)("div",{className:"hidden group-hover:block absolute left-0 top-full mt-1 z-10 bg-gray-900 dark:bg-gray-700 text-white text-xs rounded px-2 py-1 whitespace-nowrap shadow-lg",children:r})]})}):(0,s.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 italic",children:"Private - use download"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm",children:(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>ed(i,e.name),className:"p-1 rounded transition-colors ".concat(n?"text-green-600 dark:text-green-400 bg-green-100 dark:bg-green-900/20":"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"),title:n?"Copied!":"Copy URL for use in your app",children:(0,s.jsx)(ex.A,{size:16})}),(0,s.jsx)("button",{onClick:()=>eg(i,e.name),className:"p-1 rounded text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",title:"Open file in new tab",children:(0,s.jsx)(em.A,{size:16})})]}),(0,s.jsx)("button",{onClick:()=>eb(e),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",title:"Download file",children:(0,s.jsx)(eu.A,{size:16})}),(0,s.jsx)("button",{onClick:()=>ej(e),className:"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",title:"Delete file",children:(0,s.jsx)(es.A,{size:16})})]})})]},e.name||"file-".concat(t))})})]})})]})]})})]})}function eh(e){var t,a,l,n,i,d,o,c,x,m,u,h;let{projectId:p}=e,{useApiQuery:y,useApiMutation:b}=Q(),[j,f]=(0,r.useState)({}),[v,k]=(0,r.useState)(!1),[N,w]=(0,r.useState)(!1),{data:C,isLoading:S,error:A}=y(p,"v1/projects/"+p+"/config/auth");(0,r.useEffect)(()=>{(null==C?void 0:C.config)?(f(C.config),k(!1),w(!1)):A&&(console.error("Failed to load auth settings:",A),f({disable_signup:!1,email_enabled:!1,email_confirm_signup:!1,site_url:"https://example.com",jwt_exp:3600,smtp:{host:"",port:587,user:"",from:"noreply@example.com",secure:!1,has_password:!1},emailTemplates:{signup:{subject:"Confirm your email",text:null,html:null},reset:{subject:"Reset your password",text:null,html:null},invite:{subject:"You've been invited",text:null,html:null}}}))},[C,A]);let T=b(p,"v1/projects/"+p+"/config/auth","PATCH"),L=(e,t)=>{f(a=>{let s={...a},r=e.split("."),l=s;for(let e=0;e<r.length-1;e++)l[r[e]]||(l[r[e]]={}),l=l[r[e]];return l[r[r.length-1]]=t,s}),k(!0),"smtp.pass"===e&&w(!0)},E=async()=>{var e,t,a,s,r,l,n,i,d,o,c,x,m,u,h,y,b,v,N,C,S,A,L,E,D,P,F;try{let A={disable_signup:null!==(N=j.disable_signup)&&void 0!==N&&N,email_enabled:null!==(C=j.email_enabled)&&void 0!==C&&C,email_confirm_signup:null!==(S=j.email_confirm_signup)&&void 0!==S&&S,site_url:j.site_url||"https://example.com",jwt_exp:j.jwt_exp||3600,emailTemplates:{signup:{subject:(null===(t=j.emailTemplates)||void 0===t?void 0:null===(e=t.signup)||void 0===e?void 0:e.subject)||"Confirm your email",text:(null===(s=j.emailTemplates)||void 0===s?void 0:null===(a=s.signup)||void 0===a?void 0:a.text)||null,html:(null===(l=j.emailTemplates)||void 0===l?void 0:null===(r=l.signup)||void 0===r?void 0:r.html)||null},reset:{subject:(null===(i=j.emailTemplates)||void 0===i?void 0:null===(n=i.reset)||void 0===n?void 0:n.subject)||"Reset your password",text:(null===(o=j.emailTemplates)||void 0===o?void 0:null===(d=o.reset)||void 0===d?void 0:d.text)||null,html:(null===(x=j.emailTemplates)||void 0===x?void 0:null===(c=x.reset)||void 0===c?void 0:c.html)||null},invite:{subject:(null===(u=j.emailTemplates)||void 0===u?void 0:null===(m=u.invite)||void 0===m?void 0:m.subject)||"You've been invited",text:(null===(y=j.emailTemplates)||void 0===y?void 0:null===(h=y.invite)||void 0===h?void 0:h.text)||null,html:(null===(v=j.emailTemplates)||void 0===v?void 0:null===(b=v.invite)||void 0===b?void 0:b.html)||null}}};console.log("Saving auth settings for project:",p),console.log("API payload:",A);let L=await T.mutateAsync(A);console.log("Auth settings saved successfully:",L),(null==L?void 0:L.config)&&f(L.config),k(!1),w(!1),g.Ay.success("Authentication settings saved successfully!")}catch(a){console.error("Failed to save auth settings:",a),console.error("Error details:",{message:a.message,response:null===(A=a.response)||void 0===A?void 0:A.data,status:null===(L=a.response)||void 0===L?void 0:L.status});let e=(null===(D=a.response)||void 0===D?void 0:null===(E=D.data)||void 0===E?void 0:E.error)||a.message||"Failed to save settings",t=null===(F=a.response)||void 0===F?void 0:null===(P=F.data)||void 0===P?void 0:P.details;t?g.Ay.error("".concat(e,"\n\nDetails: ").concat(JSON.stringify(t,null,2))):g.Ay.error(e)}};return S?(0,s.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:"Loading authentication settings..."}):(0,s.jsxs)("div",{className:"space-y-6","data-sentry-component":"AuthenticationTab","data-sentry-source-file":"authentication.tsx",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-2 text-gray-900 dark:text-white",children:"Authentication"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Configure authentication settings for your project. These settings control how users sign up and sign in."})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700",children:(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"General Settings"})}),(0,s.jsxs)("div",{className:"p-6 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"flex items-center gap-3",children:[(0,s.jsx)("input",{type:"checkbox",checked:j.disable_signup||!1,onChange:e=>L("disable_signup",e.target.checked),className:"rounded text-blue-600 focus:ring-blue-500"}),(0,s.jsx)("span",{className:"text-gray-900 dark:text-gray-100",children:"Disable new user signups"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 ml-6 mt-1",children:"When enabled, new users cannot sign up. Only existing users can sign in."})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"flex items-center gap-3",children:[(0,s.jsx)("input",{type:"checkbox",checked:j.email_enabled||!1,onChange:e=>L("email_enabled",e.target.checked),className:"rounded text-blue-600 focus:ring-blue-500"}),(0,s.jsx)("span",{className:"text-gray-900 dark:text-gray-100",children:"Enable email authentication"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 ml-6 mt-1",children:"Enable email-based signup and login, password reset, and email notifications."})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"flex items-center gap-3",children:[(0,s.jsx)("input",{type:"checkbox",checked:j.email_confirm_signup||!1,onChange:e=>L("email_confirm_signup",e.target.checked),className:"rounded text-blue-600 focus:ring-blue-500"}),(0,s.jsx)("span",{className:"text-gray-900 dark:text-gray-100",children:"Require email confirmation"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 ml-6 mt-1",children:"New users must verify their email address before they can sign in."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Site URL"}),(0,s.jsx)("input",{type:"url",value:j.site_url||"",onChange:e=>L("site_url",e.target.value),className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",placeholder:"https://yourdomain.com"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"The base URL of your application for redirects and email links."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"JWT Expiration (seconds)"}),(0,s.jsx)("input",{type:"number",value:j.jwt_exp||3600,onChange:e=>L("jwt_exp",parseInt(e.target.value)),className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",min:"300",max:"86400"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"How long JWT tokens remain valid (300-86400 seconds)."})]})]})]}),!1,(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b dark:border-gray-700",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Email Templates"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Customize email templates for signup, password reset, and invites."})]}),(0,s.jsxs)("div",{className:"p-6 space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Signup Confirmation"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Subject"}),(0,s.jsx)("input",{type:"text",value:(null===(a=j.emailTemplates)||void 0===a?void 0:null===(t=a.signup)||void 0===t?void 0:t.subject)||"",onChange:e=>L("emailTemplates.signup.subject",e.target.value),className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",placeholder:"Confirm your email"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"HTML Template (optional)"}),(0,s.jsx)("textarea",{value:(null===(n=j.emailTemplates)||void 0===n?void 0:null===(l=n.signup)||void 0===l?void 0:l.html)||"",onChange:e=>L("emailTemplates.signup.html",e.target.value||null),className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",rows:3,placeholder:"Leave empty to use default template"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Password Reset"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Subject"}),(0,s.jsx)("input",{type:"text",value:(null===(d=j.emailTemplates)||void 0===d?void 0:null===(i=d.reset)||void 0===i?void 0:i.subject)||"",onChange:e=>L("emailTemplates.reset.subject",e.target.value),className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",placeholder:"Reset your password"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"HTML Template (optional)"}),(0,s.jsx)("textarea",{value:(null===(c=j.emailTemplates)||void 0===c?void 0:null===(o=c.reset)||void 0===o?void 0:o.html)||"",onChange:e=>L("emailTemplates.reset.html",e.target.value||null),className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",rows:3,placeholder:"Leave empty to use default template"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"User Invitation"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Subject"}),(0,s.jsx)("input",{type:"text",value:(null===(m=j.emailTemplates)||void 0===m?void 0:null===(x=m.invite)||void 0===x?void 0:x.subject)||"",onChange:e=>L("emailTemplates.invite.subject",e.target.value),className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",placeholder:"You've been invited"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"HTML Template (optional)"}),(0,s.jsx)("textarea",{value:(null===(h=j.emailTemplates)||void 0===h?void 0:null===(u=h.invite)||void 0===u?void 0:u.html)||"",onChange:e=>L("emailTemplates.invite.html",e.target.value||null),className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",rows:3,placeholder:"Leave empty to use default template"})]})]})]})]})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("button",{onClick:E,disabled:!v||T.isPending,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:T.isPending?"Saving...":"Save Settings"})})]})}var ep=a(12081),ey=a(73301),eb=a(59544),ej=a(43450);function ef(e){let{projectId:t}=e,{useApiQuery:a}=Q(),[l,n]=(0,r.useState)(""),{data:i,isLoading:d,refetch:o,error:c}=a(t,"v1/projects/".concat(t,"/auth/users"),{queryKey:["v1/projects/".concat(t,"/auth/users")],limit:50,offset:0}),x=(null==i?void 0:i.users)||[];c&&console.error("Users API error:",c),i&&console.log("Users data received:",i);let m=x.filter(e=>e.email.toLowerCase().includes(l.toLowerCase())||e.full_name&&e.full_name.toLowerCase().includes(l.toLowerCase())),u=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never";return(0,s.jsxs)("div",{className:"space-y-6","data-sentry-component":"UsersTab","data-sentry-source-file":"users.tsx",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-2 text-gray-900 dark:text-white",children:"Users"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage your application users. View when they signed up, last signed in, and their verification status."})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"All Users"}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("input",{type:"text",value:l,onChange:e=>n(e.target.value),placeholder:"Search users...",className:"px-3 py-2 border dark:border-gray-700 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"}),(0,s.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[m.length," ",1===m.length?"user":"users"]}),(0,s.jsx)("button",{onClick:()=>o(),className:"px-3 py-1 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300",children:"Refresh"})]})]})}),(0,s.jsx)("div",{className:"overflow-x-auto",children:d?(0,s.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"Loading users..."}):c?(0,s.jsxs)("div",{className:"text-center py-8 text-red-500 dark:text-red-400",children:[(0,s.jsxs)("p",{children:["Error loading users: ",c.message||"Unknown error"]}),(0,s.jsx)("button",{onClick:()=>o(),className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})]}):0===m.length?(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,s.jsx)(ep.A,{size:48,className:"mx-auto mb-2 text-gray-300 dark:text-gray-600"}),(0,s.jsx)("p",{children:"No users found"}),l&&(0,s.jsx)("p",{className:"text-sm mt-1",children:"Try adjusting your search"})]}):(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,s.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"User"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Created"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Last Sign In"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:m.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-shrink-0 h-10 w-10 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center",children:(0,s.jsx)(ep.A,{size:20,className:"text-gray-500 dark:text-gray-400"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:e.email}),e.full_name&&(0,s.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.full_name})]})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("div",{className:"flex items-center gap-2",children:e.email_confirmed_at?(0,s.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400",children:[(0,s.jsx)(ey.A,{size:12,className:"mr-1"}),"Verified"]}):(0,s.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-400",children:[(0,s.jsx)(ey.A,{size:12,className:"mr-1"}),"Unverified"]})})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(eb.A,{size:14}),u(e.created_at)]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(ej.A,{size:14}),u(e.last_sign_in_at)]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,s.jsx)("button",{className:"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300",children:"View"})})]},e.id))})]})})]})]})}var ev=a(58633);function ek(e){let{projectId:t}=e,{useApiQuery:a,useApiMutation:l}=Q(),[n,i]=(0,r.useState)({}),[d,o]=(0,r.useState)(!1),[c,x]=(0,r.useState)(""),[m,u]=(0,r.useState)(""),[h,p]=(0,r.useState)(null),[y,b]=(0,r.useState)(!1),[j,f]=(0,r.useState)(null),{data:v,isLoading:k,refetch:N}=a(t,"secrets",{queryKey:["v1","projects",t,"secrets"],queryFn:async()=>{let e=await fetch("/api/databasepad/proxy?projectId=".concat(t,"&endpoint=v1/projects/").concat(t,"/secrets"),{headers:{"Content-Type":"application/json"}});if(!e.ok){if(404===e.status)return[];throw Error("Failed to fetch secrets")}let a=await e.json();return Array.isArray(a),a}}),w=l(t,"v1/projects/"+t+"/secrets","POST");(0,r.useEffect)(()=>{v&&i(e=>{let t={};return(Array.isArray(v)?v:v.keys||[]).forEach(a=>{t[a]=e[a]||"••••••••"}),t})},[v]);let C=async()=>{if(c.trim()&&m.trim())try{await w.mutateAsync({key:c,value:m}),x(""),u(""),o(!1),N(),g.Ay.success('Secret "'.concat(c,'" added successfully'))}catch(a){var e,t;g.Ay.error((null===(t=a.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"Failed to add secret")}},S=e=>{f(e),b(!0)},A=async()=>{if(j){p(j);try{let e=await fetch("/api/databasepad/proxy?projectId=".concat(t,"&endpoint=v1/projects/").concat(t,"/secrets&name=").concat(encodeURIComponent(j)),{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to delete secret")}N(),g.Ay.success('Secret "'.concat(j,'" deleted successfully')),b(!1),f(null)}catch(e){g.Ay.error(e.message||"Failed to delete secret")}finally{p(null)}}},T=Array.isArray(v)?v:(null==v?void 0:v.keys)||[];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(er,{isOpen:y,onClose:()=>{b(!1),f(null)},onConfirm:A,title:"Delete Secret?",message:'Are you sure you want to delete the secret "'.concat(j,'"? This action cannot be undone.'),confirmText:"Delete",cancelText:"Cancel",isProcessing:null!==h,"data-sentry-element":"ConfirmationDialog","data-sentry-source-file":"secrets.tsx"}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-2 text-gray-900 dark:text-white",children:"Secrets"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage environment variables for your edge functions. These are securely stored and injected at runtime."})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Environment Variables"}),(0,s.jsxs)("button",{onClick:()=>o(!d),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,s.jsx)(X.A,{size:16,"data-sentry-element":"Plus","data-sentry-source-file":"secrets.tsx"}),"Add Secret"]})]}),d&&(0,s.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Key"}),(0,s.jsx)("input",{type:"text",value:c,onChange:e=>x(e.target.value.toUpperCase().replace(/[^A-Z0-9_]/g,"_")),placeholder:"SECRET_KEY",className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Value"}),(0,s.jsx)("input",{type:"password",value:m,onChange:e=>u(e.target.value),placeholder:"Secret value",className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:C,disabled:!c.trim()||!m.trim()||w.isPending,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:w.isPending?"Adding...":"Add Secret"}),(0,s.jsx)("button",{onClick:()=>{o(!1),x(""),u("")},className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:"Cancel"})]})]})}),(0,s.jsx)("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:k?(0,s.jsx)("div",{className:"px-6 py-8 text-center text-gray-500 dark:text-gray-400",children:"Loading secrets..."}):0===T.length?(0,s.jsxs)("div",{className:"px-6 py-8 text-center text-gray-500 dark:text-gray-400",children:[(0,s.jsx)(B.A,{size:48,className:"mx-auto mb-2 text-gray-300 dark:text-gray-600"}),(0,s.jsx)("p",{children:"No secrets yet"}),(0,s.jsx)("p",{className:"text-sm mt-1",children:"Add environment variables for your edge functions"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"px-6 py-3 bg-blue-50 dark:bg-blue-900/20 border-b dark:border-gray-700",children:(0,s.jsxs)("div",{className:"flex items-start gap-2 text-sm text-blue-800 dark:text-blue-300",children:[(0,s.jsx)(ev.A,{size:16,className:"mt-0.5 flex-shrink-0"}),(0,s.jsx)("p",{children:"Secret values cannot be viewed in the UI for security reasons, but they are available to your edge functions at runtime. You can overwrite or delete them as needed."})]})}),T.map(e=>(0,s.jsxs)("div",{className:"px-6 py-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-mono text-sm font-medium text-gray-900 dark:text-gray-100",children:e}),(0,s.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"••••••••••••"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("button",{disabled:!0,className:"p-2 text-gray-300 dark:text-gray-700 cursor-not-allowed relative group",title:"Secret values cannot be viewed in the UI for security",children:[(0,s.jsx)(eo.A,{size:16}),(0,s.jsxs)("div",{className:"absolute bottom-full right-0 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-10",children:["Secret values cannot be viewed in the UI for security",(0,s.jsx)("div",{className:"absolute top-full right-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]}),(0,s.jsx)("button",{onClick:()=>S(e),disabled:h===e,className:"p-2 text-red-400 hover:text-red-600 dark:hover:text-red-300 disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete secret",children:h===e?(0,s.jsx)("div",{className:"animate-spin",children:(0,s.jsx)(es.A,{size:16})}):(0,s.jsx)(es.A,{size:16})})]})]},e))]})})]})]})]})}var eN=a(73715);function ew(e){var t,a,l,n;let{projectId:i}=e,{useApiQuery:d,useApiMutation:o}=Q(),[c,x]=(0,r.useState)(null),[m,u]=(0,r.useState)(""),[h,p]=(0,r.useState)(""),[y,b]=(0,r.useState)(!1),[j,f]=(0,r.useState)(""),[v,k]=(0,r.useState)(!1),[N,w]=(0,r.useState)(!1),[C,S]=(0,r.useState)(null),[A,T]=(0,r.useState)(!1),[L,E]=(0,r.useState)(!1),[D,P]=(0,r.useState)('{\n  "name": "World"\n}'),[F,I]=(0,r.useState)(""),[M,z]=(0,r.useState)(!1),{data:U,isLoading:R,refetch:_}=d(i,"functions",{queryKey:["databasepad/".concat(i,"/functions")]}),O=Array.isArray(U)?U:[],[B,V]=(0,r.useState)(!1);(0,r.useEffect)(()=>{v&&c&&q(c)},[v,c]);let q=async e=>{try{var t;let a=await fetch("/api/databasepad/functions?projectId=".concat(i,"&action=get-code&slug=").concat(e));if(!a.ok)throw Error("Failed to fetch function code: ".concat(a.status));let s=(await a.json()).code||H(),r=O.find(t=>t.slug===e),l=(null==r?void 0:null===(t=r.metadata)||void 0===t?void 0:t.deployed)!==!1;u(s),p(l?s:"")}catch(e){console.error("Failed to fetch function code:",e),u(H()),p("")}},H=()=>"// Deno Edge Function\nDeno.serve(async (req) => {\n  // Handle CORS preflight requests\n  if (req.method === 'OPTIONS') {\n    return new Response('ok', {\n      headers: {\n        'Access-Control-Allow-Origin': '*',\n        'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type',\n      },\n    });\n  }\n\n  try {\n    // Parse request body\n    const { name } = await req.json();\n    \n    // Access environment variables\n    const greetingPrefix = Deno.env.get('GREETING_PREFIX') || 'Hello';\n    \n    const data = {\n      message: `${greetingPrefix} ${name}!`,\n      timestamp: new Date().toISOString(),\n    };\n\n    return new Response(\n      JSON.stringify(data),\n      {\n        headers: {\n          'Content-Type': 'application/json',\n          'Access-Control-Allow-Origin': '*',\n        },\n      },\n    );\n  } catch (error) {\n    return new Response(\n      JSON.stringify({ error: error.message }),\n      {\n        status: 400,\n        headers: {\n          'Content-Type': 'application/json',\n          'Access-Control-Allow-Origin': '*',\n        },\n      },\n    );\n  }\n});",J=async()=>{if(c){V(!0);try{await Y(c,m),p(m),_(),g.Ay.success('Function "'.concat(c,'" deployed successfully!'))}catch(a){var e,t;g.Ay.error((null===(t=a.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||a.message||"Failed to deploy function")}finally{V(!1)}}},Y=async(e,t)=>{let a=new FormData,s=new Blob([t],{type:"text/plain"});a.append("file",s,"index.ts");let r=await fetch("/api/databasepad/functions?projectId=".concat(i,"&action=deploy&slug=").concat(e),{method:"POST",body:a});if(!r.ok)throw Error((await r.json()).error||"Failed to deploy function");return await r.json()},G=async()=>{if(!j.trim())return;let e=j.toLowerCase().replace(/[^a-z0-9-]/g,"-");V(!0);try{let t=await fetch("/api/databasepad/functions?projectId=".concat(i,"&action=create&slug=").concat(e),{method:"POST",headers:{"Content-Type":"application/json"}});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to create function")}f(""),b(!1),await _(),g.Ay.success('Function "'.concat(e,'" created! Edit and deploy the code.')),x(e),k(!0)}catch(e){var t,a;g.Ay.error((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.error)||e.message||"Failed to create function")}finally{V(!1)}},K=e=>{S(e),w(!0)},Z=async()=>{if(C){T(!0);try{let e=await fetch("/api/databasepad/functions?projectId=".concat(i,"&action=delete&slug=").concat(C),{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to delete function")}_(),g.Ay.success('Function "'.concat(C,'" deleted successfully')),w(!1),S(null),c===C&&ea()}catch(e){g.Ay.error(e.message||"Failed to delete function")}finally{T(!1)}}},et=m!==h,ea=()=>{k(!1),x(null),u(""),p("")},el=()=>{E(!0),I("")},en=async()=>{if(c){z(!0),I("");try{let e;try{e=JSON.parse(D)}catch(e){throw Error("Invalid JSON input")}let t=await fetch("/api/databasepad/invoke?projectId=".concat(i,"&functionName=").concat(c),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await t.json(),s={status:t.status,statusText:t.ok?"OK":"Error",data:a};I(JSON.stringify(s,null,2)),t.ok?g.Ay.success("Function executed successfully!"):g.Ay.error("Function returned an error")}catch(e){I(JSON.stringify({error:e.message||"Failed to invoke function"},null,2)),g.Ay.error(e.message||"Failed to invoke function")}finally{z(!1)}}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(er,{isOpen:N,onClose:()=>{w(!1),S(null)},onConfirm:Z,title:"Delete Function?",message:'Are you sure you want to delete the function "'.concat(C,'"? This action cannot be undone.'),confirmText:"Delete",cancelText:"Cancel",isProcessing:A,"data-sentry-element":"ConfirmationDialog","data-sentry-source-file":"functions.tsx"}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-2 text-gray-900 dark:text-white",children:"Edge Functions"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Deploy serverless functions that run on AWS Lambda. Functions are written in JavaScript/TypeScript and executed on-demand."})]}),(0,s.jsxs)("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex-shrink-0 mt-1",children:[(0,s.jsx)(X.A,{size:16,"data-sentry-element":"Plus","data-sentry-source-file":"functions.tsx"}),"New Function"]})]}),y&&(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-6 mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"Create New Function"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("input",{type:"text",value:j,onChange:e=>f(e.target.value),placeholder:"function-name",className:"w-full px-3 py-2 border dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:G,disabled:!j.trim()||B,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:B?"Creating...":"Create Function"}),(0,s.jsx)("button",{onClick:()=>{b(!1),f("")},className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:"Cancel"})]})]})]}),R?(0,s.jsx)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"Loading functions..."}):O&&0!==O.length?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:O.map(e=>{var t,a,r;return(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow hover:shadow-lg transition-shadow",children:[(0,s.jsxs)("div",{onClick:()=>{x(e.slug),k(!0)},className:"p-6 cursor-pointer",children:[(0,s.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(W.A,{className:"text-blue-600 dark:text-blue-400",size:24}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:e.slug}),(null===(t=e.metadata)||void 0===t?void 0:t.deployed)===!1&&(0,s.jsx)("span",{className:"inline-block mt-1 px-2 py-0.5 text-xs font-medium text-orange-600 dark:text-orange-400 bg-orange-50 dark:bg-orange-900/20 rounded",children:"Not deployed"})]})]})}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Click to view and edit function code"}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:(0,s.jsxs)("code",{className:"bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:["/functions/v1/",e.slug]})})]}),(0,s.jsxs)("div",{className:"px-6 pb-4 flex justify-between border-t dark:border-gray-700 pt-3",children:[(0,s.jsxs)("button",{onClick:t=>{t.stopPropagation(),x(e.slug),el()},disabled:(null===(a=e.metadata)||void 0===a?void 0:a.deployed)===!1,className:"flex items-center gap-2 px-3 py-1.5 text-sm text-green-600 hover:text-green-700 dark:text-green-400 dark:hover:text-green-300 hover:bg-green-50 dark:hover:bg-green-900/20 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent",title:(null===(r=e.metadata)||void 0===r?void 0:r.deployed)===!1?"Deploy function first":"Test function",children:[(0,s.jsx)($.A,{size:14}),"Test"]}),(0,s.jsxs)("button",{onClick:t=>{t.stopPropagation(),K(e.slug)},className:"flex items-center gap-2 px-3 py-1.5 text-sm text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:"Delete function",children:[(0,s.jsx)(es.A,{size:14}),"Delete"]})]})]},e.slug)})}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(W.A,{size:48,className:"mx-auto mb-4 text-gray-300 dark:text-gray-600"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No functions yet"}),(0,s.jsx)("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create your first function to get started"})]})]}),L&&c&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex justify-between items-center",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Test Function: ",c]}),(0,s.jsx)("button",{onClick:()=>E(!1),className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,s.jsx)(ee.A,{size:20})})]}),(0,s.jsx)("div",{className:"p-6 flex-1 overflow-auto",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",style:{minHeight:"400px"},children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Request Body (JSON)"}),(0,s.jsx)("textarea",{value:D,onChange:e=>P(e.target.value),className:"flex-1 font-mono text-sm p-4 border dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800 focus:ring-2 focus:ring-blue-500 focus:bg-white dark:focus:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-[350px]",placeholder:'{\\n  "name": "World"\\n}',spellCheck:!1})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Response"}),(0,s.jsx)("div",{className:"flex-1 font-mono text-sm p-4 border dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-gray-100 overflow-auto min-h-[350px]",children:F?(0,s.jsx)("pre",{className:"whitespace-pre-wrap",children:F}):(0,s.jsx)("div",{className:"text-gray-400 dark:text-gray-500",children:'Click "Invoke" to test the function'})})]})]})}),(0,s.jsxs)("div",{className:"px-6 py-4 border-t dark:border-gray-700 flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Endpoint: ",(0,s.jsxs)("code",{className:"bg-gray-100 dark:bg-gray-800 px-2 py-0.5 rounded",children:["https://",i,".","databasepad.com","/functions/v1/",c]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>E(!1),className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:"Close"}),(0,s.jsxs)("button",{onClick:en,disabled:M,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:[(0,s.jsx)($.A,{size:16}),M?"Invoking...":"Invoke"]})]})]})]})}),v&&c&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b dark:border-gray-700 flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:c}),et&&(0,s.jsx)("span",{className:"text-sm text-orange-600 dark:text-orange-400",children:"• Unsaved changes"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("button",{onClick:()=>{c&&K(c)},className:"flex items-center gap-2 px-3 py-1.5 text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:"Delete function",children:[(0,s.jsx)(es.A,{size:16}),"Delete"]}),(0,s.jsx)("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600"}),(0,s.jsxs)("button",{onClick:el,disabled:(null===(a=O.find(e=>e.slug===c))||void 0===a?void 0:null===(t=a.metadata)||void 0===t?void 0:t.deployed)===!1,className:"flex items-center gap-2 px-3 py-1.5 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",title:(null===(n=O.find(e=>e.slug===c))||void 0===n?void 0:null===(l=n.metadata)||void 0===l?void 0:l.deployed)===!1?"Deploy function first":"Test function",children:[(0,s.jsx)($.A,{size:16}),"Test"]}),(0,s.jsxs)("button",{onClick:J,disabled:!et||B,className:"flex items-center gap-2 px-4 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:[(0,s.jsx)(eN.A,{size:16}),B?"Deploying...":"Deploy"]}),(0,s.jsx)("button",{onClick:ea,className:"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,s.jsx)(ee.A,{size:20})})]})]}),(0,s.jsxs)("div",{className:"p-6 flex-1 overflow-auto",children:[(0,s.jsxs)("div",{className:"mb-4 text-sm text-gray-600 dark:text-gray-400",children:["Function URL:"," ",(0,s.jsxs)("code",{className:"bg-gray-100 dark:bg-gray-800 px-2 py-0.5 rounded",children:["https://",i,".","databasepad.com","/functions/v1/",c]})]}),(0,s.jsx)("textarea",{value:m,onChange:e=>u(e.target.value),className:"w-full h-[500px] font-mono text-sm p-4 border dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800 focus:ring-2 focus:ring-blue-500 focus:bg-white dark:focus:bg-gray-900 text-gray-900 dark:text-gray-100",spellCheck:!1})]})]})})]})}var eC=a(45604),eS=a(14186),eA=a(64308),eT=a(804);function eL(e){let{projectId:t}=e,{useApiQuery:a}=Q(),[l,n]=(0,r.useState)([]),[i,d]=(0,r.useState)(!1),[o,c]=(0,r.useState)(new Set),[x,m]=(0,r.useState)(""),[u,g]=(0,r.useState)(null),{data:h,isLoading:p}=a(t,"functions",{queryKey:["databasepad/".concat(t,"/functions")]}),y=Array.isArray(h)?h:[];(0,r.useEffect)(()=>{y.length>0&&!x&&m(y[0].slug)},[y,x]),(0,r.useEffect)(()=>{x?b(x):n([])},[x,t]);let b=async e=>{if(e){d(!0),g(null);try{console.log("[Logs] Fetching logs for function: ".concat(e));let a=await fetch("/api/databasepad/proxy?projectId=".concat(t,"&endpoint=functions/").concat(e,"/logs"));if(!a.ok){if(404===a.status)throw Error('Function "'.concat(e,'" not found or has no logs yet'));throw Error("Failed to fetch logs: ".concat(a.status," ").concat(a.statusText))}let s=(await a.json()).logs||[];console.log("[Logs] Fetched ".concat(s.length," logs for ").concat(e));let r=s.map(t=>({...t,functionSlug:t.functionSlug||e})).sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime());n(r)}catch(e){console.error("[Logs] Failed to fetch logs:",e),n([]),g(e instanceof Error?e.message:"Failed to fetch logs")}finally{d(!1)}}},j=e=>{c(t=>{let a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})},f=e=>new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),v=e=>"success"===e.status||"info"===e.level?(0,s.jsx)(eC.A,{size:16,className:"text-green-500 dark:text-green-400"}):"error"===e.level?(0,s.jsx)(ev.A,{size:16,className:"text-red-500 dark:text-red-400"}):"warn"===e.level?(0,s.jsx)(ev.A,{size:16,className:"text-yellow-500 dark:text-yellow-400"}):(0,s.jsx)(P.A,{size:16,className:"text-blue-500 dark:text-blue-400"}),k=e=>"success"===e.status||"info"===e.level?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400":"error"===e.level?"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-400":"warn"===e.level?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-400":"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400";return(0,s.jsxs)("div",{className:"space-y-6","data-sentry-component":"LogsTab","data-sentry-source-file":"logs.tsx",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-2 text-gray-900 dark:text-white",children:"Function Logs"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"View invocation logs for your edge functions. Select a function to see its execution history, request details, and console output."})]}),u&&(0,s.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(ev.A,{className:"text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5",size:20}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-red-800 dark:text-red-400",children:"Error loading logs"}),(0,s.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:u})]})]})}),!p&&0===y.length&&(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-8 text-center",children:[(0,s.jsx)(P.A,{size:48,className:"mx-auto mb-4 text-gray-300 dark:text-gray-600"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:"No edge functions found"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-2",children:"Create and deploy an edge function to see its invocation logs here."})]}),y.length>0&&(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b dark:border-gray-700",children:(0,s.jsxs)("div",{className:"flex justify-between items-center flex-wrap gap-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Invocation Logs"}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("select",{value:x,onChange:e=>m(e.target.value),className:"px-3 py-2 border dark:border-gray-700 rounded-lg text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 disabled:opacity-50",disabled:p||i,children:y.map(e=>(0,s.jsxs)("option",{value:e.slug,children:[e.slug," (",l.length>0&&x===e.slug?l.length:"...",")"]},e.slug))}),(0,s.jsxs)("button",{onClick:()=>{x&&b(x)},disabled:i||!x,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(0,s.jsx)(eS.A,{size:16,className:i?"animate-spin":""}),i?"Refreshing...":"Refresh"]})]})]})}),(0,s.jsx)("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:i?(0,s.jsxs)("div",{className:"px-6 py-8 text-center text-gray-500 dark:text-gray-400",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsxs)("p",{children:["Loading logs for ",x,"..."]})]}):0===l.length?(0,s.jsxs)("div",{className:"px-6 py-8 text-center text-gray-500 dark:text-gray-400",children:[(0,s.jsx)(P.A,{size:48,className:"mx-auto mb-2 text-gray-300 dark:text-gray-600"}),(0,s.jsx)("p",{className:"font-medium",children:"No logs found"}),(0,s.jsx)("p",{className:"text-sm mt-1",children:x?'No invocation logs for "'.concat(x,'" yet. Invoke the function to see logs here.'):"Select a function to view logs"})]}):l.map(e=>{let t=e.id||"".concat(e.timestamp,"-").concat(e.requestId),a=o.has(t);return(0,s.jsxs)("div",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,s.jsx)("div",{className:"px-6 py-4 cursor-pointer",onClick:()=>j(t),children:(0,s.jsx)("div",{className:"flex items-start justify-between",children:(0,s.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,s.jsx)("button",{className:"mt-0.5",children:a?(0,s.jsx)(eA.A,{size:16}):(0,s.jsx)(eT.A,{size:16})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[v(e),(0,s.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium uppercase ".concat(k(e)),children:e.level}),e.method&&(0,s.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300",children:e.method}),e.duration&&(0,s.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.duration,"ms"]})]}),(0,s.jsx)("div",{className:"mt-1 text-sm text-gray-900 dark:text-gray-100 break-words",children:e.message}),(0,s.jsxs)("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-500 dark:text-gray-400",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(ej.A,{size:14}),f(e.timestamp)]}),(0,s.jsxs)("span",{className:"font-mono text-xs truncate",children:["ID: ",e.requestId]})]})]})]})})}),a&&(0,s.jsx)("div",{className:"px-6 pb-4 pl-16",children:(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500 dark:text-gray-400 mb-3 flex-wrap",children:[(0,s.jsxs)("span",{className:"font-mono",children:["ID: ",e.id]}),(0,s.jsxs)("span",{className:"font-mono",children:["Request: ",e.requestId]}),(0,s.jsx)("span",{className:"font-mono",children:e.timestamp}),e.duration&&(0,s.jsxs)("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:[e.duration,"ms"]}),e.status&&(0,s.jsx)("span",{className:"font-semibold",children:e.status}),e.method&&(0,s.jsx)("span",{className:"font-semibold",children:e.method})]}),(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)("span",{className:"inline-block px-2 py-0.5 rounded text-xs font-medium uppercase ".concat(k(e)),children:e.level}),(0,s.jsx)("span",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"Message:"})]}),(0,s.jsx)("div",{className:"p-4 bg-white dark:bg-gray-900 rounded border border-gray-200 dark:border-gray-700 text-sm text-gray-900 dark:text-gray-100 break-words",children:e.message})]}),e.request&&(0,s.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,s.jsx)("span",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Request Details:"}),(0,s.jsx)("pre",{className:"p-3 bg-white dark:bg-gray-900 rounded text-xs overflow-x-auto text-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700",children:JSON.stringify(e.request,null,2)})]}),e.response&&(0,s.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,s.jsx)("span",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2 block",children:"Response Details:"}),(0,s.jsx)("pre",{className:"p-3 bg-white dark:bg-gray-900 rounded text-xs overflow-x-auto text-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700",children:JSON.stringify(e.response,null,2)})]})]})})]},t)})})]})]})}var eE=a(33013);function eD(e){let{projectId:t,projectUrl:a,projectApiKey:l}=e,[n,i]=(0,r.useState)("database"),{data:d}=(0,eE.useSession)();(0,r.useEffect)(()=>{let e=window.location.hash.replace("#",""),t=["database","storage","authentication","users","secrets","functions","logs"];if(e.startsWith("database-")){let a=e.replace("database-","");t.includes(a)&&i(a)}else t.includes(e)&&i(e)},[]);let o=[{id:"database",label:"Database",icon:U.A},{id:"storage",label:"File Buckets",icon:R.A},{id:"authentication",label:"Authentication",icon:_.A},{id:"users",label:"Users",icon:O.A},{id:"secrets",label:"Secrets",icon:B.A},{id:"functions",label:"Edge Functions",icon:W.A},{id:"logs",label:"Logs",icon:P.A}],c=e=>{i(e),window.history.pushState(null,"","#database-".concat(e))};return(0,s.jsxs)("div",{className:"flex min-h-[600px] overflow-hidden","data-sentry-component":"Dashboard","data-sentry-source-file":"dashboard.tsx",children:[(0,s.jsxs)("div",{className:"w-64 text-gray-900 dark:text-white flex flex-col  bg-gray-700 rounded-lg",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("nav",{className:"space-y-1 px-4 pt-4",children:o.filter(e=>{var t;return!("authentication"===e.id&&!(null==d?void 0:null===(t=d.user)||void 0===t?void 0:t.isAdmin))}).map(e=>{let t=e.icon;return(0,s.jsxs)("button",{onClick:()=>c(e.id),className:"w-full flex items-center gap-3 px-4 py-2 rounded-lg transition-colors ".concat(n===e.id?"bg-blue-600 text-white":"hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"),children:[(0,s.jsx)(t,{size:20}),(0,s.jsx)("span",{children:e.label})]},e.id)})})}),(0,s.jsx)("div",{className:"p-4",children:(0,s.jsxs)("div",{className:"border border-gray-300 dark:border-gray-600 px-3 py-3 rounded-2xl text-center backdrop-blur-sm",children:[(0,s.jsx)("div",{className:"text-xs opacity-60 font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Database ID:"}),(0,s.jsx)("div",{className:"font-mono text-xs font-medium text-gray-700 dark:text-gray-300 select-text break-all leading-tight",onClick:e=>{let t=window.getSelection(),a=document.createRange();a.selectNodeContents(e.currentTarget),null==t||t.removeAllRanges(),null==t||t.addRange(a)},children:t})]})})]}),(0,s.jsx)("div",{className:"flex-1 overflow-auto bg-white dark:bg-gray-800",children:(0,s.jsxs)("div",{className:"p-6",children:["database"===n&&(0,s.jsx)(en,{projectId:t}),"storage"===n&&(0,s.jsx)(eg,{projectId:t,projectUrl:a}),"authentication"===n&&(0,s.jsx)(eh,{projectId:t}),"users"===n&&(0,s.jsx)(ef,{projectId:t}),"secrets"===n&&(0,s.jsx)(ek,{projectId:t}),"functions"===n&&(0,s.jsx)(ew,{projectId:t}),"logs"===n&&(0,s.jsx)(eL,{projectId:t})]})})]})}function eP(e){let{projectData:t,subscriptionData:a,onProjectUpdate:r}=e;return t?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsx)("div",{className:"",children:(0,s.jsx)(eD,{projectId:t.supabaseProjectId,projectUrl:t.supabaseProjectUrl,"data-sentry-element":"DatabasePadDashboard","data-sentry-source-file":"DatabaseTab.tsx"})})})}):null}function eF(){let e=(0,l.useRouter)(),{id:t}=e.query,{user:a,isAuthenticated:n,isLoading:d}=(0,c.A)(),[x,m]=(0,r.useState)(!0),[u,g]=(0,r.useState)(null),[p,y]=(0,r.useState)(null),[b,j]=(0,r.useState)("general"),[f,v]=(0,r.useState)(null),[,k]=(0,r.useState)(!1),[N,w]=(0,r.useState)(!1),{isWhitelabel:A,whitelabelConfig:T}=(0,h.p)(),L=(0,r.useCallback)(async()=>{try{let e=await fetch("/api/projects/".concat(t,"?files=no"));if(!e.ok)throw Error("Failed to fetch project data");let a=await e.json();g(a.project),"mobile"===a.project.platform&&j("general"),m(!1)}catch(e){console.error("Error fetching project:",e),y("Could not load project details"),m(!1)}},[t]),E=(0,r.useCallback)(async()=>{try{k(!0);let e=await fetch("/api/subscription");if(e.ok){let t=await e.json();t.subscription&&v(t.subscription)}else console.error("Failed to fetch subscription data")}catch(e){console.error("Error fetching subscription data:",e)}finally{k(!1)}},[]);(0,r.useEffect)(()=>{if(!d&&!n){let t=window.location.pathname+window.location.hash;e.push("/login?redirect=".concat(encodeURIComponent(t)));return}!d&&n&&t&&(L(),E())},[d,n,e,t,L,E]),(0,r.useEffect)(()=>{if(!e.isReady)return;let t=window.location.hash.replace("#","");"general"===t||"analytics"===t||"payments"===t||"database"===t?j(t):t.startsWith("payments-")?j("payments"):t.startsWith("database-")?j("database"):["storage","authentication","users","secrets","functions","logs"].includes(t)?j("database"):j("general")},[e.isReady]);let D=e=>{if(j(e),"payments"===e){let e=window.location.hash.replace("#","");e.startsWith("payments-")?window.history.pushState(null,"","#".concat(e)):window.history.pushState(null,"","#payments")}else if("database"===e){let e=window.location.hash.replace("#","");e.startsWith("database-")?window.history.pushState(null,"","#".concat(e)):window.history.pushState(null,"","#database")}else window.history.pushState(null,"","#".concat(e))};return((0,r.useEffect)(()=>{let e=()=>{w(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),d||x)?(0,s.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("svg",{className:"animate-spin h-10 w-10 text-blue-500 mx-auto mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("p",{className:"text-gray-300",children:"Loading project settings..."})]})}):p?(0,s.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-red-500 mb-4",children:(0,s.jsx)("svg",{className:"h-12 w-12 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,s.jsx)("p",{className:"text-gray-300 text-xl font-medium mb-4",children:p}),(0,s.jsx)("button",{onClick:()=>e.push("/"),className:"bg-blue-600 text-white px-4 py-2 rounded-md",children:"Go Home"})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900","data-sentry-component":"ProjectSettings","data-sentry-source-file":"settings.tsx",children:[(0,s.jsxs)(i(),{"data-sentry-element":"Head","data-sentry-source-file":"settings.tsx",children:[(0,s.jsxs)("title",{children:["Project Settings - ",(null==u?void 0:u.slug)||t]}),(0,s.jsx)("meta",{name:"description",content:"Manage your project settings","data-sentry-element":"meta","data-sentry-source-file":"settings.tsx"})]}),N?(0,s.jsx)("header",{className:"bg-gray-900 py-4",children:(0,s.jsxs)("div",{className:"px-4",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-3",children:A?(0,s.jsxs)(o(),{href:(null==T?void 0:T.homepageEnabled)===!0?"/":"/dashboard",className:"flex items-center",children:[(null==T?void 0:T.wordmark)&&(0,s.jsx)("img",{className:"wl-hook-homepage-site-logo-image",src:T.wordmark,alt:(null==T?void 0:T.siteName)||"Platform",width:120}),!(null==T?void 0:T.wordmark)&&(null==T?void 0:T.logo)&&(0,s.jsx)("img",{className:"wl-hook-homepage-site-logo-image",src:T.logo,alt:(null==T?void 0:T.siteName)||"Platform",width:25}),!(null==T?void 0:T.wordmark)&&!(null==T?void 0:T.logo)&&(null==T?void 0:T.siteName)&&(0,s.jsx)("div",{className:"wl-hook-sitename-text text-white text-2xl font-bold",children:T.siteName})]}):(0,s.jsx)(o(),{href:"/",className:"flex items-center",children:(0,s.jsx)("img",{src:"/famous_tp_black.png",alt:"Famous.ai",width:120,className:"brightness-0 invert"})})}),(0,s.jsxs)("div",{className:"flex flex-col space-y-2 mt-4",children:[(0,s.jsxs)(o(),{href:"/project/".concat(t),className:"w-full px-3 py-2 text-sm bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors flex items-center justify-center",children:[(0,s.jsx)("span",{className:"mr-1",children:"←"})," Back to Project"]}),(0,s.jsx)(o(),{href:"/dashboard",className:"w-full px-3 py-2 text-sm bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors text-center",children:"Dashboard"})]})]})}):(0,s.jsx)("header",{className:"bg-gray-900 pt-4 pb-1",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[A?(0,s.jsx)(o(),{href:(null==T?void 0:T.homepageEnabled)===!0?"/":"/dashboard",className:"flex items-center",children:(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(null==T?void 0:T.wordmark)&&(0,s.jsx)("img",{className:"wl-hook-homepage-site-logo-image",src:T.wordmark,alt:(null==T?void 0:T.siteName)||"Platform",width:140}),!(null==T?void 0:T.wordmark)&&(null==T?void 0:T.logo)&&(0,s.jsx)("img",{className:"wl-hook-homepage-site-logo-image",src:T.logo,alt:(null==T?void 0:T.siteName)||"Platform",width:30}),!(null==T?void 0:T.wordmark)&&!(null==T?void 0:T.logo)&&(null==T?void 0:T.siteName)&&(0,s.jsx)("div",{className:"wl-hook-sitename-text text-white text-2xl font-bold",children:T.siteName})]})}):(0,s.jsx)(o(),{href:"/",className:"flex items-center",children:(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)("img",{src:"/famous_tp_black.png",alt:"Famous.ai",width:140,className:"brightness-0 invert"})})}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)(o(),{href:"/project/".concat(t),className:"px-3 py-1.5 text-sm bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors flex items-center",children:[(0,s.jsx)("span",{className:"mr-1",children:"←"})," Back to Project"]}),(0,s.jsx)(o(),{href:"/dashboard",className:"px-3 py-1.5 text-sm bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors",children:"Dashboard"})]})]})})}),(0,s.jsx)("main",{className:"md:py-10",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Project Settings"}),("mobile"!==u.platform||!0===u.isInternalDatabase&&u.supabaseProjectId||u.stripeAccountId)&&(0,s.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:(0,s.jsxs)("nav",{className:"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto no-scrollbar sm:overflow-x-visible pr-4 sm:pr-0",children:[(0,s.jsx)("button",{onClick:()=>D("general"),className:"py-4 px-1 border-b-2 font-medium text-sm flex-shrink-0 whitespace-nowrap ".concat("general"===b?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"),children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"General"]})}),(0,s.jsx)("button",{onClick:()=>D("analytics"),className:"py-4 px-1 border-b-2 font-medium text-sm flex-shrink-0 whitespace-nowrap ".concat("analytics"===b?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"),children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Analytics"]})}),u.stripeAccountId&&(0,s.jsx)("button",{onClick:()=>D("payments"),className:"py-4 px-1 border-b-2 font-medium text-sm flex-shrink-0 whitespace-nowrap ".concat("payments"===b?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"),children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),"Payments"]})}),u.supabaseProjectId&&(!0===u.isInternalSupabase||!0===u.isInternalDatabase)&&(0,s.jsx)("button",{onClick:()=>D("database"),className:"py-4 px-1 border-b-2 font-medium text-sm flex-shrink-0 whitespace-nowrap ".concat("database"===b?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"),children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",children:[(0,s.jsx)("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}),(0,s.jsx)("path",{d:"M3 5V19A9 3 0 0 0 21 19V5"}),(0,s.jsx)("path",{d:"M3 12A9 3 0 0 0 21 12"})]}),"Database"]})})]})}),"general"===b&&(0,s.jsx)(C,{projectData:u,subscriptionData:f,onProjectUpdate:L,onTabChange:e=>D(e)}),"analytics"===b&&(0,s.jsx)(S,{projectData:u,onProjectUpdate:L}),"payments"===b&&(0,s.jsx)(z,{projectData:u,subscriptionData:f,onProjectUpdate:L}),"database"===b&&(0,s.jsx)(eP,{projectData:u,subscriptionData:f,onProjectUpdate:L})]})})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[1106,2146,8807,2048,3872,9345,802,1459,636,6593,8792],()=>t(49e3)),_N_E=e.O()}]);