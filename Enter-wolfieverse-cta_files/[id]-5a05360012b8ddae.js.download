try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="3120fcb7-1613-4c67-ae09-2e8dbd5963e3",e._sentryDebugIdIdentifier="sentry-dbid-3120fcb7-1613-4c67-ae09-2e8dbd5963e3")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4263],{60373:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[id]",function(){return s(52250)}])},42515:(e,t,s)=>{"use strict";s.d(t,{applyUnifiedChanges:()=>o});var n=s(25781),a=s(78992),r=s(2352),l=s(28475);function o(e){let{uidInjectedAST:t,changes:s,cleanupAttributes:l=!1}=e;if(!t)return{success:!1,error:"UID-injected AST is required for unified updates - no source parsing fallbacks"};try{console.log("✏️ [UNIFIED-EDIT] Processing changes (main branch style):",{totalChanges:s.length,changes:s.map(e=>({uid:e.uid,hasText:!!e.textChange,hasStyle:!!e.styleChanges,instanceIndex:e.instanceIndex}))});let e=[],o=new Map;s.forEach(e=>{e.uid&&o.set(e.uid,e)});let c=new Set;(0,n.default)(t,{JSXElement(t){var s,n;if(r.isJSXFragment(t.parent)||!t.node.openingElement.name)return;let a="".concat(null===(s=t.node.openingElement.loc)||void 0===s?void 0:s.start.line,":").concat(null===(n=t.node.openingElement.loc)||void 0===n?void 0:n.start.column);if(c.has(a))return;let l=t.node.openingElement.attributes.find(e=>{var t;return r.isJSXAttribute(e)&&(null===(t=e.name)||void 0===t?void 0:t.name)==="data-editor-uid"});if(!l||!r.isJSXAttribute(l)||!r.isStringLiteral(l.value))return;let d=l.value.value,u=o.get(d);if(!u)return;c.add(a);let m=!1;if(void 0!==u.textChange){console.log("✏️ [TEXT-EDIT] Applying text change:",{uid:d,newText:u.textChange.substring(0,50)});let e=t.node.children.filter(e=>!(r.isJSXText(e)||r.isJSXExpressionContainer(e)&&r.isStringLiteral(e.expression))),s=r.jsxText(u.textChange);t.node.children=[...e,s],m=!0,console.log("✅ [TEXT-EDIT] Text updated via direct AST manipulation")}if(u.styleChanges){console.log("\uD83C\uDFA8 [STYLE-EDIT] Applying style changes:",u.styleChanges);let e=t.node.openingElement.attributes.find(e=>{var t;return r.isJSXAttribute(e)&&(null===(t=e.name)||void 0===t?void 0:t.name)==="className"});if(e){if(r.isJSXAttribute(e)){let t="";r.isStringLiteral(e.value)?t=e.value.value:r.isJSXExpressionContainer(e.value)&&r.isStringLiteral(e.value.expression)&&(t=e.value.expression.value);let s=i(t,u.styleChanges);console.log("\uD83C\uDFA8 [STYLE-EDIT] Updating className:",{currentClasses:t,newClasses:s}),r.isStringLiteral(e.value)?e.value.value=s:r.isJSXExpressionContainer(e.value)&&r.isStringLiteral(e.value.expression)&&(e.value.expression.value=s),m=!0,console.log("✅ [STYLE-EDIT] Updated existing className")}}else{let s=i("",u.styleChanges);e=r.jsxAttribute(r.jsxIdentifier("className"),r.stringLiteral(s)),t.node.openingElement.attributes.push(e),m=!0,console.log("✅ [STYLE-EDIT] Created new className:",s)}for(let e of["src","alt","title","width","height"])if(void 0!==u.styleChanges[e]){let s=u.styleChanges[e];console.log("\uD83D\uDDBC️ [IMAGE-ATTR] Updating ".concat(e," to: ").concat(s));let n=t.node.openingElement.attributes.find(t=>{var s;return r.isJSXAttribute(t)&&(null===(s=t.name)||void 0===s?void 0:s.name)===e});if(n&&r.isJSXAttribute(n))n.value=r.stringLiteral(s),console.log("✅ [IMAGE-ATTR] Updated existing ".concat(e," attribute"));else{let n=r.jsxAttribute(r.jsxIdentifier(e),r.stringLiteral(s));t.node.openingElement.attributes.push(n),console.log("✅ [IMAGE-ATTR] Created new ".concat(e," attribute"))}m=!0}}m&&e.push(u)}}),l&&(0,n.default)(t,{JSXOpeningElement(e){e.node.attributes=e.node.attributes.filter(e=>!(r.isJSXAttribute(e)&&r.isJSXIdentifier(e.name)&&(e.name.name.startsWith("data-editor-")||e.name.name.startsWith("data-component-")||"data-static"===e.name.name)))}});let d=(0,a.default)(t,{retainLines:!1,compact:!1});return console.log("✅ [UNIFIED-EDIT] Successfully generated code:",{codeLength:d.code.length,appliedChanges:e.length,hasTextRed:d.code.includes("text-red"),hasTextYellow:d.code.includes("text-yellow"),hasBgGreen:d.code.includes("bg-green")}),{success:!0,content:d.code,appliedChanges:e,finalAST:t}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}function i(e,t){if(!t)return e;let s=e.split(" ").filter(e=>e.trim()),n=e=>{s=s.filter(t=>!t.startsWith(e))};return t.textColorClass&&(s=s.filter(e=>!(/^text-(red|green|blue|yellow|purple|pink|indigo|gray|slate|zinc|neutral|stone|orange|amber|lime|emerald|teal|cyan|sky|violet|fuchsia|rose)-\d{2,3}$/.test(e)||/^text-\[#[0-9A-Fa-f]{6}\]$/.test(e)||/^text-\[rgb\(.+\)\]$/.test(e)||/^text-white$/.test(e)||/^text-black$/.test(e)))).push(t.textColorClass),t.bgColorClass&&(n("bg-"),s.push(t.bgColorClass)),t.bgImageClass&&(s=s.filter(e=>!e.startsWith("bg-[url(")&&!e.startsWith("bg-gradient-"))).push(t.bgImageClass),t.bgSizeClass&&(s=s.filter(e=>!e.startsWith("bg-cover")&&!e.startsWith("bg-contain")&&!e.startsWith("bg-auto"))).push(t.bgSizeClass),t.bgPositionClass&&(s=s.filter(e=>!e.startsWith("bg-center")&&!e.startsWith("bg-top")&&!e.startsWith("bg-bottom")&&!e.startsWith("bg-left")&&!e.startsWith("bg-right"))).push(t.bgPositionClass),t.textSizeClass&&(s=s.filter(e=>!/^text-(xs|sm|base|lg|xl|2xl|3xl|4xl|5xl|6xl|7xl|8xl|9xl)$/.test(e))).push(t.textSizeClass),t.textAlignClass&&(s=s.filter(e=>!/^text-(left|center|right|justify)$/.test(e))).push(t.textAlignClass),t.justifyClass&&(n("justify-"),s.push(t.justifyClass)),t.alignItemsClass&&(n("items-"),s.push(t.alignItemsClass)),t.paddingClass&&(n("p-"),n("px-"),n("py-"),n("pt-"),n("pb-"),n("pl-"),n("pr-"),s.push(t.paddingClass)),t.marginClass&&(n("m-"),n("mx-"),n("my-"),n("mt-"),n("mb-"),n("ml-"),n("mr-"),s.push(t.marginClass)),(0,l.QP)(s.join(" "))}},10929:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var n=s(74848),a=s(96540),r=s(74243);let l=(0,a.forwardRef)((e,t)=>{let{onImagesUploaded:s,maxFiles:l=20,showPreview:o=!0}=e,[i,c]=(0,a.useState)([]),[d,u]=(0,a.useState)(!1),[m,g]=(0,a.useState)(null),h=(0,a.useRef)(null),x=(0,r.VB)(),p=(0,a.useRef)(null),f=(0,a.useRef)([]),b=(0,a.useCallback)(async e=>{if(0===e.length)return;console.log("ImageUpload: Uploading ".concat(e.length," files")),u(!0),g(null);let t=[...f.current];try{for(let s of e){let e=await fetch("/api/uploads/signed-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileType:s.type,fileName:s.name||"image-".concat(Date.now(),".").concat(s.type.split("/")[1])})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to get signed URL")}let{signedUrl:n,fileUrl:a,fileName:r}=await e.json();if(!(await fetch(n,{method:"PUT",body:s,headers:{"Content-Type":s.type},mode:"cors"})).ok)throw Error("Failed to upload file to S3");(await fetch("/api/uploads/confirm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:r,fileUrl:a})})).ok||console.warn("Failed to confirm upload in database, but file was uploaded successfully"),t.push(a)}c(t),s([...t])}catch(e){console.error("Upload error:",e),g(e instanceof Error?e.message:"An unknown error occurred")}finally{u(!1)}},[s]),y=(0,a.useRef)(b);(0,a.useEffect)(()=>{y.current=b},[b]),(0,a.useEffect)(()=>{f.current=i},[i]),(0,a.useEffect)(()=>{if(!p.current)return p.current=x.registerHandler({uploadFiles:async e=>(console.log("GlobalDropzone called ImageUpload handler with",e.length,"files"),y.current(e))}),()=>{p.current&&(x.unregisterHandler(p.current),p.current=null)}},[x]),(0,a.useImperativeHandle)(t,()=>({uploadFiles:b}));let v=e=>{let t=[...i];t.splice(e,1),c(t),s(t)},j=(0,a.useCallback)(e=>{if(e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&e.dataTransfer.files.length>0){let t=Array.from(e.dataTransfer.files).filter(e=>e.type.startsWith("image/")&&e.size<=5242880);t.length>0&&b(t)}},[b]);return(0,n.jsxs)("div",{className:"p-4",onDragOver:e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},onDragEnter:e=>{e.preventDefault(),e.stopPropagation()},onDrop:j,children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsxs)("label",{className:"flex items-center cursor-pointer rounded-md px-3 py-1.5 text-sm bg-gray-700 text-white hover:bg-gray-600 transition ".concat(d?"opacity-50 cursor-not-allowed":""),children:[(0,n.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),d?"Uploading...":"Add Images",(0,n.jsx)("input",{type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",multiple:!0,onChange:e=>{var t;if(g(null),!(null===(t=e.target.files)||void 0===t?void 0:t.length))return;if(i.length+e.target.files.length>l){g("You can only upload a maximum of ".concat(l," images."));return}let s=Array.from(e.target.files).filter(e=>{let t=["image/jpeg","image/png","image/gif","image/webp"].includes(e.type);return t||g("Only JPEG, PNG, GIF, or WebP images are allowed."),t});if(s.filter(e=>e.size>5242880).length>0){g("Some files exceed the 5MB limit and were not added.");let e=s.filter(e=>e.size<=5242880);e.length>0&&b(e)}else s.length>0&&b(s);h.current&&(h.current.value="")},className:"hidden",ref:h,disabled:d})]})}),m&&(0,n.jsx)("div",{className:"text-red-500 text-sm mt-2",children:m}),o&&i.length>0&&(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:i.map((e,t)=>(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded overflow-hidden flex items-center justify-center",children:(0,n.jsx)("img",{src:e,alt:"Uploaded ".concat(t),className:"w-full h-full object-cover"})}),(0,n.jsx)("button",{onClick:()=>v(t),className:"absolute -top-1 -right-1 bg-gray-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs hover:bg-gray-600",children:(0,n.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},t))})})]})});l.displayName="ImageUpload";let o=l},52250:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>tU});var n=s(74848),a=s(96540),r=s(86715),l=s(13368),o=s.n(l),i=s(91106),c=s.n(i),d=s(99965),u=s(59836),m=s(87134),g=s(42515);let h=(0,u.v)()((0,m.lt)(e=>({projectId:null,projectData:null,files:{},changedFiles:{},isSaving:!1,hasUnsavedChanges:!1,activeView:"preview",previewMode:"desktop",inspectorMode:!1,previewType:"old",editingTool:"select",selectedElement:null,inspectorTab:"text",editingText:"",selectedTextColor:"",selectedBgColor:"",selectedBgImage:"",selectedBgSize:"",selectedBgPosition:"",selectedTextSize:"",selectedPadding:"",selectedMargin:"",selectedTextAlign:"",selectedJustify:"",selectedAlignItems:"",isUpdatingElement:!1,refreshKey:0,isRefreshing:!1,isLoading:!0,loadingText:"Loading project...",isMobile:!1,mobileActiveTab:"chat",sidebarTextColor:"",sidebarCustomColors:!1,availablePages:[],selectedPageRoute:null,navigationType:"none",flushPendingUpdates:null,elementChanges:{},currentlySelectedElementUID:null,customTextColor:"#3B82F6",showCustomColorPicker:!1,pendingStyleChanges:{},pendingElementChanges:{},pendingChangesByRoute:{},currentRoute:null,uidInjectedASTs:{},taggedSelection:null,aiSelectionMode:!1,isTaggingElement:!1,setProjectId:t=>e({projectId:t},!1,"setProjectId"),setProjectData:t=>e({projectData:t},!1,"setProjectData"),updateProjectData:t=>e(e=>({projectData:e.projectData?{...e.projectData,...t}:t}),!1,"updateProjectData"),setFiles:t=>e({files:t,uidInjectedASTs:{}},!1,"setFiles"),updateFile:(t,s)=>e(e=>({files:{...e.files,[t]:s}}),!1,"updateFile"),setChangedFiles:t=>e({changedFiles:t,hasUnsavedChanges:Object.keys(t).length>0},!1,"setChangedFiles"),updateChangedFile:(t,s)=>(console.log("\uD83D\uDCDD [UPDATE-FILE] updateChangedFile called:",{path:t,contentLength:null==s?void 0:s.length,hasContent:!!s,hasTextRed:null==s?void 0:s.includes("text-red"),hasTextYellow:null==s?void 0:s.includes("text-yellow"),hasBgGreen:null==s?void 0:s.includes("bg-green"),snippet:null==s?void 0:s.substring(0,150)}),e(e=>{let n={...e.changedFiles,[t]:s};return console.log("\uD83D\uDCDD [UPDATE-FILE] Updated changedFiles:",{previousCount:Object.keys(e.changedFiles).length,newCount:Object.keys(n).length,files:Object.keys(n)}),{changedFiles:n,hasUnsavedChanges:!0}},!1,"updateChangedFile")),clearChangedFiles:()=>e({changedFiles:{},hasUnsavedChanges:!1},!1,"clearChangedFiles"),setIsSaving:t=>e({isSaving:t},!1,"setIsSaving"),setHasUnsavedChanges:t=>e({hasUnsavedChanges:t},!1,"setHasUnsavedChanges"),setActiveView:t=>e({activeView:t},!1,"setActiveView"),setPreviewMode:t=>e({previewMode:t},!1,"setPreviewMode"),setInspectorMode:t=>e({inspectorMode:t},!1,"setInspectorMode"),setPreviewType:t=>e({previewType:t},!1,"setPreviewType"),setEditingTool:t=>e({editingTool:t},!1,"setEditingTool"),setSelectedElement:t=>e({selectedElement:t},!1,"setSelectedElement"),setInspectorTab:t=>e({inspectorTab:t},!1,"setInspectorTab"),setEditingText:t=>e({editingText:t},!1,"setEditingText"),setSelectedStyles:t=>e(e=>{var s,n,a,r,l,o,i,c,d,u,m;return{selectedTextColor:null!==(s=t.textColor)&&void 0!==s?s:e.selectedTextColor,selectedBgColor:null!==(n=t.bgColor)&&void 0!==n?n:e.selectedBgColor,selectedBgImage:null!==(a=t.bgImage)&&void 0!==a?a:e.selectedBgImage,selectedBgSize:null!==(r=t.bgSize)&&void 0!==r?r:e.selectedBgSize,selectedBgPosition:null!==(l=t.bgPosition)&&void 0!==l?l:e.selectedBgPosition,selectedTextSize:null!==(o=t.textSize)&&void 0!==o?o:e.selectedTextSize,selectedPadding:null!==(i=t.padding)&&void 0!==i?i:e.selectedPadding,selectedMargin:null!==(c=t.margin)&&void 0!==c?c:e.selectedMargin,selectedTextAlign:null!==(d=t.textAlign)&&void 0!==d?d:e.selectedTextAlign,selectedJustify:null!==(u=t.justify)&&void 0!==u?u:e.selectedJustify,selectedAlignItems:null!==(m=t.alignItems)&&void 0!==m?m:e.selectedAlignItems}},!1,"setSelectedStyles"),clearSelectedElement:()=>{var t;let s=h.getState();if(null===(t=s.selectedElement)||void 0===t||!t.uid)return e({selectedElement:null,editingText:"",inspectorTab:"text",selectedTextColor:"",selectedBgColor:"",selectedBgImage:"",selectedBgSize:"",selectedBgPosition:"",selectedTextSize:"",selectedPadding:"",selectedMargin:"",selectedTextAlign:"",selectedJustify:"",selectedAlignItems:""},!1,"clearSelectedElement");{let t={...s.pendingStyleChanges};return delete t[s.selectedElement.uid],e({selectedElement:null,editingText:"",inspectorTab:"text",selectedTextColor:"",selectedBgColor:"",selectedBgImage:"",selectedBgSize:"",selectedBgPosition:"",selectedTextSize:"",selectedPadding:"",selectedMargin:"",selectedTextAlign:"",selectedJustify:"",selectedAlignItems:"",pendingStyleChanges:t},!1,"clearSelectedElement")}},setIsUpdatingElement:t=>e({isUpdatingElement:t},!1,"setIsUpdatingElement"),incrementRefreshKey:()=>e(e=>({refreshKey:e.refreshKey+1}),!1,"incrementRefreshKey"),setIsRefreshing:t=>e({isRefreshing:t},!1,"setIsRefreshing"),setIsLoading:t=>e({isLoading:t},!1,"setIsLoading"),setLoadingText:t=>e({loadingText:t},!1,"setLoadingText"),setIsMobile:t=>e({isMobile:t},!1,"setIsMobile"),setMobileActiveTab:t=>e({mobileActiveTab:t},!1,"setMobileActiveTab"),setSidebarTextColor:t=>e({sidebarTextColor:t},!1,"setSidebarTextColor"),setSidebarCustomColors:t=>e({sidebarCustomColors:t},!1,"setSidebarCustomColors"),setAvailablePages:(t,s)=>e({availablePages:t,navigationType:s},!1,"setAvailablePages"),setSelectedPageRoute:t=>e({selectedPageRoute:t},!1,"setSelectedPageRoute"),setFlushPendingUpdates:t=>e({flushPendingUpdates:t},!1,"setFlushPendingUpdates"),executeFlushPendingUpdates:()=>{console.log("\uD83D\uDCBE [SAVE-TRIGGER] executeFlushPendingUpdates called - starting flush process");let e=h.getState();e.flushPendingUpdates?(console.log("\uD83D\uDCBE [SAVE-TRIGGER] Flush callback exists, calling it now..."),e.flushPendingUpdates(),console.log("\uD83D\uDCBE [SAVE-TRIGGER] Flush callback completed")):console.warn("⚠️ [SAVE-TRIGGER] No flush callback registered!")},setElementText:(t,s)=>e(e=>({elementChanges:{...e.elementChanges,[t]:s}}),!1,"setElementText"),getElementText:e=>h.getState().elementChanges[e],clearElementChanges:()=>e({elementChanges:{}},!1,"clearElementChanges"),selectElement:t=>{var s,n,a,r,l,o,i,c,d,u,m,g,x,p,f,b,y,v,j,w,N,k,C;let S=h.getState();if((null==t?void 0:t.uid)===(null===(s=S.selectedElement)||void 0===s?void 0:s.uid))return e({selectedElement:t},!1,"selectElement-reselection");let E=(null==t?void 0:null===(a=t.styleData)||void 0===a?void 0:null===(n=a.className)||void 0===n?void 0:n.split(" "))||[],T=E.find(e=>/^text-(red|green|blue|yellow|purple|pink|indigo|gray|slate|zinc|neutral|stone|orange|amber|lime|emerald|teal|cyan|sky|violet|fuchsia|rose)-\d{2,3}$/.test(e)||/^text-\[#[0-9A-Fa-f]{6}\]$/.test(e)||/^text-\[rgb\(.+\)\]$/.test(e)||/^text-white$/.test(e)||/^text-black$/.test(e))||"",I=E.find(e=>e.startsWith("bg-")&&!e.includes("gradient")&&!e.includes("url(")&&!e.includes("bg-cover")&&!e.includes("bg-contain")&&!e.includes("bg-center")&&!e.includes("bg-top")&&!e.includes("bg-bottom")&&!e.includes("bg-left")&&!e.includes("bg-right"))||"",A=E.find(e=>e.startsWith("bg-[url(")||e.startsWith("bg-gradient-"))||"",D=E.find(e=>e.startsWith("bg-cover")||e.startsWith("bg-contain")||e.startsWith("bg-auto"))||"",P=E.find(e=>e.startsWith("bg-center")||e.startsWith("bg-top")||e.startsWith("bg-bottom")||e.startsWith("bg-left")||e.startsWith("bg-right"))||"",M=E.find(e=>/^text-(xs|sm|base|lg|xl|2xl|3xl|4xl|5xl|6xl|7xl|8xl|9xl)$/.test(e))||"",L=E.find(e=>e.startsWith("p-"))||"",O=E.find(e=>e.startsWith("m-"))||"",R=E.find(e=>/^text-(left|center|right|justify)$/.test(e))||"",F=E.find(e=>e.startsWith("justify-"))||"",B=E.find(e=>e.startsWith("items-"))||"",U=S.customTextColor;(null==T?void 0:T.startsWith("text-[#"))&&(U=T.slice(6,-1));let z=S.pendingElementChanges[null==t?void 0:t.uid],W=null!==(p=null!==(x=null==z?void 0:z.textChange)&&void 0!==x?x:null==t?void 0:t.text)&&void 0!==p?p:"",_=null!==(f=null==z?void 0:null===(r=z.styleChanges)||void 0===r?void 0:r.textColorClass)&&void 0!==f?f:T,H=null!==(b=null==z?void 0:null===(l=z.styleChanges)||void 0===l?void 0:l.bgColorClass)&&void 0!==b?b:I,G=null!==(y=null==z?void 0:null===(o=z.styleChanges)||void 0===o?void 0:o.bgImageClass)&&void 0!==y?y:A,V=null!==(v=null==z?void 0:null===(i=z.styleChanges)||void 0===i?void 0:i.bgSizeClass)&&void 0!==v?v:D,J=null!==(j=null==z?void 0:null===(c=z.styleChanges)||void 0===c?void 0:c.bgPositionClass)&&void 0!==j?j:P,$=null!==(w=null==z?void 0:null===(d=z.styleChanges)||void 0===d?void 0:d.textSizeClass)&&void 0!==w?w:M,q=null!==(N=null==z?void 0:null===(u=z.styleChanges)||void 0===u?void 0:u.textAlignClass)&&void 0!==N?N:R,X=null!==(k=null==z?void 0:null===(m=z.styleChanges)||void 0===m?void 0:m.justifyClass)&&void 0!==k?k:F,Y=null!==(C=null==z?void 0:null===(g=z.styleChanges)||void 0===g?void 0:g.alignItemsClass)&&void 0!==C?C:B;return e({selectedElement:t,currentlySelectedElementUID:null==t?void 0:t.uid,editingText:W,selectedTextColor:_,selectedBgColor:H,selectedBgImage:G,selectedBgSize:V,selectedBgPosition:J,selectedTextSize:$,selectedPadding:L,selectedMargin:O,selectedTextAlign:q,selectedJustify:X,selectedAlignItems:Y,customTextColor:U,inspectorTab:"text"},!1,"selectElement-new")},updateElementStyles:t=>e(e=>{var s,n,a,r,l,o,i,c,d,u,m;return{selectedTextColor:null!==(s=t.textColor)&&void 0!==s?s:e.selectedTextColor,selectedBgColor:null!==(n=t.bgColor)&&void 0!==n?n:e.selectedBgColor,selectedBgImage:null!==(a=t.bgImage)&&void 0!==a?a:e.selectedBgImage,selectedBgSize:null!==(r=t.bgSize)&&void 0!==r?r:e.selectedBgSize,selectedBgPosition:null!==(l=t.bgPosition)&&void 0!==l?l:e.selectedBgPosition,selectedTextSize:null!==(o=t.textSize)&&void 0!==o?o:e.selectedTextSize,selectedPadding:null!==(i=t.padding)&&void 0!==i?i:e.selectedPadding,selectedMargin:null!==(c=t.margin)&&void 0!==c?c:e.selectedMargin,selectedTextAlign:null!==(d=t.textAlign)&&void 0!==d?d:e.selectedTextAlign,selectedJustify:null!==(u=t.justify)&&void 0!==u?u:e.selectedJustify,selectedAlignItems:null!==(m=t.alignItems)&&void 0!==m?m:e.selectedAlignItems}},!1,"updateElementStyles"),setCustomTextColor:t=>e({customTextColor:t},!1,"setCustomTextColor"),setShowCustomColorPicker:t=>e({showCustomColorPicker:t},!1,"setShowCustomColorPicker"),applyCustomTextColor:()=>{let t=h.getState();return e({selectedTextColor:"text-[".concat(t.customTextColor,"]"),showCustomColorPicker:!1},!1,"applyCustomTextColor")},setPendingStyleChanges:(t,s)=>e(e=>({pendingStyleChanges:{...e.pendingStyleChanges,[t]:{...e.pendingStyleChanges[t],...s}}}),!1,"setPendingStyleChanges"),clearPendingStyleChanges:t=>e(e=>{let s={...e.pendingStyleChanges};return delete s[t],{pendingStyleChanges:s}},!1,"clearPendingStyleChanges"),getPendingStyleChanges:e=>h.getState().pendingStyleChanges[e]||{},setPendingElementChange:(t,s,n)=>(e(e=>{var a,r;let l=e.pendingElementChanges[t]||{filePath:s,timestamp:Date.now()};console.log("\uD83D\uDCBE [SET-PENDING] ===== BEFORE MERGE ====="),console.log("  UID:",t),console.log("  Existing data:",JSON.stringify(l,null,2)),console.log("  New change:",JSON.stringify(n,null,2)),console.log("\uD83D\uDCBE [INSTANCE-STORE] Storing pending change:",{uid:t,filePath:s,hasTextChange:!!n.textChange,hasStyleChanges:!!n.styleChanges,instanceIndex:n.instanceIndex,hasInstance:void 0!==n.instanceIndex});let o={...l,filePath:s,textChange:null!==(a=n.textChange)&&void 0!==a?a:l.textChange,styleChanges:n.styleChanges?{...l.styleChanges,...n.styleChanges}:l.styleChanges,instanceIndex:null!==(r=n.instanceIndex)&&void 0!==r?r:l.instanceIndex,timestamp:Date.now()};return console.log("\uD83D\uDCBE [SET-PENDING] ===== AFTER MERGE ====="),console.log("  Merged data:",JSON.stringify(o,null,2)),console.log("  Has textChange:",!!o.textChange),console.log("  Has styleChanges:",!!o.styleChanges),o.styleChanges&&(console.log("  StyleChanges keys:",Object.keys(o.styleChanges)),console.log("  StyleChanges values:",o.styleChanges)),{pendingElementChanges:{...e.pendingElementChanges,[t]:o},hasUnsavedChanges:!0}},!1,"setPendingElementChange"),{success:!0}),clearPendingElementChanges:t=>e(e=>{let s={...e.pendingElementChanges};return delete s[t],{pendingElementChanges:s}},!1,"clearPendingElementChanges"),getAllPendingElementChanges:()=>h.getState().pendingElementChanges,flushAllPendingChanges:()=>{console.log("\uD83D\uDE80 [FLUSH] ========== flushAllPendingChanges CALLED ==========");let t=h.getState(),{pendingElementChanges:s,updateChangedFile:n}=t;if(console.log("\uD83D\uDE80 [FLUSH] Total pending changes:",Object.keys(s).length),0===Object.keys(s).length){console.log("\uD83D\uDE80 [FLUSH] No pending changes to flush");return}Object.entries(s).forEach(e=>{let[t,s]=e;console.log("\uD83D\uDE80 [FLUSH] Pending change for UID ".concat(t,":"),{filePath:s.filePath,hasTextChange:!!s.textChange,textChange:s.textChange,hasStyleChanges:!!s.styleChanges,styleChanges:s.styleChanges,instanceIndex:s.instanceIndex})});let a={};return Object.entries(s).forEach(e=>{let[t,s]=e,n=s.filePath;a[n]||(a[n]=[]),a[n].push({uid:t,change:s})}),console.log("\uD83D\uDE80 [FLUSH] Grouped by files:",Object.keys(a)),Object.entries(a).forEach(e=>{var s,a;let[r,l]=e;t.changedFiles[r]||t.files[r],console.log("\uD83D\uDE80 [FLUSH] Processing file: ".concat(r,", ").concat(l.length," changes"));let o=l.map(e=>{let{uid:t,change:s}=e;return{uid:t,textChange:s.textChange,styleChanges:s.styleChanges,instanceIndex:s.instanceIndex}});console.log("\uD83D\uDCBE [INSTANCE-STORE] Flushing changes for file:",r),o.forEach((e,t)=>{var s;console.log("  Change ".concat(t+1,":"),{uid:e.uid,hasText:!!e.textChange,textChange:null===(s=e.textChange)||void 0===s?void 0:s.substring(0,30),hasStyle:!!e.styleChanges,styleChanges:e.styleChanges,instanceIndex:e.instanceIndex,hasInstance:void 0!==e.instanceIndex})});let i=t.uidInjectedASTs[r];if(console.log("\uD83D\uDE80 [FLUSH] Checking for UID-injected AST:",{filePath:r,hasAST:!!i,availableASTs:Object.keys(t.uidInjectedASTs)}),!i){console.error("❌ [FLUSH] NO UID-INJECTED AST FOR FILE:",r),console.error("  This file will be SKIPPED!"),console.error("  Available ASTs:",Object.keys(t.uidInjectedASTs)),console.error("  This is why changedFiles stays empty!");return}console.log("\uD83D\uDE80 [FLUSH] Calling applyUnifiedChanges with:",{filePath:r,changeCount:o.length,hasAST:!!i});let c=(0,g.applyUnifiedChanges)({uidInjectedAST:i,changes:o,cleanupAttributes:!1});if(console.log("\uD83D\uDE80 [FLUSH] applyUnifiedChanges result:",{success:c.success,hasContent:!!c.content,contentLength:null===(s=c.content)||void 0===s?void 0:s.length,error:c.error,appliedChangesCount:null===(a=c.appliedChanges)||void 0===a?void 0:a.length}),c.success&&c.content){console.log("\uD83D\uDE80 [FLUSH] Checking for styles in result:",{hasTextRed:c.content.includes("text-red-500"),hasTextBlue:c.content.includes("text-blue-500"),hasTextPurple:c.content.includes("text-purple-500"),hasBgYellow:c.content.includes("bg-yellow-500"),hasBgGreen:c.content.includes("bg-green-500"),contentSnippet:c.content.substring(0,500)}),c.appliedChanges&&c.appliedChanges.length<o.length&&console.warn("⚠️ [FLUSH] Not all changes were applied!",{requested:o.length,applied:c.appliedChanges.length}),console.log("\uD83D\uDE80 [FLUSH] About to call updateChangedFile..."),n(r,c.content),console.log("\uD83D\uDE80 [FLUSH] updateChangedFile called successfully");let e=h.getState().changedFiles;console.log("\uD83D\uDE80 [FLUSH] Verification - changedFiles now has:",{count:Object.keys(e).length,files:Object.keys(e),thisFileAdded:!!e[r]}),c.finalAST?(console.log("\uD83D\uDCBE [INSTANCE-STORE] Updating uidInjectedAST with EDITED version for:",r),t.uidInjectedASTs[r]=c.finalAST):(console.warn("⚠️ [INSTANCE-STORE] No finalAST returned, keeping original (edits may be lost on cleanup!)"),t.uidInjectedASTs[r]=i)}c.error&&c.error.includes("rejected")}),e({pendingElementChanges:{}},!1,"flushAllPendingChanges")},storePendingChangesForRoute:t=>{let{pendingElementChanges:s}=h.getState();if(t&&Object.keys(s).length>0)return console.log("[STORE] Storing ".concat(Object.keys(s).length," pending changes for route: ").concat(t)),e(e=>({pendingChangesByRoute:{...e.pendingChangesByRoute,[t]:{...s}}}),!1,"storePendingChangesForRoute")},restorePendingChangesForRoute:t=>{let s=h.getState().pendingChangesByRoute[t]||{};return console.log("[STORE] Restoring ".concat(Object.keys(s).length," pending changes for route: ").concat(t)),Object.keys(s).length>0&&console.log("[STORE] Changes being restored:",s),e({pendingElementChanges:{...s},currentRoute:t},!1,"restorePendingChangesForRoute")},setCurrentRoute:t=>e({currentRoute:t},!1,"setCurrentRoute"),getPendingChangesForRoute:e=>h.getState().pendingChangesByRoute[e]||{},handleProjectNavigation:()=>(h.getState(),e(e=>({previewType:"old",inspectorMode:!1,pendingElementChanges:{},elementChanges:{},pendingStyleChanges:{},uidInjectedASTs:{},changedFiles:{},hasUnsavedChanges:!1,selectedElement:null,refreshKey:e.refreshKey+1}),!1,"handleProjectNavigation")),setUidInjectedAST:(t,s)=>{var n;return console.log("\uD83C\uDF33 [AST-CAPTURE] Storing UID-injected AST:",{filePath:t,hasAST:!!s,astType:null==s?void 0:s.type,astProgram:null==s?void 0:null===(n=s.program)||void 0===n?void 0:n.type}),e(e=>{let n={...e.uidInjectedASTs,[t]:s};return console.log("\uD83C\uDF33 [AST-CAPTURE] Total ASTs stored:",Object.keys(n).length),console.log("  Files with ASTs:",Object.keys(n)),{uidInjectedASTs:n}},!1,"setUidInjectedAST")},getUidInjectedAST:e=>h.getState().uidInjectedASTs[e],clearUidInjectedASTs:()=>e({uidInjectedASTs:{}},!1,"clearUidInjectedASTs"),setTaggedSelection:t=>e({taggedSelection:t},!1,"setTaggedSelection"),clearTaggedSelection:()=>e({taggedSelection:null},!1,"clearTaggedSelection"),setAiSelectionMode:t=>e({aiSelectionMode:t},!1,"setAiSelectionMode"),setIsTaggingElement:t=>e({isTaggingElement:t},!1,"setIsTaggingElement"),resetToSavedState:()=>e(e=>({changedFiles:{},hasUnsavedChanges:!1,pendingElementChanges:{},elementChanges:{},pendingStyleChanges:{},selectedElement:null,editingText:"",inspectorTab:"text",selectedTextColor:"",selectedBgColor:"",selectedBgImage:"",selectedBgSize:"",selectedBgPosition:"",selectedTextSize:"",selectedPadding:"",selectedMargin:"",selectedTextAlign:"",selectedJustify:"",selectedAlignItems:"",taggedSelection:null,aiSelectionMode:!1,isTaggingElement:!1,previewType:"old",refreshKey:e.refreshKey+1}),!1,"resetToSavedState")}),{name:"editor-store"}));var x=s(59345);function p(e){let{projectSlug:t,projectId:s,userSubscription:r,onSubscriptionClick:l,showNavDropdown:o,setShowNavDropdown:i}=e,[u,m]=(0,a.useState)(!1),[g,h]=(0,a.useState)(r),[p,f]=(0,a.useState)(!1),{isWhitelabel:b,whitelabelConfig:y}=(0,d.p)(),v=async()=>{if(!g&&!p)try{f(!0);let e=await fetch("/api/subscription");if(e.ok){let t=await e.json();t.subscription&&h({tier:t.subscription.tier,messageCount:t.subscription.messageCount,messageLimit:t.subscription.limit,monthlyBuildSpend:t.subscription.monthlyBuildSpend,monthlyBuildCredit:t.subscription.monthlyBuildCredit,dailyBuildSpend:t.subscription.dailyBuildSpend,dailyBuildCredit:t.subscription.dailyBuildCredit,dailyLimit:t.subscription.dailyLimit,monthlyLimit:t.subscription.monthlyLimit,dailyCount:t.subscription.dailyCount,monthlyCount:t.subscription.monthlyCount})}}catch(e){console.error("Error fetching subscription info:",e)}finally{f(!1)}},j=(null==g?void 0:g.monthlyBuildCredit)||0;(null==g?void 0:g.tier)===x.i.FREE&&(j=(null==g?void 0:g.dailyBuildCredit)||0);let w=(null==g?void 0:g.monthlyBuildSpend)||0;return((null==g?void 0:g.tier)===x.i.FREE&&(w=(null==g?void 0:g.dailyBuildSpend)||0),t)?(0,n.jsxs)("div",{className:"relative ml-0","data-sentry-component":"ProjectNavDropdown","data-sentry-source-file":"ProjectNavDropdown.tsx",children:[(0,n.jsxs)("button",{"data-dropdown-toggle":"nav-dropdown",onClick:()=>{let e=!o;e&&v(),i(e),m(!1)},className:"flex items-center text-gray-300 hover:text-white px-2 py-1 rounded-md text-sm font-medium truncate max-w-[180px] sm:max-w-none",children:[(0,n.jsx)("span",{className:"mr-1 truncate",children:t}),(0,n.jsx)("svg",{className:"w-4 h-4 flex-shrink-0 transition-transform duration-200 ".concat(o?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"ProjectNavDropdown.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7","data-sentry-element":"path","data-sentry-source-file":"ProjectNavDropdown.tsx"})})]}),o&&(0,n.jsxs)("div",{"data-dropdown":"nav-dropdown",className:"absolute left-0 mt-2 w-64 ".concat(!b&&"bg-gray-900"," border border-gray-800 rounded-lg shadow-lg z-50 animate-in fade-in slide-in-from-top-2 duration-200"),style:{backgroundColor:b&&(null==y?void 0:y.primaryColor)||void 0},children:[(0,n.jsx)("div",{className:"p-3 border-b border-gray-800",children:p?(0,n.jsxs)("div",{className:"flex items-center justify-center py-2",children:[(0,n.jsxs)("svg",{className:"animate-spin h-4 w-4 text-blue-500 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,n.jsx)("span",{className:"text-gray-400 text-xs",children:"Loading subscription info..."})]}):g?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{className:"text-gray-400 text-xs",children:"Subscription"}),(0,n.jsx)("span",{className:"text-blue-400 text-xs font-medium capitalize cursor-pointer",onClick:l,children:g.tier})]}),(0,n.jsxs)("div",{className:"mt-1 flex justify-between items-center",children:[(0,n.jsx)("span",{className:"text-gray-400 text-xs",children:"Build Credit Used"}),(0,n.jsxs)("span",{className:"text-gray-300 text-xs",children:["$",w.toFixed(2)," / $",j]})]}),(0,n.jsx)("div",{className:"mt-2 h-1.5 w-full ".concat(!b&&"bg-gray-800"," rounded-full overflow-hidden"),style:{backgroundColor:b&&(null==y?void 0:y.secondaryColor)||void 0},children:(0,n.jsx)("div",{className:"h-full ".concat(!b&&"bg-blue-600"," rounded-full"),style:{backgroundColor:b&&(null==y?void 0:y.tertiaryColor)||void 0,width:"".concat(Math.min(100,w/j*100),"%")}})})]}):(0,n.jsx)("div",{className:"text-gray-400 text-xs text-center py-1",children:"Unable to load subscription info"})}),(0,n.jsxs)("div",{className:"py-1",children:[s&&(0,n.jsx)(c(),{href:"/project/".concat(s,"/settings"),className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("svg",{className:"w-4 h-4 mr-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Project Settings"]})}),(0,n.jsx)(c(),{href:"/dashboard",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 mr-2 text-gray-400",children:[(0,n.jsx)("rect",{width:"7",height:"9",x:"3",y:"3",rx:"1"}),(0,n.jsx)("rect",{width:"7",height:"5",x:"14",y:"3",rx:"1"}),(0,n.jsx)("rect",{width:"7",height:"9",x:"14",y:"12",rx:"1"}),(0,n.jsx)("rect",{width:"7",height:"5",x:"3",y:"16",rx:"1"})]}),"Dashboard"]})}),!b&&(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",onClick:()=>m(!u),onMouseEnter:()=>m(!0),children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 mr-2 text-gray-400",children:[(0,n.jsx)("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),(0,n.jsx)("path",{d:"M16 3.128a4 4 0 0 1 0 7.744"}),(0,n.jsx)("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),(0,n.jsx)("circle",{cx:"9",cy:"7",r:"4"})]}),"Community"]}),(0,n.jsx)("svg",{className:"w-3 h-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})]})}),u&&(0,n.jsxs)("div",{className:"absolute left-0 top-full mt-1 sm:mt-0 sm:left-full sm:top-0 w-64 ".concat(!b&&"bg-gray-900"," border border-gray-800 rounded-lg shadow-lg overflow-hidden z-50 sm:ml-0 animate-in fade-in slide-in-from-left-2 duration-200"),style:{backgroundColor:b&&(null==y?void 0:y.primaryColor)||void 0},onMouseLeave:()=>m(!1),children:[(0,n.jsx)(c(),{href:"/discord",target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"w-4 h-4 mr-2 text-gray-400",fill:"none",strokeWidth:1.5,stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{d:"M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"})}),"Discord"]})}),(0,n.jsx)(c(),{href:"/training",target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("svg",{className:"w-4 h-4 mr-2 text-gray-400",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[(0,n.jsx)("path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z"}),(0,n.jsx)("path",{d:"M22 10v6"}),(0,n.jsx)("path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5"})]}),"Live Training"]})}),(0,n.jsx)("a",{href:"https://x.com/Famous_AI",target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"w-4 h-4 mr-2 text-gray-400",viewBox:"0 0 1200 1227",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{d:"M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z",fill:"currentColor"})}),"X / Twitter"]})}),(0,n.jsx)("a",{href:"https://famous.ai/experts",target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 mr-2 text-gray-400",children:[(0,n.jsx)("path",{d:"M16 2v2"}),(0,n.jsx)("path",{d:"M7 22v-2a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2"}),(0,n.jsx)("path",{d:"M8 2v2"}),(0,n.jsx)("circle",{cx:"12",cy:"11",r:"3"}),(0,n.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2"})]}),"Independent Experts"]})}),(0,n.jsx)("a",{href:"https://affiliates.famous.ai",target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 mr-2 text-gray-400",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,n.jsx)("path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"}),(0,n.jsx)("path",{d:"M12 18V6"})]}),"Affiliate Program"]})})]})]}),!b&&(0,n.jsx)("a",{href:"https://famous.ai/help",target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 mr-2 text-gray-400",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,n.jsx)("path",{d:"m4.93 4.93 4.24 4.24"}),(0,n.jsx)("path",{d:"m14.83 9.17 4.24-4.24"}),(0,n.jsx)("path",{d:"m14.83 14.83 4.24 4.24"}),(0,n.jsx)("path",{d:"m9.17 14.83-4.24 4.24"}),(0,n.jsx)("circle",{cx:"12",cy:"12",r:"4"})]}),"Help Center"]})}),!b&&(0,n.jsx)("a",{href:"https://supercool.com",target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 mr-2 text-gray-400",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,n.jsx)("circle",{cx:"12",cy:"12",r:"1"})]}),"SuperCool"]})}),!b&&(0,n.jsx)("a",{href:"https://launch.famous.ai",target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 mr-2 text-gray-400",children:[(0,n.jsx)("path",{d:"M11 14h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16"}),(0,n.jsx)("path",{d:"m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9"}),(0,n.jsx)("path",{d:"m2 15 6 6"}),(0,n.jsx)("path",{d:"M19.5 8.5c.7-.7 1.5-1.6 1.5-2.7A2.73 2.73 0 0 0 16 4a2.78 2.78 0 0 0-5 1.8c0 1.2.8 2 1.5 2.8L16 12Z"})]}),"Build With Us"]})})]})]})]}):null}var f=s(96456),b=s.n(f),y=s(68553),v=s(62636);async function j(e){let{projectId:t,changedFiles:s,onSaveComplete:n,onPollingComplete:a,setLoadingText:r}=e;if(!t)throw Error("Project ID is required");let l=await fetch("/api/projects/change-files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:t,changedFiles:s})});if(429===l.status)throw Error((await l.json()).message||"Rate limit exceeded. Please try again later.");if(!l.ok)throw Error("Failed to save all changes");if(n){await n();return}if(a){r&&r("Saving changes...");let e=0,s=async()=>{if(e>=60)throw Error("Saving is taking longer than expected. Please refresh the page.");e++;try{let n=await fetch("/api/projects/".concat(t));if(!n.ok)throw Error("Failed to fetch project during polling");let l=await n.json();if("building"!==l.project.status&&"answering"!==l.project.status){r&&r(""),a(l);return}e<60&&(await new Promise(e=>setTimeout(e,3e3)),await s())}catch(e){throw e}};await s()}}var w=s(22172),N=s(25781),k=s(2352);function C(e){console.log("[PageGatherer] Total files in project:",Object.keys(e).length),console.log("[PageGatherer] First 30 file paths:",JSON.stringify(Object.keys(e).slice(0,30),null,2)),console.log("[PageGatherer] All App.tsx files in project:",JSON.stringify(Object.keys(e).filter(e=>e.includes("App.tsx")),null,2));let t=Object.keys(e).find(e=>e.endsWith("/App.tsx")||"src/App.tsx"===e||"app/src/App.tsx"===e);if(console.log("[PageGatherer] Selected App.tsx file:",JSON.stringify(t)),!t)return console.warn("[PageGatherer] App.tsx not found in project files"),console.warn("[PageGatherer] Available file paths:",Object.keys(e).slice(0,20)),{pages:[],navigationType:"none"};let s=e[t];if(!s)return console.warn("[PageGatherer] App.tsx content is empty"),{pages:[],navigationType:"none"};console.log("[PageGatherer] App.tsx content preview:",s.substring(0,500));try{let n=w.parse(s,{sourceType:"module",plugins:["jsx","typescript"]}),a=[],r=new Map;(0,N.default)(n,{ImportDeclaration(e){let t=e.node.source.value;e.node.specifiers.forEach(e=>{if(k.isImportDefaultSpecifier(e)){let s=e.local.name;r.set(s,t)}else if(k.isImportSpecifier(e)){let s="Identifier"===e.imported.type?e.imported.name:e.imported.value;r.set(s,t)}})}}),console.log("[PageGatherer] Found component imports:",JSON.stringify(Array.from(r.entries()),null,2)),(0,N.default)(n,{JSXElement(s){let n=s.node.openingElement;if(k.isJSXIdentifier(n.name)&&"Route"===n.name.name){let s=n.attributes.find(e=>k.isJSXAttribute(e)&&k.isJSXIdentifier(e.name)&&"path"===e.name.name),i=n.attributes.find(e=>k.isJSXAttribute(e)&&k.isJSXIdentifier(e.name)&&"element"===e.name.name);if(s&&i){let n="/";k.isStringLiteral(s.value)?n=s.value.value:k.isJSXExpressionContainer(s.value)&&k.isStringLiteral(s.value.expression)&&(n=s.value.expression.value),"*"===n||n.startsWith("/")||(n="/".concat(n));let c=null;if(k.isJSXExpressionContainer(i.value)){let e=i.value.expression;if(k.isJSXElement(e)){let t=e.openingElement.name;k.isJSXIdentifier(t)&&(c=t.name)}}if(c){let s;let i=r.get(c);if(i&&(s=function(e,t,s){let n=e;for(let a of(e.startsWith("@/")?n=e.replace("@/","src/"):(e.startsWith("./")||e.startsWith("../"))&&(n=function(e,t){let s=e.split("/");for(let e of t.split("/"))"."!==e&&(".."===e?s.pop():s.push(e));return s.join("/")}(t.substring(0,t.lastIndexOf("/")),e)),[".tsx",".ts",".jsx",".js"])){let e=n+a;if(s[e])return e;let t=n+"/index"+a;if(s[t])return t}console.warn("[PageGatherer] Could not resolve import: ".concat(e," (tried ").concat(n,")"))}(i,t,e)),s){var l,o;let e=(l=c,o=n,l.toLowerCase().includes("notfound")||"*"===o?"Not Found":"Index"===l&&"/"===o?"Home":l.replace(/([A-Z])/g," $1").trim());a.push({name:e,path:n,filePath:s}),console.log("[PageGatherer] Found page: ".concat(e," at ").concat(n," → ").concat(s))}else console.warn("[PageGatherer] Could not resolve file path for component: ".concat(c))}}}}});let l=a.filter(e=>"*"!==e.path&&!e.name.includes("Not Found"));if(console.log("[PageGatherer] Gathered ".concat(a.length," total routes, ").concat(l.length," real routes")),console.log("[PageGatherer] Real route paths:",JSON.stringify(l.map(e=>e.path),null,2)),l.length>1)return{pages:l,navigationType:"react-router"};return{pages:[],navigationType:"none"}}catch(e){return console.error("[PageGatherer] Error parsing App.tsx:",e),{pages:[],navigationType:"none"}}}function S(e){let{onSaveAllChanges:t}=e,{projectId:s,files:r,changedFiles:l,isSaving:o,isMobile:i,setFiles:c,setChangedFiles:d,clearChangedFiles:u,setIsSaving:m,updateChangedFile:g,sidebarTextColor:x,sidebarCustomColors:p,availablePages:f,selectedPageRoute:v,setAvailablePages:j,setSelectedPageRoute:w}=h(),[N,k]=(0,a.useState)(""),[S,E]=(0,a.useState)(""),[T,I]=(0,a.useState)(!1),[A,D]=(0,a.useState)(new Set),[P,M]=(0,a.useState)(!1),[L,O]=(0,a.useState)(!1),[R,F]=(0,a.useState)(!1),[B,U]=(0,a.useState)("files"),[z,W]=(0,a.useState)(""),[_,H]=(0,a.useState)(""),[G,V]=(0,a.useState)({}),[J,$]=(0,a.useState)(new Set),q=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=setTimeout(()=>{H(z)},300);return()=>clearTimeout(e)},[z]);let X=(0,a.useMemo)(()=>N&&l[N]||S,[l,N,S]);(0,a.useEffect)(()=>{let e=()=>{window.innerWidth<768&&M(!0)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let Y=(e=>{let t=[],s={};return Object.keys(e).sort().forEach(e=>{let n=e.split("/"),a="";n.forEach((e,r)=>{let l=r===n.length-1,o=a;if(!s[a=a?"".concat(a,"/").concat(e):e]){let n={name:e,path:a,type:l?"file":"folder",children:l?void 0:[]};s[a]=n,o&&s[o]?s[o].children.push(n):t.push(n)}})}),t})(r||{});(0,a.useEffect)(()=>{if(r&&Object.keys(r).length>0){console.log("[CodeEditor] Gathering pages from project files...");let e=C(r);if(console.log("[CodeEditor] Found ".concat(e.pages.length," pages (").concat(e.navigationType,"):"),e.pages),j(e.pages,e.navigationType),e.pages.length>0&&!v&&(console.log("[CodeEditor] Setting default page route to: ".concat(e.pages[0].path)),w(e.pages[0].path)),!N){let e=Object.keys(r)[0];k(e),E(r[e]||"")}}},[r]),(0,a.useEffect)(()=>{let e=f.find(e=>e.path===v);(null==e?void 0:e.filePath)&&e.filePath!==N&&(console.log("[CodeEditor] Page changed to ".concat(e.name,", opening file: ").concat(e.filePath)),k(e.filePath))},[v,f]),(0,a.useEffect)(()=>{let e=async e=>{if(s){I(!0);try{let t=await fetch("/api/projects/file-content?projectId=".concat(encodeURIComponent(s),"&filePath=").concat(encodeURIComponent(e))),n=await t.json();t.ok&&n.fileContent&&(E(n.fileContent),n.fileContent)}catch(e){console.error("Error fetching file content:",e)}finally{I(!1)}}};if(N&&r){let t=r[N];t?E(t):(E(""),e(N))}},[N,r,s]);let K=e=>{let t=new Set(A);t.has(e)?t.delete(e):t.add(e),D(t)},Q=function(){return(arguments.length>0&&void 0!==arguments[0]&&arguments[0],p&&x)?{color:x}:{}},Z=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return p&&x?"":e?"text-blue-800 dark:text-blue-200":"text-gray-700 dark:text-gray-300"},ee=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=A.has(e.path),a=N===e.path,r="file"===e.type&&l.hasOwnProperty(e.path);return(0,n.jsxs)("div",{"data-sentry-component":"renderFileNode","data-sentry-source-file":"CodeEditor.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center px-2 py-1 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 ".concat(a&&"file"===e.type?"bg-blue-100 dark:bg-blue-900":""," ").concat(Z(a&&"file"===e.type)),style:{paddingLeft:"".concat(16*t+8,"px"),...Q(a&&"file"===e.type)},onClick:()=>{"folder"===e.type?K(e.path):(k(e.path),window.innerWidth<768&&M(!0))},children:["folder"===e.type?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("svg",{className:"w-4 h-4 mr-2 transition-transform ".concat(s?"transform rotate-90":""),fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),(0,n.jsx)("svg",{className:"w-4 h-4 mr-2 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"w-4 h-4 mr-2"}),(0,n.jsx)("svg",{className:"w-4 h-4 mr-2 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})})]}),(0,n.jsx)("span",{className:"text-sm truncate flex-1",children:e.name}),r&&(0,n.jsx)("div",{className:"w-2 h-2 bg-orange-500 rounded-full ml-1 flex-shrink-0",title:"File has unsaved changes"})]}),"folder"===e.type&&s&&e.children&&(0,n.jsx)("div",{children:e.children.map(e=>ee(e,t+1))})]},e.path)},et=(0,a.useMemo)(()=>{if(!_.trim()||!r)return{};let e={},t=_.toLowerCase();return Object.entries(r).forEach(s=>{let[n,a]=s;if(!a||n.includes("package-lock.json"))return;let r=a.split("\n"),l=[];r.forEach((e,s)=>{let n=e.toLowerCase(),a=0;for(;;){let r=n.indexOf(t,a);if(-1===r)break;l.push({line:s+1,column:r+1,endColumn:r+t.length+1,text:e.substring(r,r+t.length),lineContent:e.trim()}),a=r+1}}),l.length>0&&(e[n]={matches:l})}),e},[_,r]);(0,a.useEffect)(()=>{V(et);let e=Object.entries(et);e.length>0?$(new Set(e.map(e=>{let[t]=e;return t}))):$(new Set)},[et]);let es=(e,t)=>{k(e),window.innerWidth<768&&M(!0),setTimeout(()=>{if(q.current){let e=q.current;e.setPosition({lineNumber:t.line,column:t.column}),e.focus(),e.revealLineInCenter(t.line);let s=e.deltaDecorations([],[{range:{startLineNumber:t.line,startColumn:t.column,endLineNumber:t.line,endColumn:t.endColumn},options:{className:"search-highlight",inlineClassName:"search-highlight-inline"}}]);setTimeout(()=>{q.current&&q.current.deltaDecorations(s,[])},2e3)}},100)},en=e=>{let t=new Set(J);t.has(e)?t.delete(e):t.add(e),$(t)};return r&&0!==Object.keys(r).length?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b(),{id:"ac8ffe8bfad96ef1",children:".search-highlight{background-color:rgba(255,255,0,.3)!important}.search-highlight-inline{background-color:rgba(255,255,0,.3)!important}"}),(0,n.jsxs)("div",{className:"jsx-ac8ffe8bfad96ef1 flex h-full max-h-[calc(100vh-70px)] w-full bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden relative",children:[!P&&(0,n.jsx)("div",{onClick:()=>M(!0),className:"jsx-ac8ffe8bfad96ef1 absolute inset-0 bg-black bg-opacity-50 z-10 md:hidden"}),(0,n.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 "+"\n        ".concat(P?"w-12":"w-64","\n        transition-all duration-300 border-r border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800\n        absolute md:relative z-20 h-full md:h-auto\n        md:flex-shrink-0\n      "),children:P?(0,n.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 w-full h-full flex flex-col items-center py-3",children:(0,n.jsx)("button",{onClick:()=>M(!1),title:"Expand file tree",className:"jsx-ac8ffe8bfad96ef1 p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400 mb-4",children:(0,n.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",className:"jsx-ac8ffe8bfad96ef1 w-5 h-5",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd",className:"jsx-ac8ffe8bfad96ef1"})})})}):(0,n.jsxs)("div",{className:"jsx-ac8ffe8bfad96ef1 w-full h-full flex flex-col",children:[(0,n.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 px-3 h-12 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between flex-shrink-0",children:(0,n.jsxs)("div",{className:"jsx-ac8ffe8bfad96ef1 flex items-center space-x-2",children:[(0,n.jsxs)("button",{onClick:()=>U("files"),title:"File Explorer",className:"jsx-ac8ffe8bfad96ef1 "+"px-2 py-1.5 rounded text-xs font-medium transition-colors flex items-center gap-1.5 ".concat("files"===B?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"),children:[(0,n.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",className:"jsx-ac8ffe8bfad96ef1 w-4 h-4",children:(0,n.jsx)("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z",className:"jsx-ac8ffe8bfad96ef1"})}),(0,n.jsx)("span",{className:"jsx-ac8ffe8bfad96ef1",children:"Files"})]}),(0,n.jsxs)("button",{onClick:()=>U("search"),title:"Search",className:"jsx-ac8ffe8bfad96ef1 "+"px-2 py-1.5 rounded text-xs font-medium transition-colors flex items-center gap-1.5 ".concat("search"===B?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"),children:[(0,n.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",className:"jsx-ac8ffe8bfad96ef1 w-4 h-4",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd",className:"jsx-ac8ffe8bfad96ef1"})}),(0,n.jsx)("span",{className:"jsx-ac8ffe8bfad96ef1",children:"Search"})]})]})}),"search"===B&&(0,n.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 px-3 py-2 border-b border-gray-200 dark:border-gray-700",children:(0,n.jsxs)("div",{className:"jsx-ac8ffe8bfad96ef1 relative",children:[(0,n.jsx)("input",{type:"text",placeholder:"Search files...",value:z,onChange:e=>W(e.target.value),autoFocus:!0,className:"jsx-ac8ffe8bfad96ef1 w-full px-3 py-2 pl-8 text-sm bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,n.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",className:"jsx-ac8ffe8bfad96ef1 absolute left-2.5 top-2.5 w-4 h-4 text-gray-400",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd",className:"jsx-ac8ffe8bfad96ef1"})}),z&&(0,n.jsx)("button",{onClick:()=>W(""),className:"jsx-ac8ffe8bfad96ef1 absolute right-2 top-2 p-0.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-400 hover:text-gray-600",children:(0,n.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",className:"jsx-ac8ffe8bfad96ef1 w-4 h-4",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd",className:"jsx-ac8ffe8bfad96ef1"})})})]})}),(0,n.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 flex-1 overflow-y-auto",children:"files"===B?(0,n.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 py-2",children:Y.map(e=>ee(e))}):(()=>{let e=Object.entries(G);return _.trim()&&0===e.length?(0,n.jsx)("div",{className:"px-3 py-4 text-center",children:(0,n.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No results found"})}):z.trim()?z.trim()&&!_.trim()?(0,n.jsx)("div",{className:"px-3 py-4 text-center",children:(0,n.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Searching..."})}):(0,n.jsx)("div",{className:"py-2","data-sentry-component":"renderSearchResults","data-sentry-source-file":"CodeEditor.tsx",children:e.map(e=>{let[t,{matches:s}]=e,a=J.has(t),r=t.split("/").pop()||t;return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center px-2 py-1 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 ".concat(Z()),style:Q(),onClick:()=>en(t),children:[(0,n.jsx)("svg",{className:"w-4 h-4 mr-2 transition-transform ".concat(a?"transform rotate-90":""),fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),(0,n.jsx)("svg",{className:"w-4 h-4 mr-2 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})}),(0,n.jsx)("span",{className:"text-sm truncate flex-1",children:r}),(0,n.jsxs)("span",{className:"text-xs text-gray-500 ml-2",children:["(",s.length,")"]})]}),a&&(0,n.jsx)("div",{className:"ml-6",children:s.map((e,s)=>(0,n.jsxs)("div",{className:"flex items-start px-2 py-1 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",onClick:()=>es(t,e),children:[(0,n.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 mr-3 mt-0.5 font-mono min-w-[2rem] text-right",children:e.line}),(0,n.jsx)("span",{className:"truncate ".concat(Z()),style:Q(),children:e.lineContent})]},"".concat(t,"-").concat(e.line,"-").concat(e.column,"-").concat(s)))})]},t)})}):(0,n.jsx)("div",{className:"px-3 py-4 text-center",children:(0,n.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Enter a search term"})})})()})]})}),(0,n.jsxs)("div",{className:"jsx-ac8ffe8bfad96ef1 flex-1 flex flex-col min-w-0 pl-12 md:pl-0",children:[N&&(0,n.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 px-4 h-12 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 flex-shrink-0 flex items-center",children:(0,n.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 flex items-center justify-between w-full",children:(0,n.jsxs)("div",{className:"jsx-ac8ffe8bfad96ef1 flex items-center min-w-0",children:[(0,n.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",className:"jsx-ac8ffe8bfad96ef1 w-4 h-4 mr-2 text-gray-500 flex-shrink-0",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd",className:"jsx-ac8ffe8bfad96ef1"})}),(0,n.jsx)("span",{style:Q(),className:"jsx-ac8ffe8bfad96ef1 "+"text-sm font-medium truncate ".concat(Z()),children:N}),l.hasOwnProperty(N)&&(0,n.jsx)("div",{title:"File has unsaved changes",className:"jsx-ac8ffe8bfad96ef1 w-2 h-2 bg-orange-500 rounded-full ml-2 flex-shrink-0"})]})})}),(0,n.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 flex-1 min-h-0",children:T?(0,n.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 flex items-center justify-center h-full",children:(0,n.jsx)("p",{className:"jsx-ac8ffe8bfad96ef1 text-gray-500 dark:text-gray-400",children:"Loading..."})}):N?(0,n.jsx)(y.Ay,{height:"100%",language:N.endsWith(".js")||N.endsWith(".jsx")?"javascript":N.endsWith(".ts")||N.endsWith(".tsx")?"typescript":N.endsWith(".html")?"html":N.endsWith(".css")?"css":N.endsWith(".json")?"json":N.endsWith(".sol")?"typescript":"plaintext",value:X||S,theme:"vs-dark",options:{readOnly:!1,minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,wordWrap:"on",automaticLayout:!0,tabSize:2,insertSpaces:!0,detectIndentation:!1,folding:!0,stickyScroll:{enabled:!1},lineNumbers:"on",glyphMargin:!1,contextmenu:!0,quickSuggestions:!1,suggestOnTriggerCharacters:!1,acceptSuggestionOnEnter:"off",hover:{enabled:!0},parameterHints:{enabled:!0}},onChange:e=>{if(e!==S)d({...l,[N]:e||""});else{let{[N]:e,...t}=l;d(t)}},onMount:e=>{q.current=e},beforeMount:e=>{e.languages.typescript.typescriptDefaults.setCompilerOptions({target:e.languages.typescript.ScriptTarget.ES2020,allowNonTsExtensions:!0,allowJs:!0,checkJs:!1,moduleResolution:e.languages.typescript.ModuleResolutionKind.NodeJs,module:e.languages.typescript.ModuleKind.ESNext,noEmit:!0,esModuleInterop:!0,jsx:e.languages.typescript.JsxEmit.React,allowSyntheticDefaultImports:!0,forceConsistentCasingInFileNames:!1,skipLibCheck:!0,skipDefaultLibCheck:!0,noImplicitAny:!1,noImplicitReturns:!1,noImplicitThis:!1,strictNullChecks:!1,suppressImplicitAnyIndexErrors:!0}),e.languages.typescript.javascriptDefaults.setCompilerOptions({target:e.languages.typescript.ScriptTarget.ES2020,allowNonTsExtensions:!0,allowJs:!0,checkJs:!1,moduleResolution:e.languages.typescript.ModuleResolutionKind.NodeJs,module:e.languages.typescript.ModuleKind.ESNext,noEmit:!0,esModuleInterop:!0,jsx:e.languages.typescript.JsxEmit.React,allowSyntheticDefaultImports:!0}),e.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:!1,noSyntaxValidation:!1,noSuggestionDiagnostics:!0,diagnosticCodesToIgnore:[1003,1108,1109,1011,1005,1128,1144,1228,1381,1382,1434,1435,8006,8008,8009,8010,8013,8016,8037,17008]}),e.languages.typescript.javascriptDefaults.setDiagnosticsOptions({noSemanticValidation:!1,noSyntaxValidation:!1,noSuggestionDiagnostics:!0}),e.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!1,allowComments:!0,schemas:[],enableSchemaRequest:!1,schemaRequest:"ignore"})}}):(0,n.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 flex items-center justify-center h-full",children:(0,n.jsx)("p",{className:"jsx-ac8ffe8bfad96ef1 text-gray-500 dark:text-gray-400",children:"Select a file to view its content"})})})]})]})]}):(0,n.jsx)("div",{className:"flex items-center justify-center h-full w-full bg-gray-100 dark:bg-gray-800",children:(0,n.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No code generated yet"})})}var E=s(73715),T=s(56878);function I(e){let{isOpen:t,onClose:s,onSaveAllChanges:r}=e,{projectData:l,projectId:o,hasUnsavedChanges:i,isSaving:c}=h(),{isWhitelabel:u,whitelabelConfig:m}=(0,d.p)(),[g,x]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t&&s()};if(t){let t=document.body.style.paddingRight,s=document.body.style.overflow;return document.addEventListener("keydown",e),document.body.style.overflow="hidden",document.body.style.paddingRight="0",()=>{document.removeEventListener("keydown",e),document.body.style.paddingRight=t,document.body.style.overflow=s}}return()=>{document.removeEventListener("keydown",e),document.body.style.overflow=""}},[t,s]),!t)return null;let p=async()=>{if(o){x(!0);try{let e=await fetch("/api/projects/".concat(o,"/download"));if(e.ok){let t=await e.blob(),s=window.URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download="".concat((null==l?void 0:l.slug)||"project",".zip"),document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(s),n.remove()}else if(429===e.status){let t=(await e.json()).message||"Rate limit exceeded. Please try again later.";v.Ay.error(t)}else v.Ay.error("Failed to download project"),console.error("Failed to download project")}catch(e){console.error("Download error:",e),v.Ay.error("Failed to download project. Please try again.")}finally{x(!1)}}},f=async()=>{if(r)try{await r(),s()}catch(e){console.error("Save failed:",e)}};return(0,n.jsx)("div",{className:"fixed bg-black bg-opacity-80 flex items-center justify-center z-50",style:{top:"-50px",left:"-50px",right:"-50px",bottom:"-50px",margin:0,padding:"50px"},onClick:s,"data-sentry-component":"CodeModal","data-sentry-source-file":"CodeModal.tsx",children:(0,n.jsxs)("div",{className:"relative w-full h-full max-w-7xl max-h-[90vh] m-8 bg-white dark:bg-gray-900 rounded-lg shadow-xl flex flex-col overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Code Editor"}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[i&&(0,n.jsx)("button",{onClick:f,disabled:c,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors disabled:opacity-70",title:"Save changes",children:c?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(E.A,{className:"w-4 h-4"}),"Save"]})}),(0,n.jsxs)("button",{onClick:p,disabled:g,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Download project files",children:[(0,n.jsx)(T.A,{className:"w-4 h-4 ".concat(g?"animate-pulse":""),"data-sentry-element":"Download","data-sentry-source-file":"CodeModal.tsx"}),"Download"]}),(0,n.jsx)("button",{onClick:s,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-500 dark:text-gray-400",children:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"CodeModal.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12","data-sentry-element":"path","data-sentry-source-file":"CodeModal.tsx"})})})]})]}),(0,n.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,n.jsx)(S,{onSaveAllChanges:f,"data-sentry-element":"CodeEditor","data-sentry-source-file":"CodeModal.tsx"})})]})})}function A(e){let{onSaveAllChanges:t}=e,[s,r]=(0,a.useState)(!1),{isWhitelabel:l,whitelabelConfig:o}=(0,d.p)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>r(!0),className:"px-4 py-1.5 text-sm font-medium rounded-md transition-colors ".concat(!l&&"bg-gray-800"," text-gray-400 hover:text-white"),style:{backgroundColor:l&&(null==o?void 0:o.secondaryColor)||void 0},children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"w-5 h-5 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"CodeButton.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4","data-sentry-element":"path","data-sentry-source-file":"CodeButton.tsx"})}),"Code"]})}),(0,n.jsx)(I,{isOpen:s,onClose:()=>r(!1),onSaveAllChanges:t,"data-sentry-element":"CodeModal","data-sentry-source-file":"CodeButton.tsx"})]})}function D(e){let{projectSlug:t,isMobile:s=!1,projectPlatform:a,projectPreview:r,projectBuild:l}=e,{isWhitelabel:o,whitelabelConfig:i}=(0,d.p)();if(!t||"mobile"===a)return null;let c=!!(l&&r&&l===r);return(0,n.jsx)("button",{onClick:()=>{if(t){let e="https://".concat(t,".").concat("deploypad.app");window.open(e,"_blank")}},className:"".concat(s?"p-1.5":"px-4 py-1.5"," text-sm font-medium rounded-md transition-colors ").concat(c?o?"text-white":"bg-blue-600 text-white hover:bg-blue-700":o?"text-gray-400 hover:text-white":"bg-gray-800 text-gray-400 hover:text-white"),style:{backgroundColor:c?o&&(null==i?void 0:i.tertiaryColor)||void 0:o&&(null==i?void 0:i.secondaryColor)||void 0},title:"Open preview in new window","data-sentry-component":"PreviewButton","data-sentry-source-file":"PreviewButton.tsx",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("svg",{className:"w-5 h-5 ".concat(s?"":"mr-1.5"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"PreviewButton.tsx",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z","data-sentry-element":"path","data-sentry-source-file":"PreviewButton.tsx"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z","data-sentry-element":"path","data-sentry-source-file":"PreviewButton.tsx"})]}),!s&&(0,n.jsx)("span",{children:"Preview"})]})})}function P(e){let{projectSlug:t,domains:s=[],isMobile:r=!1,projectPlatform:l,projectPreview:o,projectBuild:i}=e,[c,u]=(0,a.useState)(!1),{isWhitelabel:m,whitelabelConfig:g}=(0,d.p)();(0,a.useEffect)(()=>{if(c){let e=e=>{let t=e.target,s=t.closest('[data-dropdown-toggle="preview-dropdown"]'),n=t.closest('[data-dropdown="preview-dropdown"]');s||n||u(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}},[c]);let h=e=>{window.open(e,"_blank")};if(!t||"mobile"===l)return null;let x="https://".concat(t,".").concat("deploypad.app"),p=!!(i&&o&&i===o);return(0,n.jsxs)("div",{className:"relative","data-sentry-component":"PreviewDropdown","data-sentry-source-file":"PreviewDropdown.tsx",children:[(0,n.jsxs)("button",{"data-dropdown-toggle":"preview-dropdown",onClick:()=>u(!c),className:"".concat(r?"p-1.5":"px-4 py-1.5"," text-sm font-medium rounded-md transition-colors ").concat(p?m?"text-white":"bg-blue-600 text-white hover:bg-blue-700":m?"text-gray-400 hover:text-white":"bg-gray-800 text-gray-400 hover:text-white"," flex items-center"),style:{backgroundColor:p?m&&(null==g?void 0:g.tertiaryColor)||void 0:m&&(null==g?void 0:g.secondaryColor)||void 0},title:"Preview options",children:[(0,n.jsxs)("svg",{className:"w-5 h-5 ".concat(r?"":"mr-1.5"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"PreviewDropdown.tsx",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z","data-sentry-element":"path","data-sentry-source-file":"PreviewDropdown.tsx"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z","data-sentry-element":"path","data-sentry-source-file":"PreviewDropdown.tsx"})]}),!r&&(0,n.jsx)("span",{children:"Preview"}),!r&&(0,n.jsx)("svg",{className:"w-4 h-4 ".concat(r?"":"ml-1"," ").concat(c?"rotate-180":""," transition-transform duration-200"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),c&&(0,n.jsx)("div",{"data-dropdown":"preview-dropdown",className:"absolute ".concat(r?"-right-12":"right-0"," mt-2 w-72 ").concat(!m&&"bg-gray-900"," border border-gray-800 rounded-lg shadow-lg overflow-hidden z-50 animate-in fade-in slide-in-from-top-2 duration-200"),style:{backgroundColor:m&&(null==g?void 0:g.primaryColor)||void 0},children:(0,n.jsxs)("div",{className:"py-2",children:[(0,n.jsxs)("button",{onClick:()=>h(x),className:"w-full px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white text-left transition-colors flex items-center",children:[(0,n.jsx)("svg",{className:"w-5 h-5 text-gray-400 mr-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),(0,n.jsxs)("span",{className:"truncate",children:[t,".","deploypad.app"]})]}),s.map(e=>(0,n.jsxs)("button",{onClick:()=>h("https://".concat(e)),className:"w-full px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white text-left transition-colors flex items-center",children:[(0,n.jsx)("svg",{className:"w-5 h-5 text-gray-400 mr-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),(0,n.jsx)("span",{className:"truncate",children:e})]},e))]})})]})}function M(e){let{projectId:t,isMobile:s=!1}=e,{isWhitelabel:a,whitelabelConfig:r}=(0,d.p)();return t?(0,n.jsx)(c(),{href:"/project/".concat(t,"/settings"),className:"inline-flex ".concat(s?"p-1.5":"px-4 py-1.5"," text-sm font-medium rounded-md transition-colors ").concat(!a&&"bg-gray-800"," text-gray-400 hover:text-white"),style:{backgroundColor:a&&(null==r?void 0:r.secondaryColor)||void 0},title:"Project settings","data-sentry-element":"Link","data-sentry-component":"SettingsButton","data-sentry-source-file":"SettingsButton.tsx",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("svg",{className:"w-5 h-5 ".concat(s?"":"mr-1.5"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"SettingsButton.tsx",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z","data-sentry-element":"path","data-sentry-source-file":"SettingsButton.tsx"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z","data-sentry-element":"path","data-sentry-source-file":"SettingsButton.tsx"})]}),!s&&(0,n.jsx)("span",{children:"Settings"})]})}):null}function L(e){let{projectId:t,isMobile:s=!1}=e,{isWhitelabel:a,whitelabelConfig:r}=(0,d.p)();return t?(0,n.jsx)(c(),{href:"/project/".concat(t,"/settings#payments"),className:"inline-flex ".concat(s?"p-1.5":"px-4 py-1.5"," text-sm font-medium rounded-md transition-colors ").concat(!a&&"bg-gray-800"," text-gray-400 hover:text-white"),style:{backgroundColor:a&&(null==r?void 0:r.secondaryColor)||void 0},title:"Payments settings","data-sentry-element":"Link","data-sentry-component":"PaymentsButton","data-sentry-source-file":"PaymentsButton.tsx",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"w-5 h-5 ".concat(s?"":"mr-1.5"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"PaymentsButton.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z","data-sentry-element":"path","data-sentry-source-file":"PaymentsButton.tsx"})}),!s&&(0,n.jsx)("span",{children:"Payments"})]})}):null}function O(e){let{projectId:t,isMobile:s=!1}=e,{isWhitelabel:a,whitelabelConfig:r}=(0,d.p)();return t?(0,n.jsx)(c(),{href:"/project/".concat(t,"/settings#database"),className:"inline-flex ".concat(s?"p-1.5":"px-4 py-1.5"," text-sm font-medium rounded-md transition-colors ").concat(!a&&"bg-gray-800"," text-gray-400 hover:text-white"),style:{backgroundColor:a&&(null==r?void 0:r.secondaryColor)||void 0},title:"Database settings","data-sentry-element":"Link","data-sentry-component":"DatabaseButton","data-sentry-source-file":"DatabaseButton.tsx",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"w-5 h-5 ".concat(s?"":"mr-1.5"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"DatabaseButton.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4","data-sentry-element":"path","data-sentry-source-file":"DatabaseButton.tsx"})}),!s&&(0,n.jsx)("span",{children:"Database"})]})}):null}let R=["prerequisites","app-icon","expo-token","expo-create-project","expo-project-info","apple-create-key","apple-p8","apple-key-id","apple-issuer-id","apple-team-id","apple-create-bundle-id","apple-bundle-id","apple-create-app","apple-app-id","google-create-app","google-create-service-account","google-create-service-key","google-service-account","google-add-service-account","review","publishing"];function F(e){let{isOpen:t,onClose:s,projectId:r,onPublishSuccess:l}=e,[o,i]=(0,a.useState)("prerequisites"),[c,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)(""),[g,h]=(0,a.useState)(""),[x,p]=(0,a.useState)(!1),[f,b]=(0,a.useState)(!1),[y,j]=(0,a.useState)(!1),[w,N]=(0,a.useState)(!1),[k,C]=(0,a.useState)(!1),[S,E]=(0,a.useState)(!1),[T,I]=(0,a.useState)(!1),[A,D]=(0,a.useState)(!1),[P,M]=(0,a.useState)(!1),[L,O]=(0,a.useState)(!1),[F,B]=(0,a.useState)(""),[U,z]=(0,a.useState)(!1),[W,_]=(0,a.useState)(!1),[H,G]=(0,a.useState)({expoAccessToken:"",expoProjectSlug:"",expoProjectOwner:"",expoProjectId:"",appleP8File:null,appleKeyId:"",appleTeamId:"",appleIssuerId:"",appleAppId:"",appleBundleId:"",googleServiceAccount:null}),V=(0,a.useCallback)(async()=>{try{let e=await fetch("/api/projects/".concat(r,"?files=no"));if(e.ok){let t=(await e.json()).project;if(t.assets&&Array.isArray(t.assets)){let e=t.assets.find(e=>"./assets/images/icon.png"===e.localPath);e&&m(e.remoteUrl)}}}catch(e){console.error("Error fetching current icon:",e)}},[r]);(0,a.useEffect)(()=>{t&&(i("prerequisites"),d(!1),m(""),h(""),p(!1),b(!1),j(!1),N(!1),C(!1),E(!1),I(!1),D(!1),M(!1),O(!1),B(""),z(!1),_(!1),V())},[t,V]);let J=(e,t)=>{if(G(s=>({...s,[e]:t})),"googleServiceAccount"===e&&t){let e=new FileReader;e.onload=e=>{try{var t;let s=JSON.parse(null===(t=e.target)||void 0===t?void 0:t.result);s.client_email&&B(s.client_email)}catch(e){console.error("Error parsing JSON:",e),B("")}},e.readAsText(t)}else"googleServiceAccount"!==e||t||B("")},$=(e,t)=>{G(s=>({...s,[e]:t}))},q=async e=>{p(!0);try{let t=await fetch("/api/uploads/signed-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileType:e.type,fileName:e.name||"icon-".concat(Date.now(),".").concat(e.type.split("/")[1])})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to get signed URL")}let{signedUrl:s,fileUrl:n}=await t.json();if(!(await fetch(s,{method:"PUT",body:e,headers:{"Content-Type":e.type},mode:"cors"})).ok)throw Error("Failed to upload file to S3");if(!(await fetch("/api/projects/update-icon",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:r,iconUrl:n})})).ok)throw Error("Failed to update icon in database");h(n),v.Ay.success("App icon updated")}catch(e){console.error("Error uploading icon:",e),v.Ay.error("Failed to upload icon")}finally{p(!1)}},X=async()=>{b(!0);try{let e=await fetch("/api/projects/generate-icon",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:r})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to generate icon")}let t=await e.json(),s=await fetch("/api/projects/update-icon",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:r,iconUrl:t.iconUrl})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to update icon")}h(t.iconUrl),m(t.iconUrl),v.Ay.success("App icon updated")}catch(e){console.error("Error generating icon:",e),v.Ay.error("Failed to generate icon")}finally{b(!1)}},Y=async()=>{z(!0);try{let e=new FormData;if(e.append("projectId",r),e.append("expoAccessToken",H.expoAccessToken),e.append("expoProjectSlug",H.expoProjectSlug),e.append("expoProjectOwner",H.expoProjectOwner),e.append("expoProjectId",H.expoProjectId),e.append("appleKeyId",H.appleKeyId),e.append("appleTeamId",H.appleTeamId),e.append("appleIssuerId",H.appleIssuerId),e.append("appleAppId",H.appleAppId),e.append("appleBundleId",H.appleBundleId),H.appleP8File&&e.append("appleP8File",H.appleP8File),H.googleServiceAccount&&e.append("googleServiceAccount",H.googleServiceAccount),!(await fetch("/api/projects/mobile-publish-config",{method:"POST",body:e})).ok)throw Error("Failed to save configuration");return!0}catch(e){return console.error("Error saving configuration:",e),v.Ay.error("Failed to save configuration"),!1}finally{z(!1)}},K=async()=>{_(!0);try{if(!await Y())return;if(!(await fetch("/api/projects/mobile-publish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:r})})).ok)throw Error("Failed to publish app");v.Ay.success("App submitted to app stores! It can take several minutes to show in app store drafts.",{duration:6e3}),null==l||l(),s()}catch(e){console.error("Error publishing app:",e),v.Ay.error("Failed to start publishing process")}finally{_(!1)}};if(!t)return null;let Q=(e=>{switch(e){case"prerequisites":return c;case"app-icon":default:return!0;case"expo-token":return!!H.expoAccessToken;case"expo-create-project":return y;case"expo-project-info":return!!(H.expoProjectSlug&&H.expoProjectOwner&&H.expoProjectId);case"apple-create-key":return w;case"apple-p8":return!!H.appleP8File;case"apple-key-id":return!!H.appleKeyId;case"apple-team-id":return!!H.appleTeamId;case"apple-issuer-id":return!!H.appleIssuerId;case"apple-create-bundle-id":return k;case"apple-bundle-id":return!!H.appleBundleId;case"apple-create-app":return S;case"apple-app-id":return!!H.appleAppId;case"google-create-app":return T;case"google-create-service-account":return A;case"google-create-service-key":return P;case"google-service-account":return!!H.googleServiceAccount;case"google-add-service-account":return L}})(o),Z="review"===o;return(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","data-sentry-component":"MobilePublishModal","data-sentry-source-file":"MobilePublishModal.tsx",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto border border-gray-200 shadow-xl",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Submit to App Stores"}),"publishing"!==o&&(0,n.jsx)("button",{onClick:s,className:"text-gray-500 hover:text-gray-700",children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),"publishing"!==o&&(0,n.jsx)("div",{className:"px-6 py-4",children:(0,n.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,n.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:"".concat((R.indexOf(o)+1)/(R.length-1)*100,"%")}})})}),(0,n.jsx)("div",{className:"p-6",children:(()=>{let e=(e,t,s,a)=>(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8","data-sentry-component":"renderStepWithImage","data-sentry-source-file":"MobilePublishModal.tsx",children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:e}),(0,n.jsx)("p",{className:"text-gray-600",children:t}),s]}),(0,n.jsx)("div",{className:"flex items-center justify-center",children:a?(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"w-full h-64 rounded-lg overflow-hidden cursor-pointer hover:opacity-90 transition-opacity",children:(0,n.jsx)("img",{src:a,alt:e,className:"w-full h-full object-contain bg-white",onClick:()=>window.open(a,"_blank"),title:"Click to view full size"})}),(0,n.jsx)("p",{className:"text-center text-xs text-gray-500 cursor-pointer hover:text-gray-700 transition-colors",onClick:()=>window.open(a,"_blank"),children:"Click to view full size"})]}):(0,n.jsx)(n.Fragment,{})})]});switch(o){case"prerequisites":return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Before We Start"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"To submit your mobile app to the app stores, you'll need to complete this one-time setup process. Before starting, you'll need accounts with the following services:"})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5",children:"1"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Expo.dev Account (Free)"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Required for building and managing your React Native app"}),(0,n.jsx)("a",{href:"https://expo.dev/signup",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Create account →"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5",children:"2"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Google Cloud Account (Free)"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Needed for Google Play Store API access"}),(0,n.jsx)("a",{href:"https://cloud.google.com/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Create account →"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5",children:"3"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Apple Developer Account ($99/year)"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Required to publish apps to the iOS App Store"}),(0,n.jsx)("a",{href:"https://developer.apple.com/programs/enroll/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Join program →"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5",children:"4"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Google Play Console Account ($25 one-time)"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Required to publish apps to the Google Play Store"}),(0,n.jsx)("a",{href:"https://play.google.com/console/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Create account →"})]})]})]}),(0,n.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,n.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:c,onChange:e=>d(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:c?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:c?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,n.jsx)("span",{className:"text-gray-900",children:"I have all 4 of these accounts"})]})})]});case"app-icon":return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Update Your App Icon"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"You can customize your app's icon that will appear on users' devices."})]}),(0,n.jsxs)("div",{className:"flex flex-col items-center space-y-6",children:[(0,n.jsxs)("div",{className:"space-y-4 text-center",children:[(0,n.jsx)("h4",{className:"text-lg font-medium text-gray-900",children:"App Icon"}),(0,n.jsx)("div",{className:"flex items-center justify-center w-32 h-32 bg-gray-100 rounded-lg cursor-pointer transition-colors",onClick:()=>{var e;return!x&&!f&&(null===(e=document.getElementById("icon-file-input"))||void 0===e?void 0:e.click())},onDragOver:e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},onDragEnter:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{if(e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&e.dataTransfer.files.length>0){let t=e.dataTransfer.files[0];t.type.startsWith("image/")&&t.size<=5242880?["image/png","image/jpeg","image/jpg"].includes(t.type)?q(t):v.Ay.error("Please upload a PNG or JPEG image"):v.Ay.error("File must be an image under 5MB")}},children:x||f?(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsxs)("svg",{className:"animate-spin w-8 h-8 text-blue-500 mx-auto mb-2",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,n.jsx)("span",{className:"text-sm text-gray-600",children:f?"Generating...":"Uploading..."})]}):(0,n.jsx)(n.Fragment,{children:g||u?(0,n.jsx)("img",{src:g||u,alt:"App icon",className:"w-full h-full object-cover rounded-lg"}):(0,n.jsxs)("div",{className:"text-gray-400 text-center",children:[(0,n.jsx)("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,n.jsx)("span",{className:"text-sm",children:"Default Icon"})]})})})]}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex space-x-3 justify-center",children:[(0,n.jsx)("button",{type:"button",disabled:x||f,onClick:()=>{var e;return null===(e=document.getElementById("icon-file-input"))||void 0===e?void 0:e.click()},className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-md px-6 py-2 text-sm transition-colors",children:"Upload New Icon"}),(0,n.jsx)("button",{type:"button",disabled:x||f,onClick:X,className:"bg-purple-600 hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-md px-6 py-2 text-sm transition-colors flex items-center",children:f?(0,n.jsx)(n.Fragment,{children:"Generating..."}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Generate Using AI"]})})]}),(0,n.jsx)("input",{id:"icon-file-input",type:"file",accept:"image/png,image/jpeg,image/jpg",className:"hidden",disabled:x,onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){if(s.size>5242880){v.Ay.error("File size must be less than 5MB");return}if(!["image/png","image/jpeg","image/jpg"].includes(s.type)){v.Ay.error("Please upload a PNG or JPEG image");return}q(s)}}})]})]}),(0,n.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("svg",{className:"w-5 h-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,n.jsxs)("div",{className:"text-blue-800 text-sm",children:[(0,n.jsx)("p",{className:"font-medium mb-1",children:"Icon Guidelines:"}),(0,n.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[(0,n.jsx)("li",{children:"Use a square image (1:1 aspect ratio)"}),(0,n.jsx)("li",{children:"Recommended size: 1024x1024 pixels, PNG or JPEG, max 5MB"}),(0,n.jsx)("li",{children:"Avoid text or fine details that may not be visible at small sizes"}),(0,n.jsx)("li",{children:"Use PNG format for best quality with transparency support"})]})]})]})})]});case"expo-token":return e("Get Your Expo Access Token","You'll need an access token from Expo to build your app. This allows us to create production builds of your React Native app.",(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expo Access Token"}),(0,n.jsx)("input",{type:"password",value:H.expoAccessToken,onChange:e=>$("expoAccessToken",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"abc123xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"}),(0,n.jsxs)("p",{className:"text-gray-600 text-xs mt-1",children:["Get this from ",(0,n.jsx)("a",{href:"https://expo.dev/accounts/[account]/settings/access-tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700",children:"Expo.dev → Settings → Access Tokens"})]})]}),"/mobilepublish/expo_access_token.png");case"expo-create-project":return e("Create Your Expo Project","Create a new project in your Expo dashboard. Follow these steps:",(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to Expo Dashboard"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Visit your Expo dashboard and click "Create a project"'}),(0,n.jsx)("a",{href:"https://expo.dev/accounts/[accountid]/projects",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Open Expo Dashboard →"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Name Your Project"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"You can give it any name and slug you want. This will not be visible to users."})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create the Project"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Create project" to finish the setup'})]})]})]}),(0,n.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,n.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:y,onChange:e=>j(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:y?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:y?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,n.jsx)("span",{className:"text-gray-900",children:"I have created an Expo project"})]})})]}),"/mobilepublish/expo_create_project.png");case"expo-project-info":return e("Paste Your Expo Project Info","Now, copy these 3 values from your newly created Expo project overview page, and paste them here.",(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Slug"}),(0,n.jsx)("input",{type:"text",value:H.expoProjectSlug,onChange:e=>$("expoProjectSlug",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"johns-weather-app"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project ID"}),(0,n.jsx)("input",{type:"text",value:H.expoProjectId,onChange:e=>$("expoProjectId",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"63b71db7-..."})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Owner"}),(0,n.jsx)("input",{type:"text",value:H.expoProjectOwner,onChange:e=>$("expoProjectOwner",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"john123"})]})]}),"/mobilepublish/expo_project_info.png");case"apple-create-key":return(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Create an Apple API Key"}),(0,n.jsx)("p",{className:"text-gray-600",children:"You'll need to create an API key in App Store Connect. Follow these steps:"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to App Store Connect"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Navigate to Users and Access → Integrations"}),(0,n.jsx)("a",{href:"https://appstoreconnect.apple.com/access/integrations/api",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Open App Store Connect →"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create New API Key"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Click the "+" button to create a new API key'})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Configure the Key"}),(0,n.jsxs)("p",{className:"text-gray-600 text-sm",children:[(0,n.jsx)("strong",{children:"Name:"}),' You can type anything (e.g., "My App Publishing Key")',(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"Access:"}),' You MUST select "App Manager"']})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Generate"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Generate", and you should see a new row get added, which has a Download link'})]})]})]}),(0,n.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,n.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,n.jsx)("div",{children:(0,n.jsx)("input",{type:"checkbox",checked:w,onChange:e=>N(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:w?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:w?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}})}),(0,n.jsx)("span",{className:"text-gray-900",children:'I\'ve created an API key with "App Manager" access and downloaded it'})]})})]}),(0,n.jsxs)("div",{className:"flex flex-col items-center justify-start space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"w-full h-48 rounded-lg overflow-hidden cursor-pointer hover:opacity-90 transition-opacity",children:(0,n.jsx)("img",{src:"/mobilepublish/apple_new_key.png",alt:"Create new Apple API key",className:"w-full h-full object-contain bg-white",onClick:()=>window.open("/mobilepublish/apple_new_key.png","_blank"),title:"Click to view full size"})}),(0,n.jsx)("p",{className:"text-center text-xs text-gray-500 cursor-pointer hover:text-gray-700 transition-colors",onClick:()=>window.open("/mobilepublish/apple_new_key.png","_blank"),children:"Click to view full size"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("div",{className:"w-full h-48 rounded-lg overflow-hidden cursor-pointer hover:opacity-90 transition-opacity",children:(0,n.jsx)("img",{src:"/mobilepublish/apple_key_popup.png",alt:"Apple API key configuration popup",className:"w-full h-full object-contain bg-white",onClick:()=>window.open("/mobilepublish/apple_key_popup.png","_blank"),title:"Click to view full size"})}),(0,n.jsx)("p",{className:"text-center text-xs text-gray-500 cursor-pointer hover:text-gray-700 transition-colors",onClick:()=>window.open("/mobilepublish/apple_key_popup.png","_blank"),children:"Click to view full size"})]})]})]});case"apple-p8":return e("Upload Your Apple API Key File (.p8)","This key file allows us to authenticate with Apple's services to submit your app to the App Store.",(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Apple P8 Key File"}),(0,n.jsx)("input",{type:"file",accept:".p8",onChange:e=>{var t;return J("appleP8File",(null===(t=e.target.files)||void 0===t?void 0:t[0])||null)},className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),"/mobilepublish/apple_download_key.png");case"apple-key-id":return e("Enter Your Apple Key ID","This is the ID of the P8 key you just uploaded. You can find this in the same row as the API key you just created.",(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Key ID"}),(0,n.jsx)("input",{type:"text",value:H.appleKeyId,onChange:e=>$("appleKeyId",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"ABC123DEFG"})]}),"/mobilepublish/apple_key_id.png");case"apple-team-id":return e("Enter Your Apple Team ID","This identifies your Apple Developer team. You'll need to find this in your Apple Developer account.",(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Team ID"}),(0,n.jsx)("input",{type:"text",value:H.appleTeamId,onChange:e=>$("appleTeamId",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"ABC123DEFG"}),(0,n.jsxs)("p",{className:"text-gray-600 text-xs mt-1",children:["Sign in to ",(0,n.jsx)("a",{href:"https://developer.apple.com/account",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700",children:"developer.apple.com"}),' and scroll down to find your Team ID in the "Membership details" section']})]}),"/mobilepublish/apple_team_id.png");case"apple-issuer-id":return e("Enter Your Apple Issuer ID","This is the issuer ID for your App Store Connect API key. You can find this on the same page as the API key you just created.",(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Issuer ID"}),(0,n.jsx)("input",{type:"text",value:H.appleIssuerId,onChange:e=>$("appleIssuerId",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"})]}),"/mobilepublish/apple_issuer_id.png");case"apple-create-bundle-id":return e("Create an App Bundle ID","Before creating your app, you need to create a Bundle ID in your Apple Developer account. Follow these steps:",(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to Certificates, Identifiers & Profiles"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Navigate to the Apple Developer portal"}),(0,n.jsx)("a",{href:"https://developer.apple.com/account/resources/identifiers/list",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Open Developer Portal →"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create New Identifier"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Click the "+" button, choose "App IDs" and click Continue'})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Choose App Type"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Choose "App" for the type and click Continue'})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Configure Bundle ID"}),(0,n.jsxs)("p",{className:"text-gray-600 text-sm",children:[(0,n.jsx)("strong",{children:"Description:"})," Enter any app name (customers won't see it)",(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"Bundle ID:"}),' Choose "Explicit" and enter a bundle ID that is unique, in this format: ',(0,n.jsx)("code",{className:"bg-gray-100 px-1 rounded",children:"com.domainname.appname"}),(0,n.jsx)("br",{}),"Click Continue, then Register"]})]})]})]}),(0,n.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,n.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:k,onChange:e=>C(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:k?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:k?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,n.jsx)("span",{className:"text-gray-900",children:"I've created a Bundle ID"})]})})]}),"/mobilepublish/apple_bundle_id.png");case"apple-bundle-id":return e("Enter Your App Bundle ID","This is the bundle identifier that you just created.",(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bundle ID"}),(0,n.jsx)("input",{type:"text",value:H.appleBundleId,onChange:e=>$("appleBundleId",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"com.domainname.appname"})]}),"/mobilepublish/apple_copy_bundle_id.png");case"apple-create-app":return e("Create an App in App Store Connect","Now you need to create a new app in App Store Connect using the Bundle ID you just created. Follow these steps:",(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to App Store Connect"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Navigate to the Apps section"}),(0,n.jsx)("a",{href:"https://appstoreconnect.apple.com/apps",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Open App Store Connect →"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create New App"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Click the "+" button, then select "New App"'})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Configure App Details"}),(0,n.jsxs)("p",{className:"text-gray-600 text-sm",children:[(0,n.jsx)("strong",{children:"Platform:"}),' Choose "iOS"',(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"Name:"})," Enter your app name",(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"Primary Language:"})," Choose your preferred language",(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"Bundle ID:"})," Select the Bundle ID you just created",(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"SKU:"}),' Enter a unique identifier (e.g., "ComDomainNameAppName")']})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create App"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Create" to finish setting up your app'})]})]})]}),(0,n.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,n.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:S,onChange:e=>E(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:S?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:S?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,n.jsx)("span",{className:"text-gray-900",children:"I've created an app in App Store Connect"})]})})]}),"/mobilepublish/apple_new_app.png");case"apple-app-id":return e("Enter Your Apple App ID","This is the unique identifier for your app in the App Store. You can find this in the app you just created.",(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"App ID"}),(0,n.jsx)("input",{type:"text",value:H.appleAppId,onChange:e=>$("appleAppId",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"1234567890"}),(0,n.jsx)("p",{className:"text-gray-600 text-xs mt-1",children:'In App Store Connect, click on the app you just created, then click the "App Information" tab, and scroll down to find the "Apple ID" value'})]}),"/mobilepublish/apple_app_id.png");case"google-create-app":return e("Create a New App in Google Play Console","Now you need to create a new app in Google Play Console. Follow these steps:",(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to Google Play Console"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Navigate to the Google Play Console"}),(0,n.jsx)("a",{href:"https://play.google.com/console/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Open Google Play Console →"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create App"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Create app" and fill in the required details'})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Configure App Details"}),(0,n.jsxs)("p",{className:"text-gray-600 text-sm",children:[(0,n.jsx)("strong",{children:"App name:"})," Enter your app name",(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"Default language:"})," Choose your preferred language",(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"App or game:"}),' Choose "App"',(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"Free or paid:"})," Choose based on your preference"]})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create App"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Accept the declarations and click "Create app" to finish the setup'})]})]})]}),(0,n.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,n.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:T,onChange:e=>I(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:T?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:T?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,n.jsx)("span",{className:"text-gray-900",children:"I've created an app in Google Play Console"})]})})]}),"/mobilepublish/google_create_app.png");case"google-create-service-account":return e("Create a Service Account in Google Cloud","You need to create a service account in Google Cloud Console to access the Google Play API. Follow these steps:",(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to Google Cloud Console"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Navigate to IAM & Admin → Service Accounts"}),(0,n.jsx)("a",{href:"https://console.cloud.google.com/iam-admin/serviceaccounts",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Open Google Cloud Console →"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create Service Account"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Create Service Account"'})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Configure Service Account"}),(0,n.jsxs)("p",{className:"text-gray-600 text-sm",children:[(0,n.jsx)("strong",{children:"Service account name:"})," Enter a descriptive name",(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"Service account ID:"})," Will be auto-generated",(0,n.jsx)("br",{}),(0,n.jsx)("strong",{children:"Description:"})," Optional description"]})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create Account"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Create and Continue" (skip the optional steps)'})]})]})]}),(0,n.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,n.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:A,onChange:e=>D(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:A?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:A?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,n.jsx)("span",{className:"text-gray-900",children:"I've created a service account in Google Cloud"})]})})]}),"/mobilepublish/google_create_service_account.png");case"google-create-service-key":return e("Create a Key for the Service Account","Now you need to create a JSON key for the service account you just created. Follow these steps:",(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Click On Your Service Account"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"In the service accounts list, click on the service account you just created"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to Keys Tab"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Click on the "Keys" tab'})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Add Key"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Add Key" → "Create new key"'})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Download JSON Key"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Choose "JSON" as the key type and click "Create". The JSON file will download automatically.'})]})]})]}),(0,n.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,n.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:P,onChange:e=>M(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:P?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:P?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,n.jsx)("span",{className:"text-gray-900",children:"I've created and downloaded the JSON key"})]})})]}),"/mobilepublish/google_create_service_key.png");case"google-service-account":return e("Upload Your Google Service Account JSON","Upload the JSON file you just downloaded. This file allows us to authenticate with Google Play Console to submit your Android app.",(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Google Service Account JSON"}),(0,n.jsx)("input",{type:"file",accept:".json",onChange:e=>{var t;return J("googleServiceAccount",(null===(t=e.target.files)||void 0===t?void 0:t[0])||null)},className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}));case"google-add-service-account":return e("Add Service Account to Google Play","Now you need to add the service account to your Google Play Console app with the proper permissions.",(0,n.jsxs)("div",{className:"space-y-6",children:[H.googleServiceAccount&&(0,n.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,n.jsx)("h4",{className:"text-blue-900 font-medium mb-2",children:"Service Account Email"}),F?(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("p",{className:"text-blue-800 text-sm font-mono break-all bg-white px-3 py-2 rounded border flex-1",children:F}),(0,n.jsxs)("button",{onClick:()=>{navigator.clipboard.writeText(F),v.Ay.success("Email copied to clipboard!")},className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded text-sm font-medium transition-colors flex items-center space-x-1",title:"Copy to clipboard",children:[(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),(0,n.jsx)("span",{children:"Copy"})]})]}),(0,n.jsx)("p",{className:"text-blue-700 text-xs mt-1",children:"Copy this email address for the next steps"})]}):(0,n.jsx)("p",{className:"text-blue-800 text-sm",children:'Reading email from JSON file... If this doesn\'t appear, you can open the JSON file in a text editor to find the "client_email" field.'})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to Google Play Console"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Navigate to your app in Google Play Console"}),(0,n.jsx)("a",{href:"https://play.google.com/console/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Open Google Play Console →"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to Users and Permissions"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'In the left sidebar, click "Users and permissions"'})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Invite New User"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Invite new users" and paste the service account email above'})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Set App Permissions"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Under "App permissions", select your app and choose "Admin (all permissions)" for that app'})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"5"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Send Invitation"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Send invitation" to complete the setup'})]})]})]}),!H.googleServiceAccount&&(0,n.jsx)("div",{className:"text-gray-600 text-sm",children:"Please upload your Google Service Account JSON file in the previous step first."}),(0,n.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,n.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,n.jsx)("div",{children:(0,n.jsx)("input",{type:"checkbox",checked:L,onChange:e=>O(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:L?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:L?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}})}),(0,n.jsx)("span",{className:"text-gray-900",children:"I've invited the above service account email to Google Play Console, giving it admin permissions for my app"})]})})]}),"/mobilepublish/google_add_service_account.png");case"review":return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Review Configuration"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"Please review your configuration before publishing."})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium mb-2",children:"Expo"}),(0,n.jsxs)("p",{className:"text-gray-700 text-sm",children:["Owner: ",H.expoProjectOwner]}),(0,n.jsxs)("p",{className:"text-gray-700 text-sm",children:["Slug: ",H.expoProjectSlug]}),(0,n.jsxs)("p",{className:"text-gray-700 text-sm",children:["Project ID: ",H.expoProjectId]}),(0,n.jsxs)("p",{className:"text-gray-700 text-sm",children:["Token: ",H.expoAccessToken?"••••••••":"Not set"]})]}),(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium mb-2",children:"Apple App Store"}),(0,n.jsxs)("p",{className:"text-gray-700 text-sm",children:["Bundle ID: ",H.appleBundleId]}),(0,n.jsxs)("p",{className:"text-gray-700 text-sm",children:["App ID: ",H.appleAppId]}),(0,n.jsxs)("p",{className:"text-gray-700 text-sm",children:["P8 File: ",H.appleP8File?H.appleP8File.name:"Not uploaded"]})]}),(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium mb-2",children:"Google Play Store"}),(0,n.jsx)("p",{className:"text-gray-700 text-sm",children:"Bundle ID: Uses Apple Bundle ID"}),(0,n.jsxs)("p",{className:"text-gray-700 text-sm",children:["Service Account: ",H.googleServiceAccount?H.googleServiceAccount.name:"Not uploaded"]}),(0,n.jsx)("p",{className:"text-gray-700 text-sm",children:"Keystore: Auto-generated"})]})]})]});case"publishing":return(0,n.jsxs)("div",{className:"space-y-6 text-center",children:[(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsxs)("svg",{className:"animate-spin h-12 w-12 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Publishing Your App"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Your app is being prepared for submission to the app stores. This process can take several hours. You'll receive email updates on the progress."})]})]});default:return null}})()}),"publishing"!==o&&(0,n.jsxs)("div",{className:"flex justify-between items-center p-6 border-t border-gray-200",children:[(0,n.jsx)("button",{onClick:()=>{let e=R.indexOf(o);e>0&&i(R[e-1])},disabled:"prerequisites"===o,className:"px-4 py-2 text-gray-600 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed",children:"Back"}),(0,n.jsx)("div",{className:"flex space-x-3",children:Z?(0,n.jsx)("button",{onClick:K,disabled:!Q||W||U,className:"bg-blue-600 text-white font-medium rounded-md px-6 py-2 text-sm transition-colors disabled:opacity-70 disabled:cursor-not-allowed",children:W||U?(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Publishing..."]}):"Submit to App Stores"}):(0,n.jsx)("button",{onClick:()=>{let e=R.indexOf(o);e<R.length-1&&i(R[e+1])},disabled:!Q,className:"bg-blue-600 text-white font-medium rounded-md px-6 py-2 text-sm transition-colors disabled:opacity-70 disabled:cursor-not-allowed",children:"Next"})})]})]})})}function B(e){let{isOpen:t,onClose:s}=e,[r,l]=(0,a.useState)(!1),o=()=>{l(!1),s()};return t?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","data-sentry-component":"MobileFirstUploadModal","data-sentry-source-file":"MobileFirstUploadModal.tsx",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto border border-gray-200 shadow-xl",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Important: First Upload Required"}),(0,n.jsx)("button",{onClick:o,className:"text-gray-500 hover:text-gray-700",children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"MobileFirstUploadModal.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12","data-sentry-element":"path","data-sentry-source-file":"MobileFirstUploadModal.tsx"})})})]}),(0,n.jsx)("div",{className:"p-6",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Manual Upload Required"}),(0,n.jsxs)("p",{className:"text-gray-600 mb-4",children:["Your app has been submitted for building, but the ",(0,n.jsx)("strong",{children:"first submission to Google Play Store will fail"}),". This is normal and expected."]}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"Google Play requires the first upload to be done manually through their console. Here's what you need to do:"})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Wait for Build Completion"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Wait for the build to complete in your Expo dashboard (usually 10-20 minutes)"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Download the .aab File"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Go to your Expo dashboard, find the completed build, and download the Android .aab file"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Upload to Google Play Console"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"In Google Play Console, go to your app → Testing → Internal testing → Create new release, and upload the .aab file"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Future Uploads Will Be Automatic"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"After this first manual upload, all future submissions will work automatically through our system"})]})]})]})]}),(0,n.jsx)("div",{className:"space-y-6",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Step-by-Step Screenshots"}),(0,n.jsxs)("div",{className:"space-y-2 mb-6",children:[(0,n.jsx)("h5",{className:"text-md font-medium text-gray-800",children:"Download from Expo Dashboard"}),(0,n.jsx)("div",{className:"w-full h-48 rounded-lg overflow-hidden cursor-pointer hover:opacity-90 transition-opacity",children:(0,n.jsx)("img",{src:"/mobilepublish/expo_download_build.png",alt:"Download build from Expo dashboard",className:"w-full h-full object-contain bg-white border border-gray-200",onClick:()=>window.open("/mobilepublish/expo_download_build.png","_blank"),title:"Click to view full size"})}),(0,n.jsx)("p",{className:"text-center text-xs text-gray-500 cursor-pointer hover:text-gray-700 transition-colors",onClick:()=>window.open("/mobilepublish/expo_download_build.png","_blank"),children:"Click to view full size"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("h5",{className:"text-md font-medium text-gray-800",children:"Upload to Google Play Console"}),(0,n.jsx)("div",{className:"w-full h-48 rounded-lg overflow-hidden cursor-pointer hover:opacity-90 transition-opacity",children:(0,n.jsx)("img",{src:"/mobilepublish/google_upload_build.png",alt:"Upload build to Google Play Console",className:"w-full h-full object-contain bg-white border border-gray-200",onClick:()=>window.open("/mobilepublish/google_upload_build.png","_blank"),title:"Click to view full size"})}),(0,n.jsx)("p",{className:"text-center text-xs text-gray-500 cursor-pointer hover:text-gray-700 transition-colors",onClick:()=>window.open("/mobilepublish/google_upload_build.png","_blank"),children:"Click to view full size"})]})]})})]})}),(0,n.jsxs)("div",{className:"flex justify-between items-center p-6 border-t border-gray-200",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)("input",{type:"checkbox",id:"acknowledge-checkbox",checked:r,onChange:e=>l(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600",style:{backgroundColor:r?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:r?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,n.jsx)("label",{htmlFor:"acknowledge-checkbox",className:"text-gray-900 cursor-pointer",children:"Ok, I understand and will do this manual upload"})]}),(0,n.jsx)("button",{onClick:o,disabled:!r,className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-md px-6 py-2 text-sm transition-colors",children:"Close"})]})]})}):null}function U(e){let{projectId:t,projectSlug:s,projectPlatform:r="website",projectPreview:l,projectBuild:o,onPublish:i,isMobile:c=!1}=e,[u,m]=(0,a.useState)(!1),[g,h]=(0,a.useState)(!1),[x,p]=(0,a.useState)(!1),{isWhitelabel:f,whitelabelConfig:b}=(0,d.p)(),y=async()=>{if(!t)return!1;try{let e=await fetch("/api/projects/".concat(t,"/mobile-publish-config"));if(e.ok)return(await e.json()).hasConfiguration}catch(e){console.error("Error checking mobile publish config:",e)}return!1},j=async()=>{if("mobile"===r){if(!await y()){h(!0);return}m(!0);try{let e=await fetch("/api/projects/mobile-publish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:t})});if(429===e.status){let t=(await e.json()).message||"Rate limit exceeded. Please try again later.";throw Error(t)}if(!e.ok)throw Error("Failed to publish app");v.Ay.success("App submitted to app stores! It can take several minutes to show in app store drafts.",{duration:6e3})}catch(e){console.error("Publish error:",e),v.Ay.error(e.message||"Failed to start publishing process")}finally{m(!1)}}else if(i){m(!0);try{await i()}catch(e){console.error("Publish error:",e)}finally{m(!1)}}},w="mobile"!==r&&!!(o&&l&&o===l),N=()=>u?c?null:"Publishing...":w?"Published":"Publish";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:j,disabled:u||w,className:"".concat(w?"bg-gray-600 text-gray-300":f?"text-white":"bg-blue-600 text-white hover:bg-blue-700"," font-medium rounded-md px-4 py-1.5 text-sm transition-colors ").concat(w?"cursor-not-allowed":""),style:{backgroundColor:!w&&f&&(null==b?void 0:b.tertiaryColor)?b.tertiaryColor:void 0},children:u?(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("svg",{className:"animate-spin ".concat(c?"h-5 w-5":"-ml-1 mr-2 h-4 w-4"),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),N()]}):N()}),t&&(0,n.jsx)(F,{isOpen:g,onClose:()=>h(!1),projectId:t,onPublishSuccess:()=>{h(!1),p(!0)}}),(0,n.jsx)(B,{isOpen:x,onClose:()=>p(!1),"data-sentry-element":"MobileFirstUploadModal","data-sentry-source-file":"PublishButton.tsx"})]})}function z(e){let{isOpen:t,onClose:s,projectExpoPreviewProjectId:r,isMobile:l,projectStatus:o,projectId:i,onGeneratePreview:c}=e,[d,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(t){let e=document.body.style.paddingRight,t=document.body.style.overflow;return document.body.style.paddingRight="0",()=>{document.body.style.paddingRight=e,document.body.style.overflow=t}}},[t]),(0,a.useEffect)(()=>{d&&r&&(u(!1),v.Ay.success("App preview is ready!",{duration:3e3}))},[d,r]);let m=async()=>{if(i){u(!0);try{let e=await fetch("/api/projects/mobile-preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:i})});if(429===e.status){let t=(await e.json()).message||"Rate limit exceeded. Please try again later.";throw Error(t)}if(!e.ok)throw Error("Failed to generate app preview");c&&await c()}catch(e){console.error("Preview generation error:",e),v.Ay.error(e.message||"Failed to start preview generation"),u(!1)}}};return t?(0,n.jsx)("div",{className:"fixed bg-black bg-opacity-80 flex items-center justify-center z-50",style:{top:"-50px",left:"-50px",right:"-50px",bottom:"-50px",margin:0,padding:"50px"},onClick:s,"data-sentry-component":"QRCodeModal","data-sentry-source-file":"QRCodeModal.tsx",children:(0,n.jsxs)("div",{className:"bg-gray-900 rounded-lg max-w-md w-full p-6 border border-gray-800",onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h3",{className:"text-xl text-white font-semibold",children:"Preview on Device"}),(0,n.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-white",children:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"QRCodeModal.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12","data-sentry-element":"path","data-sentry-source-file":"QRCodeModal.tsx"})})})]}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsxs)("div",{className:"flex items-center mb-2",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center mr-2",children:"1"}),(0,n.jsx)("h4",{className:"text-white font-medium",children:"Get the Expo Go app"})]}),(0,n.jsx)("p",{className:"text-gray-300 text-sm mb-3 pl-7",children:"Download Expo Go on your mobile device."}),(0,n.jsxs)("div",{className:"flex space-x-3 justify-center pl-7",children:[(0,n.jsx)("a",{href:"https://apps.apple.com/app/apple-store/id982107779",target:"_blank",rel:"noopener noreferrer",className:"inline-block",children:(0,n.jsx)("div",{className:"h-[40px] flex items-center",children:(0,n.jsx)("img",{src:"/apple_app_store.svg",alt:"Download on the App Store",className:"h-full"})})}),(0,n.jsx)("a",{href:"https://play.google.com/store/apps/details?id=host.exp.exponent",target:"_blank",rel:"noopener noreferrer",className:"inline-block",children:(0,n.jsx)("div",{className:"relative -top-0 h-[40px] w-36 flex items-center justify-center",children:(0,n.jsx)("img",{src:"/google_play_store.svg",alt:"Get it on Google Play",className:"w-32"})})})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center mb-2",children:[(0,n.jsx)("div",{className:"bg-blue-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center mr-2",children:"2"}),(0,n.jsx)("h4",{className:"text-white font-medium",children:r?l?"Open the preview":"Scan the QR code":"Generate App Preview"})]}),r?l?(0,n.jsxs)("div",{className:"pl-7",children:[(0,n.jsx)("p",{className:"text-gray-300 text-sm mb-3",children:"Once you have Expo Go installed, tap the button below to open the preview. This preview will remain active for 6 hours."}),(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsxs)("a",{href:"exp://u.expo.dev/".concat(r,"?runtime-version=exposdk%3A54.0.0&channel-name=preview"),className:"bg-blue-600 text-white font-medium rounded-md px-6 py-3 text-sm transition-colors hover:bg-blue-700 flex items-center",children:[(0,n.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Open in Expo Go"]})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-gray-300 text-sm mb-3 pl-7",children:"Scan this QR code with your device's camera. This QR code will remain active for 6 hours."}),(0,n.jsx)("div",{className:"flex flex-col items-center justify-center bg-white p-4 rounded-lg",children:(0,n.jsx)("img",{src:"https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=".concat(encodeURIComponent("exp://u.expo.dev/".concat(r,"?runtime-version=exposdk%3A54.0.0&channel-name=preview"))),alt:"QR Code for Expo Preview",width:200,height:200})})]}):(0,n.jsxs)("div",{className:"pl-7",children:[(0,n.jsxs)("p",{className:"text-gray-300 text-sm mb-3",children:["Generate a preview of your app to ",l?"open with Expo Go":"scan with Expo Go",". ","building"===o||"answering"===o?"":"It takes about 2 minutes to generate."]}),(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)("button",{onClick:m,disabled:d||"building"===o||"answering"===o,className:"bg-blue-600 text-white font-medium rounded-md px-6 py-3 text-sm transition-colors hover:bg-blue-700 flex items-center disabled:opacity-70 disabled:cursor-not-allowed",children:d||"building"===o||"answering"===o?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[(0,n.jsx)("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),(0,n.jsx)("path",{d:"M21 3v5h-5"}),(0,n.jsx)("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),(0,n.jsx)("path",{d:"M8 16H3v5"})]}),"Generate Preview"]})})})]})]}),r&&(0,n.jsx)("div",{className:"mt-4 border-gray-800",children:(0,n.jsxs)("p",{className:"text-gray-400 text-xs italic text-center",children:[(0,n.jsx)("svg",{className:"inline-block w-4 h-4 mr-1 mb-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"For continued updates, force quit the Expo Go app on your device and"," ",l?"tap the button":"scan the QR code"," ","again."]})})]})}):null}function W(e){let{isMobile:t,mobileActiveTab:s,projectPreview:r,projectPlatform:l,projectExpoPreviewProjectId:o,projectStatus:i,projectId:c,onGeneratePreview:u}=e,[m,g]=(0,a.useState)(!1),{isWhitelabel:h,whitelabelConfig:x}=(0,d.p)();return r&&"mobile"===l&&(!t||t&&"preview"===s)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{onClick:()=>g(!0),className:"".concat(!h&&"bg-gray-800"," text-gray-400 hover:text-white ").concat(t?"p-1.5":"py-1.5 px-4"," rounded-md transition-colors flex items-center space-x-1 text-sm font-medium"),style:{backgroundColor:h&&(null==x?void 0:x.secondaryColor)||void 0},title:"Preview on device with QR code",children:[(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","data-sentry-element":"svg","data-sentry-source-file":"DeviceButton.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z","data-sentry-element":"path","data-sentry-source-file":"DeviceButton.tsx"})}),!t&&(0,n.jsx)("span",{className:"hidden sm:inline",children:"Device"})]}),(0,n.jsx)(z,{isOpen:m,onClose:()=>g(!1),projectExpoPreviewProjectId:o,isMobile:t,projectStatus:i,projectId:c,onGeneratePreview:u,"data-sentry-element":"QRCodeModal","data-sentry-source-file":"DeviceButton.tsx"})]}):null}var _=s(75843),H=s(5193);function G(e){let{isOpen:t,onClose:s,pendingContracts:r,onContractsDeployed:l,onTryToFixIt:o}=e,[i,c]=(0,a.useState)(1),[d,u]=(0,a.useState)(!1),[m,g]=(0,a.useState)(""),[h,x]=(0,a.useState)(!1),[p,f]=(0,a.useState)([]),[b,y]=(0,a.useState)([]),v=void 0!==window.ethereum,j=async()=>{if(!v){y(["Metamask is not installed. Please install it first."]);return}try{let e=new _.k(window.ethereum);await e.send("eth_requestAccounts",[]);let t=await e.getSigner(),s=await t.getAddress();g(s),u(!0),c(3),y([])}catch(e){console.error("Error connecting to Metamask:",e),y(["Failed to connect to Metamask: ".concat(e.message||"Unknown error")])}},w=async()=>{if(!d||0===r.length)return;x(!0),y([]);let e=[],t=[];try{let n=new _.k(window.ethereum),a=await n.getSigner(),o=await n.getNetwork(),i=Number(o.chainId);for(let n of(console.log("Deploying to network ID: ".concat(i)),r))try{var s;console.log("Deploying contract: ".concat(n.filename));let r=await fetch("/api/projects/artifact?url=".concat(encodeURIComponent(n.artifactUrl)));if(!r.ok){let e=await r.json().catch(()=>({error:"Unknown error"}));throw Error("Could not fetch artifact: ".concat(e.error||r.statusText))}let l=await r.json(),o=new H.P(l.abi,l.bytecode,a),c=await o.deploy();console.log("Transaction hash for ".concat(n.filename,":"),null===(s=c.deploymentTransaction())||void 0===s?void 0:s.hash),await c.waitForDeployment();let d=await c.getAddress();console.log("Contract ".concat(n.filename," deployed at:"),d),e.push("".concat(n.filename,": ").concat(d)),t.push({filename:n.filename,address:d,networkId:i})}catch(e){console.error("Error deploying ".concat(n.filename,":"),e),y(t=>[...t,"Failed to deploy ".concat(n.filename,": ").concat(e.message||"Unknown error")])}if(t.length>0)try{if(!(await fetch("/api/projects/contract",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:new URLSearchParams(window.location.search).get("id")||window.location.pathname.split("/")[2],contracts:t})})).ok)throw Error("Failed to update contract addresses");console.log("Successfully updated contract addresses in database"),l&&l()}catch(e){console.error("Error updating contract addresses:",e),y(t=>[...t,"Failed to save contract addresses: ".concat(e.message||"Unknown error")])}f(e)}catch(e){console.error("Error during deployment:",e),y(t=>[...t,"Deployment failed: ".concat(e.message||"Unknown error")])}finally{x(!1)}};return t?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:9999},"data-sentry-component":"PendingContractsModal","data-sentry-source-file":"PendingContractsModal.tsx",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto border border-gray-200 shadow-xl",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Deploy Smart Contracts"}),(0,n.jsx)("button",{onClick:()=>{c(1),u(!1),g(""),x(!1),f([]),y([]),s()},className:"text-gray-500 hover:text-gray-700",children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"PendingContractsModal.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12","data-sentry-element":"path","data-sentry-source-file":"PendingContractsModal.tsx"})})})]}),(0,n.jsx)("div",{className:"p-6",children:(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("div",{children:(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"Your app includes smart contracts that need to be deployed to the blockchain. Follow these steps to deploy them:"})}),b.length>0&&(0,n.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsx)("h4",{className:"text-red-800 font-medium",children:"Errors:"}),o&&(0,n.jsx)("button",{onClick:()=>{o&&b.length>0&&(o(b.slice(0,5).map((e,t)=>"Error ".concat(t+1,": ").concat(e)).join("\n\n")),s())},className:"px-3 py-1 text-sm font-medium bg-white hover:bg-gray-50 text-gray-800 border border-gray-300 rounded transition-colors",children:"Try to fix it"})]}),(0,n.jsx)("ul",{className:"text-red-700 text-sm space-y-1",children:b.map((e,t)=>(0,n.jsxs)("li",{children:["• ",e]},t))})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"".concat(i>=1?"bg-blue-600":"bg-gray-300"," text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0"),children:v?"✓":"1"}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Install Metamask"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm mb-2",children:v?"Metamask is installed!":"You need Metamask to deploy smart contracts."}),!v&&(0,n.jsxs)("a",{href:"https://metamask.io/download/",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-orange-600 text-white text-sm font-medium rounded-md hover:bg-orange-700 transition-colors",children:["Install Metamask",(0,n.jsx)("svg",{className:"ml-2 w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"".concat(i>=2?"bg-blue-600":"bg-gray-300"," text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0"),children:d?"✓":"2"}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Connect Metamask"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm mb-2",children:d?"Connected: ".concat(m.slice(0,6),"...").concat(m.slice(-4)):"Connect your Metamask wallet to continue."}),v&&!d&&(0,n.jsx)("button",{onClick:j,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors",children:"Connect Metamask"})]})]}),(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("div",{className:"".concat(i>=3?"bg-blue-600":"bg-gray-300"," text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0"),children:p.length===r.length&&r.length>0?"✓":"3"}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h4",{className:"text-gray-900 font-medium",children:"Deploy Smart Contracts"}),(0,n.jsxs)("p",{className:"text-gray-600 text-sm mb-2",children:["Deploy ",r.length," smart contract",1!==r.length?"s":""," to the blockchain."]}),(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[(0,n.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Contracts to deploy:"}),(0,n.jsx)("ul",{className:"text-sm text-gray-600 space-y-1",children:r.map((e,t)=>(0,n.jsxs)("li",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"w-2 h-2 bg-gray-400 rounded-full mr-2"}),e.filename]},t))})]}),d&&(0,n.jsx)("button",{onClick:w,disabled:h,className:"inline-flex items-center px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deploying..."]}):"Deploy Contracts"})]})]})]}),p.length>0&&(0,n.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,n.jsx)("h4",{className:"text-green-800 font-medium mb-2",children:"Successfully Deployed:"}),(0,n.jsx)("ul",{className:"text-green-700 text-sm space-y-1",children:p.map((e,t)=>(0,n.jsxs)("li",{children:["• ",e]},t))}),p.length===r.length&&(0,n.jsx)("div",{className:"mt-3 pt-3 border-t border-green-200",children:(0,n.jsx)("p",{className:"text-green-800 text-sm font-medium",children:"All contracts deployed successfully! You can now close this modal."})})]})]})})]})}):null}function V(e){let{isOpen:t,onClose:s,projectContracts:r=[],onContractsDeployed:l,onTryToFixIt:o}=e,[i,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!1),[m,g]=(0,a.useState)([]);if(!t)return null;let h=r.filter(e=>e.artifactUrl),x=async e=>{try{await navigator.clipboard.writeText(e),c(e),v.Ay.success("Address copied to clipboard"),setTimeout(()=>{c(null)},2e3)}catch(e){console.error("Failed to copy address: ",e),v.Ay.error("Failed to copy address")}},p=e=>{g([e]),u(!0)},f=()=>{u(!1),g([]),l&&l()};return(0,n.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50","data-sentry-component":"SmartContractsModal","data-sentry-source-file":"SmartContractsModal.tsx",children:[(0,n.jsxs)("div",{className:"bg-gray-900 rounded-lg max-w-2xl w-full p-6 border border-gray-800 max-h-[80vh] overflow-y-auto",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("h3",{className:"text-xl text-white font-semibold",children:"Smart Contracts"}),(0,n.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-white",children:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"SmartContractsModal.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12","data-sentry-element":"path","data-sentry-source-file":"SmartContractsModal.tsx"})})})]}),0===h.length?(0,n.jsxs)("div",{className:"text-center py-8",children:[(0,n.jsx)("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,n.jsx)("p",{className:"text-gray-400 text-sm",children:"No smart contracts found for this project."})]}):(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("p",{className:"text-gray-300 text-sm",children:"Below are the smart contracts associated with this project:"}),h.length>0&&(0,n.jsx)("button",{onClick:()=>{g(h),u(!0)},className:"inline-flex items-center px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded transition-colors",children:"Redeploy All"})]}),h.map((e,t)=>(0,n.jsx)("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center mb-2",children:[(0,n.jsx)("svg",{className:"w-5 h-5 text-blue-400 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,n.jsx)("h4",{className:"text-white font-medium text-sm",children:e.filename})]}),(0,n.jsxs)("div",{className:"flex md:flex-row flex-col md:items-center",children:[(0,n.jsx)("span",{className:"text-gray-400 text-xs mr-2",children:"Contract Address:"}),e.actualAddress?(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("code",{className:"text-white text-xs font-mono break-all",children:e.actualAddress}),(0,n.jsx)("button",{onClick:()=>x(e.actualAddress),className:"ml-2 text-gray-400 hover:text-white p-1",title:i===e.actualAddress?"Copied!":"Copy address",children:i===e.actualAddress?(0,n.jsx)("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}):(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("span",{className:"text-gray-500 text-xs italic",children:"(pending)"}),(0,n.jsx)("button",{onClick:()=>p(e),className:"inline-flex items-center px-2 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium rounded transition-colors",children:"Deploy"})]})]})]})},t))]})]}),(0,n.jsx)(G,{isOpen:d,onClose:()=>{u(!1),g([])},pendingContracts:m,onContractsDeployed:()=>{f(),u(!1),s()},onTryToFixIt:e=>{o&&o(e),s()},"data-sentry-element":"PendingContractsModal","data-sentry-source-file":"SmartContractsModal.tsx"})]})}function J(e){let{isMobile:t,projectPreview:s,projectPlatform:r,projectContracts:l,projectId:o,onContractsDeployed:i,onTryToFixIt:c}=e,[u,m]=(0,a.useState)(!1),{isWhitelabel:g,whitelabelConfig:h}=(0,d.p)();return s&&"crypto"===r&&l&&l.length>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{onClick:()=>m(!0),className:"".concat(!g&&"bg-gray-800"," text-gray-400 hover:text-white ").concat(t?"p-1.5":"py-1.5 px-4"," rounded-md transition-colors flex items-center space-x-1 text-sm"),style:{backgroundColor:g&&(null==h?void 0:h.secondaryColor)||void 0},title:"Show project smart contracts",children:[(0,n.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,"data-sentry-element":"svg","data-sentry-source-file":"ContractsButton.tsx",children:[(0,n.jsx)("path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4","data-sentry-element":"path","data-sentry-source-file":"ContractsButton.tsx"}),(0,n.jsx)("path",{d:"M14 2v4a2 2 0 0 0 2 2h4","data-sentry-element":"path","data-sentry-source-file":"ContractsButton.tsx"}),(0,n.jsx)("rect",{width:"4",height:"6",x:"2",y:"12",rx:"2","data-sentry-element":"rect","data-sentry-source-file":"ContractsButton.tsx"}),(0,n.jsx)("path",{d:"M10 12h2v6","data-sentry-element":"path","data-sentry-source-file":"ContractsButton.tsx"}),(0,n.jsx)("path",{d:"M10 18h4","data-sentry-element":"path","data-sentry-source-file":"ContractsButton.tsx"})]}),!t&&(0,n.jsx)("span",{className:"hidden sm:inline",children:"Contracts"})]}),(0,n.jsx)(V,{isOpen:u,onClose:()=>m(!1),projectContracts:l,projectId:o,onContractsDeployed:i,onTryToFixIt:c,"data-sentry-element":"SmartContractsModal","data-sentry-source-file":"ContractsButton.tsx"})]}):null}function $(e){let{activeView:t,mobileActiveTab:s,isMobile:r,setActiveView:l,projectSlug:o,projectId:i,projectPreview:u,projectBuild:m,projectPlatform:g,projectStatus:x,onPublish:f,onGeneratePreview:b,userSubscription:y,domains:v=[],projectExpoPreviewProjectId:j,onSubscriptionClick:w,projectContracts:N,projectSupabaseProjectId:k,projectIsInternalDatabase:C,projectStripeAccountId:S,onContractsDeployed:E,onTryToFixIt:T,onSaveAllChanges:I}=e,R=h(e=>e.projectId)||i,[F,B]=(0,a.useState)(!1),{isWhitelabel:z,whitelabelConfig:_}=(0,d.p)();return(0,a.useEffect)(()=>{document.documentElement.classList.add("dark"),localStorage.setItem("darkMode","true")},[]),(0,n.jsxs)(n.Fragment,{children:[F&&(0,n.jsx)("div",{className:"fixed inset-0 w-full h-full z-20",onClick:()=>{B(!1)}}),(0,n.jsx)("header",{className:"".concat(!z&&"bg-gray-900"," py-1 relative z-30"),style:{backgroundColor:z&&(null==_?void 0:_.primaryColor)||void 0},children:(0,n.jsx)("div",{className:"max-w-full mx-auto px-2 sm:px-4 py-0",children:(0,n.jsxs)("div",{className:"flex justify-between h-12 items-center",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[z?(0,n.jsx)(c(),{href:(null==_?void 0:_.homepageEnabled)===!0?"/":"/dashboard",className:"flex items-center",children:(0,n.jsxs)("div",{className:"flex items-center justify-center wl-hook-sidebar-logo-container",children:[(null==_?void 0:_.logo)&&(0,n.jsx)("img",{className:"wl-hook-sidebar-logo",src:_.logo,alt:(null==_?void 0:_.siteName)||"Platform",width:30}),_&&!(null==_?void 0:_.logo)&&(null==_?void 0:_.siteName)&&(0,n.jsx)("div",{className:"wl-hook-sitename-text text-white text-2xl font-bold",children:_.siteName})]})}):(0,n.jsx)(c(),{href:"/",className:"flex items-center",children:(0,n.jsx)("div",{className:"flex items-center justify-center wl-hook-sidebar-logo-container",children:(0,n.jsx)("img",{src:"/logo_tp.png",alt:"Famous.ai",width:30,className:"brightness-0 invert wl-hook-sidebar-logo"})})}),(0,n.jsx)(p,{projectSlug:o,projectId:R,userSubscription:y,onSubscriptionClick:w,showNavDropdown:F,setShowNavDropdown:B,"data-sentry-element":"ProjectNavDropdown","data-sentry-source-file":"Header.tsx"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[(0,n.jsx)(M,{projectId:R,isMobile:r,"data-sentry-element":"SettingsButton","data-sentry-source-file":"Header.tsx"}),S&&!r&&(0,n.jsx)(L,{projectId:R,isMobile:r}),k&&C&&!r&&(0,n.jsx)(O,{projectId:R,isMobile:r}),!r&&(0,n.jsx)(A,{onSaveAllChanges:I}),v&&v.length>0?(0,n.jsx)(P,{projectSlug:o,domains:v,isMobile:r,projectPlatform:g,projectPreview:u,projectBuild:m}):(0,n.jsx)(D,{projectSlug:o,isMobile:r,projectPlatform:g,projectPreview:u,projectBuild:m}),(0,n.jsx)(W,{isMobile:r,mobileActiveTab:s,projectPreview:u,projectPlatform:g,projectExpoPreviewProjectId:j,projectStatus:x,projectId:R,onGeneratePreview:b,"data-sentry-element":"DeviceButton","data-sentry-source-file":"Header.tsx"}),(0,n.jsx)(J,{isMobile:r,projectPreview:u,projectPlatform:g,projectContracts:N,projectId:R,onContractsDeployed:E,onTryToFixIt:T,"data-sentry-element":"ContractsButton","data-sentry-source-file":"Header.tsx"}),(0,n.jsx)(U,{isMobile:r,projectId:R,projectSlug:o,projectPlatform:g,projectPreview:u,projectBuild:m,onPublish:f,"data-sentry-element":"PublishButton","data-sentry-source-file":"Header.tsx"})]})]})})})]})}class q{static parseClass(e){let t,s,n;let a=e,r=e.match(/^(sm|md|lg|xl|2xl):/);for(let n of(r&&(t=r[1],a=e.substring(r[0].length)),this.PSEUDO_PREFIXES)){let e=new RegExp("^".concat(n,":"));if(a.match(e)){s=n,a=a.substring(n.length+1);break}}let l="unknown",o=a;if(a.match(/^p([tlrbxy])?-/)){l="padding";let e=a.match(/^p([tlrbxy])?-(.+)$/);e&&(n=e[1],o=e[2])}else if(a.match(/^-?m([tlrbxy])?-/)){l="margin";let e=a.match(/^(-?)m([tlrbxy])?-(.+)$/);e&&(n=e[2],o=(e[1]||"")+e[3])}else for(let[e,t]of Object.entries(this.CATEGORIES))if(a.match(t)){if(l=e,"textColor"===e||"bgColor"===e){let e=a.match(/-((?:[a-z]+-)?\d{2,3}|black|white|transparent|current|inherit)$/);o=e?e[1]:a}else if("textSize"===e)o=a.replace("text-","");else if("borderWidth"===e||"borderColor"===e||"borderRadius"===e){let e=a.split("-");e.length>2?(n=e[1],o=e.slice(2).join("-")):o=e[1]||"default"}break}return{raw:e,category:l,value:o,modifier:t,pseudo:s,specificity:n}}static conflicts(e,t){return e.category===t.category&&e.modifier===t.modifier&&e.pseudo===t.pseudo&&("padding"!==e.category&&"margin"!==e.category||this.spacingConflicts(e.specificity,t.specificity))}static spacingConflicts(e,t){if(e===t||!e||!t)return!0;let s=this.getAffectedSides(e),n=this.getAffectedSides(t);return s.some(e=>n.includes(e))}static getAffectedSides(e){switch(e){case"t":return["top"];case"r":return["right"];case"b":return["bottom"];case"l":return["left"];case"x":return["left","right"];case"y":return["top","bottom"];default:return["top","right","bottom","left"]}}static mergeClasses(e,t){let s=e.map(e=>this.parseClass(e));for(let e of t){let t=this.parseClass(e),n=s.filter(e=>!this.conflicts(e,t));s.length=0,s.push(...n,t)}return s.map(e=>e.raw)}static extractManagedClasses(e){return e.filter(e=>"unknown"!==this.parseClass(e).category)}static extractUnmanagedClasses(e){return e.filter(e=>"unknown"===this.parseClass(e).category)}static buildFromState(e,t){let s=[...e.split(/\s+/).filter(e=>e.length>0)];return void 0!==t.textColor&&(s=s.filter(e=>"textColor"!==this.parseClass(e).category),t.textColor&&s.push(t.textColor)),void 0!==t.textSize&&(s=s.filter(e=>"textSize"!==this.parseClass(e).category),t.textSize&&s.push(t.textSize)),void 0!==t.bgColor&&(s=s.filter(e=>"bgColor"!==this.parseClass(e).category),t.bgColor&&s.push(t.bgColor)),void 0!==t.bgImage&&(s=s.filter(e=>"bgImage"!==this.parseClass(e).category),t.bgImage&&s.push(t.bgImage)),void 0!==t.bgSize&&(s=s.filter(e=>"bgSize"!==this.parseClass(e).category),t.bgSize&&s.push(t.bgSize)),void 0!==t.bgPosition&&(s=s.filter(e=>"bgPosition"!==this.parseClass(e).category),t.bgPosition&&s.push(t.bgPosition)),void 0!==t.padding&&(s=s.filter(e=>"padding"!==this.parseClass(e).category),t.padding&&s.push(t.padding)),void 0!==t.margin&&(s=s.filter(e=>"margin"!==this.parseClass(e).category),t.margin&&s.push(t.margin)),void 0!==t.borderWidth&&(s=s.filter(e=>"borderWidth"!==this.parseClass(e).category),t.borderWidth&&s.push(t.borderWidth)),void 0!==t.borderColor&&(s=s.filter(e=>"borderColor"!==this.parseClass(e).category),t.borderColor&&s.push(t.borderColor)),void 0!==t.borderRadius&&(s=s.filter(e=>"borderRadius"!==this.parseClass(e).category),t.borderRadius&&s.push(t.borderRadius)),void 0!==t.shadow&&(s=s.filter(e=>"shadow"!==this.parseClass(e).category),t.shadow&&s.push(t.shadow)),void 0!==t.textAlign&&(s=s.filter(e=>"textAlign"!==this.parseClass(e).category),t.textAlign&&s.push(t.textAlign)),void 0!==t.justify&&(s=s.filter(e=>"justifyContent"!==this.parseClass(e).category),t.justify&&s.push(t.justify)),void 0!==t.alignItems&&(s=s.filter(e=>"alignItems"!==this.parseClass(e).category),t.alignItems&&s.push(t.alignItems)),s.join(" ")}static applyStyleClass(e,t){let s=e.split(/\s+/).filter(e=>e.length>0);return this.mergeClasses(s,[t]).join(" ")}static getStyleValue(e,t){for(let s of e.split(/\s+/).filter(e=>e.length>0))if(this.parseClass(s).category===t)return s}}q.CATEGORIES={textColor:/^text-((?!xs|sm|base|lg|xl|2xl|3xl|4xl|5xl|6xl|7xl|8xl|9xl|left|center|right|justify)[a-z]+(-\d{2,3})?|(black|white|transparent|current|inherit)|\[.+\])$/,textSize:/^text-(xs|sm|base|lg|xl|2xl|3xl|4xl|5xl|6xl|7xl|8xl|9xl)$/,textAlign:/^text-(left|center|right|justify)$/,fontWeight:/^font-(thin|extralight|light|normal|medium|semibold|bold|extrabold|black)$/,fontStyle:/^(italic|not-italic)$/,textDecoration:/^(underline|overline|line-through|no-underline)$/,textTransform:/^(uppercase|lowercase|capitalize|normal-case)$/,lineHeight:/^leading-/,letterSpacing:/^tracking-/,bgColor:/^bg-([a-z]+(-\d{2,3})?|(black|white|transparent|current|inherit)|\[#[0-9a-fA-F]{6}\]|\[rgb\(.+\)\])$/,bgImage:/^bg-\[url\(.+\)\]$|^bg-gradient-/,bgGradient:/^(from|via|to|bg-gradient)-/,bgSize:/^bg-(auto|cover|contain)$/,bgPosition:/^bg-(bottom|center|left|right|top)/,padding:/^p([tlrbxy])?-/,margin:/^-?m([tlrbxy])?-/,gap:/^gap-([xy])?-/,space:/^space-([xy])-/,borderWidth:/^border(-[tlrbxy])?(-\d+)?$/,borderColor:/^border(-[tlrbxy])?-([a-z]+(-\d{2,3})?|(black|white|transparent|current))$/,borderStyle:/^border-(solid|dashed|dotted|double|hidden|none)$/,borderRadius:/^rounded(-[tlrbxy]|-(none|sm|md|lg|xl|2xl|3xl|full))?$/,display:/^(block|inline-block|inline|flex|inline-flex|grid|inline-grid|table|hidden)$/,position:/^(static|fixed|absolute|relative|sticky)$/,flexDirection:/^flex-(row|row-reverse|col|col-reverse)$/,flexWrap:/^flex-(wrap|wrap-reverse|nowrap)$/,justifyContent:/^justify-(normal|start|end|center|between|around|evenly|stretch)$/,alignItems:/^items-(start|end|center|baseline|stretch)$/,alignSelf:/^self-(auto|start|end|center|stretch|baseline)$/,width:/^w-/,height:/^h-/,minWidth:/^min-w-/,minHeight:/^min-h-/,maxWidth:/^max-w-/,maxHeight:/^max-h-/,shadow:/^shadow(-sm|-md|-lg|-xl|-2xl|-inner|-none)?$/,opacity:/^opacity-/,scale:/^scale-([xy])?-/,rotate:/^-?rotate-/,translate:/^-?translate-([xy])-/,skew:/^-?skew-([xy])-/,animation:/^animate-/,transition:/^transition/,duration:/^duration-/,ease:/^ease-/,blur:/^blur/,brightness:/^brightness-/,contrast:/^contrast-/,grayscale:/^grayscale/,hueRotate:/^hue-rotate-/,invert:/^invert/,saturate:/^saturate-/,sepia:/^sepia/,cursor:/^cursor-/,overflow:/^overflow-([xy])?-/,zIndex:/^z-/,order:/^order-/},q.RESPONSIVE_PREFIXES=["sm","md","lg","xl","2xl"],q.PSEUDO_PREFIXES=["hover","focus","active","visited","focus-within","focus-visible","disabled","checked","indeterminate","default","required","valid","invalid","in-range","out-of-range","placeholder-shown","autofill","read-only","first","last","odd","even","first-of-type","last-of-type","only-of-type","empty","target","before","after","placeholder","file","marker","selection","first-letter","first-line","backdrop","dark","rtl","ltr","open"];var X=s(78992),Y=s(21303);let K=async e=>{let t={},s={...e};for(let[n,a]of(Math.random().toString(36).substring(7),Object.entries(e)))if((n.startsWith("/")?n.slice(1):n).match(/\.(jsx|tsx)$/)&&a&&a.includes("<")&&(a.includes("/>")||a.includes("</")))try{let e=w.parse(a,{sourceType:"module",plugins:["jsx","typescript","decorators-legacy","classProperties","optionalChaining","nullishCoalescingOperator","exportDefaultFrom","exportNamespaceFrom","dynamicImport"]}),r=!1,l=e=>{var t,s;let n=e.parentPath,a=0,r=(null===(s=e.node.openingElement)||void 0===s?void 0:null===(t=s.name)||void 0===t?void 0:t.name)||"unknown",l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("  ".repeat(t),!e)return!1;if(k.isMemberExpression(e))return!0;if(k.isLogicalExpression(e)){let s=l(e.left,t+1),n=l(e.right,t+1);return s||n}return k.isCallExpression(e)?e.arguments.some((e,s)=>l(e,t+1)):k.isConditionalExpression(e)?l(e.test,t+1)||l(e.consequent,t+1)||l(e.alternate,t+1):!!k.isBinaryExpression(e)&&(l(e.left,t+1)||l(e.right,t+1))},o=e.node,i=!1;if(o.children.forEach((e,t)=>{if(k.isJSXExpressionContainer(e)){let t=e.expression;l(t)&&(i=!0,console.log("\uD83D\uDD0D [DYNAMIC-DETECT] Element <".concat(r,"> has prop member expression (e.g., {item.prop})")))}}),i)return console.log("\uD83D\uDD0D [DYNAMIC-DETECT] Marking <".concat(r,"> as DYNAMIC due to prop expressions")),!0;for(;n;){let e=n.node;if(a++,k.isCallExpression(e)&&k.isMemberExpression(e.callee)&&k.isIdentifier(e.callee.property)&&"map"===e.callee.property.name)return console.log("\uD83D\uDD0D [DYNAMIC-DETECT] Element <".concat(r,"> is inside .map() at depth ").concat(a)),!0;if(k.isCallExpression(e)&&k.isMemberExpression(e.callee)&&k.isIdentifier(e.callee.property)&&e.callee.property.name,k.isCallExpression(e)&&k.isMemberExpression(e.callee)&&k.isIdentifier(e.callee.property)&&"filter"===e.callee.property.name||k.isConditionalExpression(e)||k.isLogicalExpression(e))return!0;n=n.parentPath}return!1},o=0;if((0,N.default)(e,{JSXElement(e){var s,a,i,c,d,u,m,g;let h,x;o++;let p=e.node,f=p.openingElement,b="unknown";k.isJSXIdentifier(f.name)&&(b=f.name.name);let y=f.attributes.find(e=>{var t;return k.isJSXAttribute(e)&&(null===(t=e.name)||void 0===t?void 0:t.name)==="data-editor-uid"}),v=!1,j="",w=!1,N=!1,C=!1;p.children.forEach((e,t)=>{if(k.isJSXElement(e))w=!0;else if(k.isJSXExpressionContainer(e)){let t=e.expression;if(k.isCallExpression(t)&&k.isMemberExpression(t.callee)){let e=t.callee.property;if(k.isIdentifier(e)&&["map","filter"].includes(e.name)){w=!0;return}}v=!0,C=!0,j||(k.isStringLiteral(t)?j=t.value:k.isIdentifier(t)?j="{".concat(t.name,"}"):(k.isMemberExpression(t),j="{expression}"))}else if(k.isJSXText(e)){let t=e.value.trim();t&&t.length>0&&(N=!0,v=!0,j||(j=t))}});let S="img"===b.toLowerCase(),E=!1;if(S){let e=f.attributes.find(e=>{var t;return k.isJSXAttribute(e)&&(null===(t=e.name)||void 0===t?void 0:t.name)==="src"});e&&e.value&&(E=k.isJSXExpressionContainer(e.value))}!w||v||S||(v=!1);let T={text:j,className:(null===(a=f.attributes.find(e=>{var t;return k.isJSXAttribute(e)&&(null===(t=e.name)||void 0===t?void 0:t.name)==="className"}))||void 0===a?void 0:null===(s=a.value)||void 0===s?void 0:s.value)||""},I=l(e);I&&(console.log("\uD83D\uDD0D [DYNAMIC-DETECT] Element <".concat(b,"> detected as DYNAMIC")),console.log('\uD83D\uDD0D [DYNAMIC-DETECT]   - Text content: "'.concat(j.substring(0,50),'"')),console.log("\uD83D\uDD0D [DYNAMIC-DETECT]   - File: ".concat(n)));let A=!I&&!w&&["div","section"].includes(b.toLowerCase()),D=!1;if(y?(h=(null===(g=y.value)||void 0===g?void 0:g.value)||(0,Y.A)(),D=!0,console.log("\uD83D\uDD0D [DYNAMIC-DETECT] Reusing existing UID: ".concat(h," for <").concat(b,">"))):(h=(0,Y.A)(),console.log("\uD83D\uDD0D [DYNAMIC-DETECT] Generated NEW UID: ".concat(h," for <").concat(b,"> (isDynamic: ").concat(I,")"))),!v&&!D&&!S&&!A){o++;return}if(!v&&!S&&!A)return;let P=N&&C;console.log("\uD83D\uDD0D [CONTENT-DETECT] <".concat(b,"> detection:"),{hasStaticText:N,hasDynamicExpression:C,hasMixedContent:P,isDynamic:I,primaryText:null==j?void 0:j.substring(0,30)}),P?(x="true",console.log("\uD83D\uDD0D [MIXED-CONTENT] Element <".concat(b,"> has MIXED content (static + dynamic)")),console.log('\uD83D\uDD0D [MIXED-CONTENT]   - Static text: "'.concat(j,'"')),console.log("\uD83D\uDD0D [MIXED-CONTENT]   - Will edit static part across ALL instances")):S?E?(x="template",console.log("\uD83D\uDD0D [IMAGE-DETECT] Image has dynamic src - marking as template")):(x="true",console.log("\uD83D\uDD0D [IMAGE-DETECT] Image has static src - marking as static")):I?(x="template",console.log('\uD83D\uDD0D [DYNAMIC-DETECT] Setting data-static="template" for <'.concat(b,"> (pure dynamic)"))):(x="true",console.log('\uD83D\uDD0D [DYNAMIC-DETECT] Setting data-static="true" for <'.concat(b,"> (pure static)")));let M=[k.jsxAttribute(k.jsxIdentifier("data-editor-uid"),k.stringLiteral(h)),k.jsxAttribute(k.jsxIdentifier("data-editor-name"),k.stringLiteral(b)),k.jsxAttribute(k.jsxIdentifier("data-component-path"),k.stringLiteral(n.replace(/\\/g,"/"))),k.jsxAttribute(k.jsxIdentifier("data-component-line"),k.stringLiteral(String((null===(i=p.loc)||void 0===i?void 0:i.start.line)||0))),k.jsxAttribute(k.jsxIdentifier("data-static"),k.stringLiteral(x))];P&&M.push(k.jsxAttribute(k.jsxIdentifier("data-mixed-content"),k.stringLiteral("true"))),f.attributes.push(...M),r=!0,t[h]={mapping:{file:n,line:(null===(c=p.loc)||void 0===c?void 0:c.start.line)||0,column:(null===(d=p.loc)||void 0===d?void 0:d.start.column)||0},textSource:{file:n,line:(null===(u=p.loc)||void 0===u?void 0:u.start.line)||0,column:(null===(m=p.loc)||void 0===m?void 0:m.start.column)||0},hasTextContent:v||S,elementName:b,contentData:T,isImage:S,isDynamic:I,groupUID:null,isMultiInstance:!1}}}),Object.keys(t).length,r){let t=(0,X.default)(e,{retainLines:!1,compact:!1,concise:!1});s[n]=t.code}}catch(e){e.loc&&a.split("\n")[e.loc.line-1]}let n=Object.keys(s).filter(t=>s[t]!==e[t]);return n.length>0&&s[n[0]],{inspectorFiles:s,inspectorMap:t,uidInjectedASTs:{}}};async function Q(e){let t=JSON.stringify(e,null,2).replace(/`/g,"\\`").replace(/\${/g,"\\${");return"\n    <script>\n      // Inspector Mode for ESM Preview with Text Tracking\n      const shouldRunInspector = true; // Always run in preview\n      console.log('\uD83C\uDFAF [IFRAME-INSPECTOR] Script loaded in iframe');\n\n      try {\n        if (shouldRunInspector) {\n        console.log('\uD83C\uDFAF [IFRAME-INSPECTOR] Starting inspector initialization');\n\n        // Embedded inspector map\n        const inspectorMap = ".concat(t,";\n\n        let inspectorEnabled = false;\n        let currentElement = null;\n        let isEditing = false;\n        let currentEditingTool = 'select'; // Track the current editing tool\n\n        // Track currently selected element\n        let selectedElementId = null;\n        let selectedElementRef = null; // Store actual element reference\n        let resizeObserver = null; // Track ResizeObserver instance\n        let inspectorInitialized = false; // Track initialization (no window global!)\n        let currentObserver = null; // Track current MutationObserver\n\n        // MutationObserver setup function - must be defined before navigateToPage uses it\n        function setupChangeObserver(pendingChanges) {\n          console.log('\uD83C\uDFAF [MUTATION-OBSERVER-SETUP] Setting up MutationObserver with pending changes');\n\n          // Disconnect previous observer if exists\n          if (currentObserver) {\n            currentObserver.disconnect();\n            console.log('\uD83C\uDFAF [MUTATION-OBSERVER-SETUP] Disconnected previous observer');\n          }\n\n          if (!pendingChanges || Object.keys(pendingChanges).length === 0) {\n            console.log('\uD83C\uDFAF [MUTATION-OBSERVER-SETUP] No pending changes, skipping observer setup');\n            return;\n          }\n\n          currentObserver = new MutationObserver(function(mutations) {\n            console.log('\uD83C\uDFAF [MUTATION-OBSERVER] ⚡⚡⚡ FIRED! ⚡⚡⚡');\n            console.log('\uD83C\uDFAF [MUTATION-OBSERVER] Mutations count:', mutations.length);\n\n            const pendingUIDs = Object.keys(pendingChanges);\n            console.log('\uD83C\uDFAF [MUTATION-OBSERVER] \uD83D\uDCCB Pending changes UIDs:', pendingUIDs);\n\n            let restoredCount = 0;\n            let scannedElements = 0;\n\n            mutations.forEach(function(mutation) {\n              mutation.addedNodes.forEach(function(node) {\n                if (node.nodeType === 1) { // Element node\n                  const elementsToCheck = [];\n\n                  if (node.hasAttribute && node.hasAttribute('data-editor-uid')) {\n                    elementsToCheck.push(node);\n                  }\n\n                  const descendants = node.querySelectorAll ? Array.from(node.querySelectorAll('[data-editor-uid]')) : [];\n                  elementsToCheck.push(...descendants);\n\n                  elementsToCheck.forEach(function(element) {\n                    scannedElements++;\n                    const uid = element.getAttribute('data-editor-uid');\n\n                    if (!uid || !pendingChanges[uid]) {\n                      return;\n                    }\n\n                    const change = pendingChanges[uid];\n                    console.log('\uD83C\uDFAF [MUTATION-OBSERVER] ✅ Restoring changes for UID:', uid);\n\n                    // Apply text change if present\n                    if (change.textChange !== undefined) {\n                      element.textContent = change.textChange;\n                      console.log('\uD83C\uDFAF [MUTATION-OBSERVER] Applied text:', change.textChange);\n                    }\n\n                    // Apply style changes if present\n                    if (change.styleChanges) {\n                      Object.keys(change.styleChanges).forEach(function(prop) {\n                        element.style[prop] = change.styleChanges[prop];\n                        console.log('\uD83C\uDFAF [MUTATION-OBSERVER] Applied style:', prop, '=', change.styleChanges[prop]);\n                      });\n                    }\n\n                    restoredCount++;\n                    delete pendingChanges[uid];\n                  });\n                }\n              });\n            });\n\n            console.log('\uD83C\uDFAF [MUTATION-OBSERVER] Restored', restoredCount, 'changes, remaining:', Object.keys(pendingChanges).length);\n\n            // If all changes applied, disconnect observer\n            if (Object.keys(pendingChanges).length === 0) {\n              console.log('\uD83C\uDFAF [MUTATION-OBSERVER] All changes applied, disconnecting');\n              currentObserver.disconnect();\n              currentObserver = null;\n            }\n          });\n\n          // Start observing\n          currentObserver.observe(document.body, {\n            childList: true,\n            subtree: true\n          });\n\n          console.log('\uD83C\uDFAF [MUTATION-OBSERVER-SETUP] Observer started');\n        }\n\n\n        // Listen for inspector mode toggle from parent\n        window.addEventListener('message', function(e) {\n          if (e.data && e.data.type === 'inspector-toggle') {\n            console.log('\uD83C\uDFAF [IFRAME-INSPECTOR] Received toggle:', e.data.enabled);\n            inspectorEnabled = e.data.enabled;\n\n            if (!inspectorInitialized) {\n              initInspector();\n            }\n\n            if (inspectorInitialized) {\n              toggleInspectorVisual(inspectorEnabled);\n            }\n          } else if (e.data && e.data.type === 'editing-tool-change') {\n            // Handle editing tool changes\n            console.log('\uD83C\uDFAF [IFRAME-INSPECTOR] Editing tool changed to:', e.data.tool);\n            currentEditingTool = e.data.tool;\n            // Clear any selected element when switching tools - MUST call hideSelectedBox BEFORE nulling refs!\n            hideSelectedBox(); // This removes .inspector-selected class from selectedElementRef\n            selectedElementId = null;\n            selectedElementRef = null;\n            updateCursorModeVisual(); // This will update both cursor mode and icon display classes\n          } else if (e.data && e.data.type === 'inspector-element-selected') {\n            // Handle element selection\n            selectedElementId = e.data.uid;\n            updateSelectedBox(selectedElementId);\n          } else if (e.data && e.data.type === 'inspector-element-deselected') {\n            // Handle element deselection\n            hideSelectedBox(); // Remove class BEFORE nulling refs\n            selectedElementId = null;\n            selectedElementRef = null;\n          } else if (e.data && e.data.type === 'editor-closed') {\n            isEditing = false;\n            // Clear any visual selections when editor is closed\n            hideSelectedBox(); // This removes the green .inspector-selected class - MUST be called BEFORE nulling refs!\n            selectedElementId = null;\n            selectedElementRef = null;\n\n            // MutationObserver will handle restoring changes as elements appear (no delay!)\n          } else if (e.data && e.data.type === 'text-update') {\n            // Handle real-time text updates\n            const { uid, newText, instanceIndex } = e.data;\n\n            // Find all elements with this UID\n            const elements = uid ? Array.from(document.querySelectorAll(`[data-editor-uid=\"${uid}\"]`)) : [];\n            console.log(`\uD83D\uDD04 [IFRAME-INSPECTOR] Found ${elements.length} element(s) with UID: ${uid}`);\n\n            if (elements.length === 0) {\n              console.error('Text update: no elements found for UID:', uid);\n              return;\n            }\n\n            // Check if this is a template element (from array data) vs static template\n            const isTemplateData = elements[0]?.getAttribute('data-static') === 'template';\n            console.log(`\uD83D\uDD04 [IFRAME-INSPECTOR] Element type: ${isTemplateData ? 'TEMPLATE (from array)' : 'STATIC (template text)'}`);\n\n            // DECISION: Update one or all instances?\n            // - If data-static=\"template\" (from array like {item.name}) → Update ONLY clicked instance\n            // - If data-static=\"true\" (static text) → Update ALL instances (they share same template)\n            const shouldUpdateOnlyOne = isTemplateData && instanceIndex !== undefined && instanceIndex >= 0 && instanceIndex < elements.length;\n\n            if (shouldUpdateOnlyOne) {\n              const targetElement = elements[instanceIndex];\n              console.log(`\uD83D\uDD04 [IFRAME-INSPECTOR] Updating ONLY instance ${instanceIndex} of ${elements.length} (template data)`);\n              console.log(`  Target element: <${targetElement.tagName.toLowerCase()}>`);\n              console.log(`  New text: \"${newText}\"`);\n\n              // Update text content directly\n              const textNodes = [];\n              const walker = document.createTreeWalker(\n                targetElement,\n                NodeFilter.SHOW_TEXT,\n                null,\n                false\n              );\n              let node;\n              while (node = walker.nextNode()) {\n                if (node.textContent.trim()) {\n                  textNodes.push(node);\n                }\n              }\n              // Update the first non-empty text node\n              if (textNodes.length > 0) {\n                textNodes[0].textContent = newText;\n              } else {\n                // If no text nodes, check if it's a self-closing tag or set innerHTML\n                if (targetElement.children.length === 0) {\n                  targetElement.textContent = newText;\n                }\n              }\n            } else {\n              // Update ALL instances (static template or no instanceIndex)\n              console.log(`\uD83D\uDD04 [IFRAME-INSPECTOR] Updating ALL ${elements.length} instances (static template text)`);\n              console.log(`  InstanceIndex provided: ${instanceIndex}`);\n              console.log(`  data-static value: ${elements[0]?.getAttribute('data-static')}`);\n\n              elements.forEach((element, idx) => {\n                console.log(`  [${idx}] Starting update for element ${idx + 1}/${elements.length}: <${element.tagName.toLowerCase()}>`);\n                console.log(`  [${idx}] Current text: \"${element.textContent?.trim().substring(0, 30)}\"`);\n\n                const textNodes = [];\n                const walker = document.createTreeWalker(\n                  element,\n                  NodeFilter.SHOW_TEXT,\n                  null,\n                  false\n                );\n                let node;\n                while (node = walker.nextNode()) {\n                  if (node.textContent.trim()) {\n                    textNodes.push(node);\n                  }\n                }\n                console.log(`  [${idx}] Found ${textNodes.length} text nodes`);\n\n                if (textNodes.length > 0) {\n                  const oldText = textNodes[0].textContent;\n                  textNodes[0].textContent = newText;\n                  console.log(`  [${idx}] ✅ Updated text node: \"${oldText}\" → \"${newText}\"`);\n                } else {\n                  if (element.children.length === 0) {\n                    const oldText = element.textContent;\n                    element.textContent = newText;\n                    console.log(`  [${idx}] ✅ Updated element.textContent: \"${oldText}\" → \"${newText}\"`);\n                  } else {\n                    console.log(`  [${idx}] ❌ No text nodes and has children - skipped`);\n                  }\n                }\n              });\n\n              console.log(`\uD83D\uDD04 [IFRAME-INSPECTOR] Finished updating all ${elements.length} instances`);\n            }\n          } else if (e.data && e.data.type === 'style-update') {\n            // Handle real-time style updates\n            const { uid, newClasses } = e.data;\n\n            // Use individual UID only (group UID disabled to prevent crashes)\n            const targetElements = uid ? Array.from(document.querySelectorAll(`[data-editor-uid=\"${uid}\"]`)) : [];\n            console.log(`\uD83C\uDFA8 [IFRAME-INSPECTOR] Individual UID, updating styles for ${targetElements.length} element(s)`);\n\n            if (targetElements.length > 0 && newClasses) {\n              console.log(`\uD83C\uDFA8 [IFRAME-INSPECTOR] Updating styles for ${targetElements.length} elements with UID: ${uid}`);\n\n              targetElements.forEach((targetElement, index) => {\n                console.log(`  Updating styles for element ${index + 1}/${targetElements.length}: <${targetElement.tagName.toLowerCase()}>`);\n                // Preserve existing classes and merge with new ones\n                // This prevents color classes from being wiped out during style updates\n                targetElement.className = newClasses;\n              });\n            }\n          } else if (e.data && e.data.type === 'image-update') {\n            // Handle real-time image src updates\n            const { uid, newSrc } = e.data;\n\n            // Find the image element to update by UID\n            let targetElement = uid ? document.querySelector(`[data-editor-uid=\"${uid}\"]`) : null;\n\n            if (targetElement && targetElement.tagName.toLowerCase() === 'img' && newSrc) {\n              // Only update static images - dynamic images should not be editable\n              const isStaticImage = targetElement.getAttribute('data-static') === 'true';\n\n              if (isStaticImage) {\n                targetElement.setAttribute('src', newSrc);\n                console.log('\uD83D\uDDBC️ [IFRAME-INSPECTOR] Updated static image src:', { uid, newSrc });\n              } else {\n                console.warn('\uD83D\uDDBC️ [IFRAME-INSPECTOR] Attempted to update dynamic image - blocked:', { uid, isStatic: isStaticImage });\n              }\n            }\n          } else if (e.data && e.data.type === 'background-style-update') {\n            // Handle real-time background style updates\n            const { uid, backgroundImage, backgroundSize, backgroundPosition } = e.data;\n\n            // Find the element to update by UID\n            let targetElement = uid ? document.querySelector(`[data-editor-uid=\"${uid}\"]`) : null;\n\n            if (targetElement) {\n              // Apply background styles\n              if (backgroundImage) {\n                targetElement.style.backgroundImage = `url('${backgroundImage}')`;\n                console.log('\uD83C\uDFA8 [IFRAME-INSPECTOR] Updated background image:', { uid, backgroundImage });\n              } else {\n                targetElement.style.backgroundImage = '';\n              }\n\n              if (backgroundSize) {\n                targetElement.style.backgroundSize = backgroundSize.replace('bg-', '');\n              }\n\n              if (backgroundPosition) {\n                targetElement.style.backgroundPosition = backgroundPosition.replace('bg-', '');\n              }\n            }\n          }\n        });\n\n        // Create hover overlay\n        const hoverBox = document.createElement('div');\n        hoverBox.id = 'inspector-hover-box';\n        hoverBox.style.cssText = `\n          position: absolute;\n          background: rgba(59, 130, 246, 0.2);\n          border: 2px solid #3b82f6;\n          pointer-events: none;\n          z-index: 999999;\n          display: none;\n        `;\n\n        // Create tooltip that always follows mouse in inspector mode\n        const tooltipLabel = document.createElement('div');\n        tooltipLabel.id = 'inspector-tooltip';\n        tooltipLabel.style.cssText = `\n          position: fixed;\n          background: rgba(0, 0, 0, 0.85);\n          color: #fff;\n          padding: 5px 10px;\n          border-radius: 6px;\n          font-size: 12px;\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', sans-serif;\n          font-weight: 500;\n          pointer-events: none;\n          z-index: 2147483647;\n          white-space: nowrap;\n          backdrop-filter: blur(8px);\n          border: 1px solid rgba(255, 255, 255, 0.1);\n          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n          display: none;\n          align-items: center;\n          justify-content: center;\n          gap: 6px;\n        `;\n\n        // SVG icons for tooltip\n        const pencilIcon = '<svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" style=\"display: inline-block; vertical-align: middle;\"><path d=\"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z\"></path><path d=\"m15 5 4 4\"></path></svg>';\n        \n        const imageIcon = '<svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" style=\"display: inline-block; vertical-align: middle;\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect><circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\"></circle><polyline points=\"21 15 16 10 5 21\"></polyline></svg>';\n        \n        const wandIcon = '<svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" style=\"display: inline-block; vertical-align: middle;\"><path d=\"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72\"/><path d=\"m14 7 3 3\"/><path d=\"M5 6v4\"/><path d=\"M19 14v4\"/><path d=\"M10 2v2\"/><path d=\"M7 8H3\"/><path d=\"M21 16h-4\"/><path d=\"M11 3H9\"/></svg>';\n        \n        const pointerIcon = '<svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" style=\"display: inline-block; vertical-align: middle;\"><path d=\"M5 12h14\"></path><path d=\"m12 5 7 7-7 7\"></path></svg>';\n\n        // Create selected element overlay\n        const selectedBox = document.createElement('div');\n        selectedBox.id = 'inspector-selected-box';\n        selectedBox.style.cssText = `\n          position: absolute;\n          background: rgba(16, 185, 129, 0.15);\n          border: 2px solid #10b981;\n          pointer-events: none;\n          z-index: 999998;\n          display: none;\n        `;\n\n        function updateImageIndicators() {\n          // Remove existing image indicators\n          document.querySelectorAll('.image-indicator-wrapper').forEach(wrapper => {\n            wrapper.remove();\n          });\n          \n          // Add indicators to ALL images with data-editor-uid (both static and dynamic)\n          if (inspectorEnabled) {\n            document.querySelectorAll('img[data-editor-uid]').forEach(img => {\n              // Make image position relative if not already\n              const computedStyle = window.getComputedStyle(img);\n              if (computedStyle.position === 'static') {\n                img.style.position = 'relative';\n              }\n              \n              // Create indicator element\n              const indicator = document.createElement('div');\n              indicator.className = 'image-indicator-wrapper';\n              indicator.innerHTML = '<div class=\"image-indicator\"></div>';\n              \n              // Make the icon clickable - add data-editor-uid so it's recognized\n              const iconEl = indicator.querySelector('.image-indicator');\n              const uid = img.getAttribute('data-editor-uid');\n              if (uid) {\n                iconEl.setAttribute('data-editor-uid', uid);\n                // Mark it as an image icon so we can identify it\n                iconEl.setAttribute('data-is-image-icon', 'true');\n              }\n              \n              // Position it at the image location - button positioned inside image\n              const rect = img.getBoundingClientRect();\n              const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;\n              const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n\n              indicator.style.cssText = `\n                position: absolute;\n                left: ${rect.left + scrollLeft}px;\n                top: ${rect.top + scrollTop}px;\n                width: ${rect.width}px;\n                height: ${rect.height}px;\n                pointer-events: none;\n                z-index: 9999;\n              `;\n              \n              // Override pointer-events for the icon itself to make it interactive\n              iconEl.style.pointerEvents = 'auto';\n              iconEl.style.cursor = 'pointer';\n              \n              // Set initial color based on selected state or current editing tool\n              if (img.classList.contains('inspector-selected')) {\n                iconEl.style.backgroundColor = 'rgba(16, 185, 129, 0.9)'; // Green for selected\n              } else if (currentEditingTool === 'ai') {\n                iconEl.style.backgroundColor = 'rgba(147, 51, 234, 0.85)'; // Purple for AI mode\n              } else {\n                iconEl.style.backgroundColor = 'rgba(59, 130, 246, 0.85)'; // Blue for edit mode\n              }\n              \n              // Add hover event listeners for proper color changes\n              iconEl.addEventListener('mouseenter', function() {\n                if (img.classList.contains('inspector-selected')) {\n                  this.style.backgroundColor = 'rgba(16, 185, 129, 1)'; // Bright green on hover for selected\n                } else if (currentEditingTool === 'ai') {\n                  this.style.backgroundColor = 'rgba(147, 51, 234, 1)'; // Bright purple on hover\n                } else {\n                  this.style.backgroundColor = 'rgba(59, 130, 246, 1)'; // Bright blue on hover\n                }\n                this.style.transform = 'scale(1.15)';\n                this.style.width = '20px';\n                this.style.height = '20px';\n                this.style.opacity = '1';\n              });\n\n              iconEl.addEventListener('mouseleave', function() {\n                if (img.classList.contains('inspector-selected')) {\n                  this.style.backgroundColor = 'rgba(16, 185, 129, 0.9)'; // Back to green for selected\n                } else if (currentEditingTool === 'ai') {\n                  this.style.backgroundColor = 'rgba(147, 51, 234, 0.85)'; // Back to purple\n                } else {\n                  this.style.backgroundColor = 'rgba(59, 130, 246, 0.85)'; // Back to blue\n                }\n                this.style.transform = 'scale(1)';\n                this.style.width = '18px';\n                this.style.height = '18px';\n                this.style.opacity = '0.95';\n              });\n              \n              // Add hover detection to the actual image element (like text elements have)\n              img.addEventListener('mouseenter', function() {\n                if (img.classList.contains('inspector-selected')) {\n                  iconEl.style.backgroundColor = 'rgba(16, 185, 129, 1)'; // Bright green for selected\n                } else if (currentEditingTool === 'ai') {\n                  iconEl.style.backgroundColor = 'rgba(147, 51, 234, 1)'; // Bright purple\n                } else {\n                  iconEl.style.backgroundColor = 'rgba(59, 130, 246, 1)'; // Bright blue\n                }\n                iconEl.style.transform = 'scale(1.15)';\n                iconEl.style.width = '20px';\n                iconEl.style.height = '20px';\n                iconEl.style.opacity = '1';\n              });\n\n              img.addEventListener('mouseleave', function() {\n                if (img.classList.contains('inspector-selected')) {\n                  iconEl.style.backgroundColor = 'rgba(16, 185, 129, 0.9)'; // Back to green for selected\n                } else if (currentEditingTool === 'ai') {\n                  iconEl.style.backgroundColor = 'rgba(147, 51, 234, 0.85)'; // Back to purple\n                } else {\n                  iconEl.style.backgroundColor = 'rgba(59, 130, 246, 0.85)'; // Back to blue\n                }\n                iconEl.style.transform = 'scale(1)';\n                iconEl.style.width = '18px';\n                iconEl.style.height = '18px';\n                iconEl.style.opacity = '0.95';\n              });\n              \n              document.body.appendChild(indicator);\n            });\n          }\n        }\n\n        function initInspector() {\n          if (inspectorInitialized) return;\n\n          document.body.appendChild(hoverBox);\n          document.body.appendChild(tooltipLabel);\n          document.body.appendChild(selectedBox);\n          \n          // Create indicators for images\n          updateImageIndicators();\n\n          // Add global styles for inspector mode\n          const style = document.createElement('style');\n          style.id = 'inspector-styles';\n          style.textContent = `\n            /* FAST FOLLOW: Only show boxes on static elements, not dynamic data lists */\n            /* Subtle but visible border on static text elements only */\n            body.inspector-enabled [data-editor-uid][data-static=\"true\"]:not([data-is-image-icon]) {\n              outline: 1px solid rgba(59, 130, 246, 0.3) !important;\n              outline-offset: 5px;\n              outline-style: solid !important;\n              transition: outline-color 0.2s ease;\n              position: relative;\n            }\n            \n            /* FAST FOLLOW: Force square outline only for static elements */\n            /* Force square outline by temporarily removing border-radius during inspection */\n            body.inspector-enabled [data-editor-uid][data-static=\"true\"]:not([data-is-image-icon]) {\n              border-radius: 0 !important;\n            }\n\n            /* FAST FOLLOW: Corner indicators only for static elements */\n            /* Corner indicator base styles - positioned at edge of padded area */\n            body.inspector-enabled [data-editor-uid][data-static=\"true\"]:not(img):not([data-is-image-icon])::before {\n              content: '';\n              position: absolute;\n              top: -16px;\n              left: -17px;\n              width: 18px;\n              height: 18px;\n              background-color: rgba(59, 130, 246, 0.85);\n              background-size: 12px 12px;\n              background-position: center;\n              background-repeat: no-repeat;\n              border-radius: 0px;\n              pointer-events: auto;  /* Make clickable */\n              cursor: pointer;\n              z-index: 10000;\n              transition: all 0.2s ease;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              opacity: 0.95;\n            }\n            \n            /* Special styling for image indicators created dynamically */\n            .image-indicator {\n              position: absolute;\n              top: 0px;\n              left: 0px;\n              width: 18px;\n              height: 18px;\n              background-color: rgba(59, 130, 246, 0.85);\n              background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"white\" stroke-width=\"2.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\"/><circle cx=\"9\" cy=\"9\" r=\"2\"/><path d=\"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21\"/></svg>');\n              background-size: 12px 12px;\n              background-position: center;\n              background-repeat: no-repeat;\n              border-radius: 3px;\n              pointer-events: auto;  /* Make clickable */\n              cursor: pointer;\n              z-index: 10000;\n              display: block;\n              opacity: 0.95;\n              transition: all 0.2s ease;\n            }\n            \n            /* Image indicator hover effects are handled by JavaScript event listeners */\n            /* CSS hover rules removed to prevent conflicts with dynamic elements */\n            \n            /* Pencil icon for edit mode (select tool) - for text elements */\n            body.inspector-enabled.edit-mode [data-editor-uid][data-static=\"true\"]::before {\n              background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"white\" stroke-width=\"2.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z\"></path><path d=\"m15 5 4 4\"></path></svg>');\n            }\n            \n            /* Image icon for edit mode - for image elements */\n            body.inspector-enabled.edit-mode [data-editor-uid]:not([data-static])::before {\n              background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"white\" stroke-width=\"2.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\"/><circle cx=\"9\" cy=\"9\" r=\"2\"/><path d=\"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21\"/></svg>');\n            }\n            \n            /* FAST FOLLOW: AI mode icon only for static elements */\n            /* Crosshair icon for AI mode - actual Lucide Crosshair SVG path - needs high specificity */\n            body.inspector-enabled.ai-mode [data-editor-uid][data-static=\"true\"]:not([data-is-image-icon])::before {\n              background-image: url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"white\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72\"/><path d=\"m14 7 3 3\"/><path d=\"M5 6v4\"/><path d=\"M19 14v4\"/><path d=\"M10 2v2\"/><path d=\"M7 8H3\"/><path d=\"M21 16h-4\"/><path d=\"M11 3H9\"/></svg>') !important;\n              background-color: rgba(147, 51, 234, 0.85) !important;  /* Purple for AI mode */\n            }\n            \n            /* FAST FOLLOW: Hover effects only for static elements */\n            /* Stronger border and bigger indicator on hover */\n            body.inspector-enabled [data-editor-uid][data-static=\"true\"]:not([data-is-image-icon]):hover {\n              outline-color: rgba(59, 130, 246, 0.8) !important;\n            }\n\n            body.inspector-enabled.edit-mode [data-editor-uid][data-static=\"true\"]:hover::before {\n              background-color: rgba(59, 130, 246, 1);\n              opacity: 1;\n              transform: scale(1.15);\n              width: 20px;\n              height: 20px;\n            }\n            \n            body.inspector-enabled.ai-mode [data-editor-uid][data-static=\"true\"]:not([data-is-image-icon]):hover::before {\n              background-color: rgba(147, 51, 234, 1) !important;  /* Bright purple on hover for AI mode */\n              opacity: 1;\n              transform: scale(1.15);\n              width: 20px;\n              height: 20px;\n            }\n            \n            /* FAST FOLLOW: Selected element styling only for static elements */\n            /* Selected element gets a more visible border */\n            body.inspector-enabled [data-editor-uid][data-static=\"true\"]:not([data-is-image-icon]).inspector-selected {\n              outline: 2px solid rgba(16, 185, 129, 0.9) !important;\n              outline-offset: 5px;  /* Match the regular state offset */\n              outline-style: solid !important;\n            }\n\n            /* Selected image styling - images need special handling */\n            body.inspector-enabled img[data-editor-uid][data-static=\"true\"].inspector-selected {\n              outline: 2px solid rgba(16, 185, 129, 0.9) !important;\n              outline-offset: 5px;\n              outline-style: solid !important;\n            }\n\n            /* Change indicator color for selected element - needs highest specificity to override all mode colors */\n            body.inspector-enabled.ai-mode [data-editor-uid][data-static=\"true\"].inspector-selected:not([data-is-image-icon])::before,\n            body.inspector-enabled.edit-mode [data-editor-uid][data-static=\"true\"].inspector-selected:not([data-is-image-icon])::before,\n            body.inspector-enabled [data-editor-uid][data-static=\"true\"].inspector-selected:not([data-is-image-icon])::before {\n              background-color: rgba(16, 185, 129, 0.9) !important;\n            }\n            \n            /* Change image indicator color for selected image */\n            body.inspector-enabled img[data-editor-uid].inspector-selected ~ .image-indicator-wrapper .image-indicator {\n              background-color: rgba(16, 185, 129, 0.9);\n            }\n\n            /* Multi-instance selection styling */\n            body.inspector-enabled [data-editor-uid].inspector-multi-selected,\n            body.inspector-enabled [data-group-uid].inspector-multi-selected {\n              outline: 2px solid rgba(168, 85, 247, 0.8) !important;\n              outline-offset: 5px;\n              outline-style: solid !important;\n              background-color: rgba(168, 85, 247, 0.1) !important;\n            }\n\n            /* Multi-instance indicator color */\n            body.inspector-enabled [data-editor-uid].inspector-multi-selected::before,\n            body.inspector-enabled [data-group-uid].inspector-multi-selected::before {\n              background-color: rgba(168, 85, 247, 0.9) !important;\n            }\n\n            /* Cursor mode styles - disable interactions on interactive elements */\n            /* Exclude editable elements so their corner buttons remain clickable */\n            body.cursor-mode button:not([data-editor-uid][data-static=\"true\"]),\n            body.cursor-mode input:not([data-editor-uid][data-static=\"true\"]),\n            body.cursor-mode select:not([data-editor-uid][data-static=\"true\"]),\n            body.cursor-mode textarea:not([data-editor-uid][data-static=\"true\"]),\n            body.cursor-mode [role=\"button\"]:not([data-editor-uid][data-static=\"true\"]),\n            body.cursor-mode [role=\"link\"]:not([data-editor-uid][data-static=\"true\"]),\n            body.cursor-mode [role=\"tab\"]:not([data-editor-uid][data-static=\"true\"]),\n            body.cursor-mode [role=\"menuitem\"]:not([data-editor-uid][data-static=\"true\"]),\n            body.cursor-mode [role=\"option\"]:not([data-editor-uid][data-static=\"true\"]),\n            body.cursor-mode [tabindex]:not([tabindex=\"-1\"]):not([data-editor-uid][data-static=\"true\"]) {\n              pointer-events: none !important;\n              opacity: 0.6 !important;\n            }\n\n            /* Allow hover effects on editable elements in cursor mode */\n            body.cursor-mode [data-editor-uid][data-static=\"true\"] {\n              pointer-events: auto !important;\n              opacity: 1 !important;\n            }\n            \n            /* Force default cursor everywhere in inspector mode */\n            body.inspector-enabled * {\n              cursor: default !important;\n            }\n            \n            /* FAST FOLLOW: Pointer cursor only on static editable elements */\n            /* Pointer cursor on editable/clickable elements and their children */\n            body.inspector-enabled [data-editor-uid][data-static=\"true\"]:not([data-is-image-icon]),\n            body.inspector-enabled [data-editor-uid][data-static=\"true\"]:not([data-is-image-icon]) * {\n              cursor: pointer !important;\n            }\n\n            /* Outline for ALL images with UIDs (both static and dynamic) */\n            body.inspector-enabled img[data-editor-uid] {\n              cursor: pointer !important;\n              outline: 1px solid rgba(59, 130, 246, 0.3) !important;\n              outline-offset: 5px;\n              outline-style: solid !important;\n              transition: outline-color 0.2s ease;\n            }\n\n            /* Stronger outline on image hover */\n            body.inspector-enabled img[data-editor-uid]:hover {\n              outline-color: rgba(59, 130, 246, 0.8) !important;\n            }\n\n            /* Selected image gets green outline */\n            body.inspector-enabled img[data-editor-uid].inspector-selected {\n              outline: 2px solid rgba(16, 185, 129, 0.9) !important;\n              outline-offset: 5px;\n            }\n          `;\n          document.head.appendChild(style);\n\n          inspectorInitialized = true;\n        }\n\n        function toggleInspectorVisual(enabled) {\n          if (enabled) {\n            document.body.classList.add('inspector-enabled');\n            updateCursorModeVisual(); // Apply cursor mode styles when enabling inspector\n            updateImageIndicators(); // Add indicators for images\n\n            // Remove disabled attribute from editable elements to allow clicks\n            document.querySelectorAll('[data-editor-uid][data-static=\"true\"][disabled]').forEach(function(el) {\n              el.setAttribute('data-was-disabled', 'true');\n              el.removeAttribute('disabled');\n            });\n\n            // Tooltip will be shown on next mouse move\n          } else {\n            document.body.classList.remove('inspector-enabled');\n            document.body.classList.remove('cursor-mode');\n            // hoverBox.style.display = 'none'; // Disabled - using CSS outline instead\n            tooltipLabel.style.display = 'none';\n            selectedBox.style.display = 'none';\n            updateImageIndicators(); // Remove indicators when disabled\n\n            // Restore disabled attribute to elements that were disabled\n            document.querySelectorAll('[data-editor-uid][data-was-disabled]').forEach(function(el) {\n              el.setAttribute('disabled', 'disabled');\n              el.removeAttribute('data-was-disabled');\n            });\n          }\n        }\n\n        function updateCursorModeVisual() {\n          // Apply cursor-mode for both 'select' (pencil) and 'ai' tools\n          // This disables interaction with buttons, dropdowns, inputs, etc.\n          if (currentEditingTool === 'select' || currentEditingTool === 'ai') {\n            document.body.classList.add('cursor-mode');\n          } else {\n            // Only 'navigate' tool allows normal interactions\n            document.body.classList.remove('cursor-mode');\n          }\n\n          // Add mode-specific classes for icon display\n          document.body.classList.remove('edit-mode', 'ai-mode', 'navigate-mode');\n          if (currentEditingTool === 'select') {\n            document.body.classList.add('edit-mode');\n          } else if (currentEditingTool === 'ai') {\n            document.body.classList.add('ai-mode');\n          } else if (currentEditingTool === 'navigate') {\n            document.body.classList.add('navigate-mode');\n          }\n\n          // Update image indicators to reflect new tool colors\n          updateImageIndicators();\n        }\n\n        function isInteractiveElement(element) {\n          if (!element) return false;\n\n          const tagName = element.tagName.toLowerCase();\n          const interactiveTags = ['button', 'input', 'select', 'textarea', 'a'];\n\n          // Check for interactive HTML tags\n          if (interactiveTags.includes(tagName)) return true;\n\n          // Check for elements with interactive roles or attributes\n          if (element.hasAttribute('role') &&\n              ['button', 'link', 'tab', 'menuitem', 'option'].includes(element.getAttribute('role'))) {\n            return true;\n          }\n\n          // Check for elements with tabindex (focusable)\n          if (element.hasAttribute('tabindex') && element.getAttribute('tabindex') !== '-1') {\n            return true;\n          }\n\n          // Check for elements with click handlers (common interactive pattern)\n          if (element.hasAttribute('onclick')) {\n            return true;\n          }\n\n          return false;\n        }\n\n        function updateHoverBox(element) {\n          // Disabled - we use CSS outline on hover instead\n          return;\n          \n          if (!element || !inspectorEnabled || element === selectedElementRef) return;\n\n          const rect = element.getBoundingClientRect();\n          const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;\n          const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n\n          // Add padding to create space for the corner icon\n          const padding = 8;\n          hoverBox.style.left = (rect.left + scrollLeft - padding) + 'px';\n          hoverBox.style.top = (rect.top + scrollTop - padding) + 'px';\n          hoverBox.style.width = (rect.width + padding * 2) + 'px';\n          hoverBox.style.height = (rect.height + padding * 2) + 'px';\n          hoverBox.style.display = 'block';\n        }\n\n        function updateSelectedBox(uid) {\n          // Remove inspector-selected class from any previously selected elements\n          document.querySelectorAll('.inspector-selected').forEach(el => {\n            el.classList.remove('inspector-selected');\n          });\n          \n          if (!uid) {\n            hideSelectedBox();\n            selectedElementRef = null;\n            return;\n          }\n\n          const element = document.querySelector(`[data-editor-uid=\"${uid}\"]`);\n          if (!element) {\n            hideSelectedBox();\n            selectedElementRef = null;\n            return;\n          }\n\n          selectedElementRef = element;\n          \n          // Add selected class to the new element - CSS handles the green outline\n          element.classList.add('inspector-selected');\n          \n          // Disabled - using CSS outline that turns green instead of separate box\n          /*\n          const rect = element.getBoundingClientRect();\n          const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;\n          const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n\n          const padding = 8;\n          selectedBox.style.left = (rect.left + scrollLeft - padding) + 'px';\n          selectedBox.style.top = (rect.top + scrollTop - padding) + 'px';\n          selectedBox.style.width = (rect.width + padding * 2) + 'px';\n          selectedBox.style.height = (rect.height + padding * 2) + 'px';\n          selectedBox.style.display = 'block';\n          */\n\n          // Set up ResizeObserver to track element size changes\n          if (resizeObserver) {\n            resizeObserver.disconnect();\n          }\n          resizeObserver = new ResizeObserver(() => {\n            if (selectedElementRef) {\n              const newRect = selectedElementRef.getBoundingClientRect();\n              const newScrollLeft = window.pageXOffset || document.documentElement.scrollLeft;\n              const newScrollTop = window.pageYOffset || document.documentElement.scrollTop;\n\n              selectedBox.style.left = (newRect.left + newScrollLeft) + 'px';\n              selectedBox.style.top = (newRect.top + newScrollTop) + 'px';\n              selectedBox.style.width = newRect.width + 'px';\n              selectedBox.style.height = newRect.height + 'px';\n            }\n          });\n          resizeObserver.observe(element);\n        }\n\n        function hideSelectedBox() {\n          // Disabled - using CSS outline instead\n          // selectedBox.style.display = 'none';\n          \n          if (selectedElementRef) {\n            selectedElementRef.classList.remove('inspector-selected');\n            selectedElementRef = null;\n          }\n          if (resizeObserver) {\n            resizeObserver.disconnect();\n            resizeObserver = null;\n          }\n        }\n\n        // Track mouse movement - tooltip ALWAYS follows cursor in inspector mode\n        document.addEventListener('mousemove', function(e) {\n          if (!inspectorEnabled) {\n            tooltipLabel.style.display = 'none';\n            return;\n          }\n\n          // Tooltip always follows mouse cursor when inspector is enabled\n          tooltipLabel.style.left = (e.clientX + 12) + 'px';\n          tooltipLabel.style.top = (e.clientY - 28) + 'px';\n          tooltipLabel.style.display = 'flex';\n\n          let element = e.target.closest('[data-editor-uid]');\n          \n          // If hovering over an image icon, treat it as hovering over the image\n          if (element && element.hasAttribute('data-is-image-icon')) {\n            const uid = element.getAttribute('data-editor-uid');\n            const actualImage = document.querySelector(`img[data-editor-uid=\"${uid}\"]`);\n            if (actualImage) {\n              element = actualImage;\n            }\n          }\n\n          // Update tooltip text based on what we're hovering\n          if (element && element !== selectedElementRef) {\n            const tagName = element.getAttribute('data-editor-name') || element.tagName.toLowerCase();\n            // Show icon + contextual message when hovering over editable elements\n            if (currentEditingTool === 'select' || currentEditingTool === 'ai') {\n              // Check if it's a text element\n              const textTags = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'span', 'a', 'button', 'label', 'li', 'td', 'th', 'div'];\n              if (textTags.includes(tagName)) {\n                tooltipLabel.innerHTML = pencilIcon + ' <span>Click to edit text</span>';\n              } else if (tagName === 'img') {\n                const isStaticImage = element.getAttribute('data-static') === 'true';\n                if (isStaticImage) {\n                  tooltipLabel.innerHTML = imageIcon + ' <span>Click to edit image</span>';\n                } else {\n                  tooltipLabel.innerHTML = imageIcon + ' <span>Dynamic image (not editable)</span>';\n                }\n              } else {\n                tooltipLabel.innerHTML = pencilIcon + ' <span>Click to edit &lt;' + tagName + '&gt;</span>';\n              }\n            } else {\n              tooltipLabel.innerHTML = pointerIcon + ' <span>&lt;' + tagName + '&gt;</span>';\n            }\n          } else {\n            // Show current mode with consistent styling when not hovering over an element\n            if (currentEditingTool === 'ai') {\n              tooltipLabel.innerHTML = wandIcon + ' <span>AI mode - select something</span>';\n            } else if (currentEditingTool === 'select') {\n              tooltipLabel.innerHTML = pencilIcon + ' <span>hover on something</span>';\n            } else {\n              tooltipLabel.innerHTML = pointerIcon + ' <span>Navigate</span>';\n            }\n          }\n          // Keep tooltip styling consistent - no opacity changes\n          tooltipLabel.style.opacity = '1';\n          tooltipLabel.style.background = 'rgba(0, 0, 0, 0.85)';\n\n          if (element !== currentElement) {\n            currentElement = element;\n            if (element && element !== selectedElementRef) {\n              updateHoverBox(element);\n            } else {\n              // hoverBox.style.display = 'none'; // Disabled - using CSS outline instead\n            }\n          }\n\n          // Extra safeguard: Always hide hover box if we're over the selected element\n          if (element && element === selectedElementRef) {\n            // hoverBox.style.display = 'none'; // Disabled - using CSS outline instead\n          }\n        });\n\n        // Handle clicks\n        document.addEventListener('click', function(e) {\n          console.log('\uD83C\uDFAF [IFRAME-INSPECTOR] Click detected, inspectorEnabled:', inspectorEnabled, 'isEditing:', isEditing, 'editingTool:', currentEditingTool);\n          console.log('\uD83C\uDFAF [IFRAME-INSPECTOR] Click target:', e.target);\n\n          if (!inspectorEnabled) {\n            console.log('❌ [IFRAME-INSPECTOR] Inspector disabled, ignoring click');\n            return;\n          }\n\n          // In edit mode (select) or AI mode, prevent ALL default click behaviors\n          if (currentEditingTool === 'select' || currentEditingTool === 'ai') {\n            console.log('\uD83D\uDEAB [IFRAME-INSPECTOR] Edit/AI mode: preventing all click interactions');\n            e.preventDefault();\n            e.stopPropagation();\n            \n            // Don't process clicks on non-editable elements in edit/AI mode\n            // Only match static editable elements or images to skip nested dynamic elements\n            let element = e.target.closest('[data-editor-uid][data-static=\"true\"], img[data-editor-uid]');\n            if (!element) {\n              console.log('❌ [IFRAME-INSPECTOR] No editable element found, ignoring click');\n              return;\n            }\n            \n            // If it's an image icon, find the actual image element instead\n            if (element.hasAttribute('data-is-image-icon')) {\n              const uid = element.getAttribute('data-editor-uid');\n              const actualImage = document.querySelector(`img[data-editor-uid=\"${uid}\"]`);\n              if (actualImage) {\n                element = actualImage;\n                console.log('\uD83C\uDFAF [IFRAME-INSPECTOR] Image icon clicked, redirecting to actual image:', element);\n              }\n            }\n            \n            console.log('\uD83C\uDFAF [IFRAME-INSPECTOR] Found element with UID:', element);\n\n            // Debug: Log ALL attributes\n            const allAttrs = {};\n            for (let i = 0; i < element.attributes.length; i++) {\n              const attr = element.attributes[i];\n              allAttrs[attr.name] = attr.value;\n            }\n\n            console.log('\uD83D\uDD0D [IFRAME-INSPECTOR] ALL element attributes:', allAttrs);\n            console.log('\uD83D\uDD0D [IFRAME-INSPECTOR] Element analysis:', {\n              tagName: element.tagName,\n              textContent: element.textContent?.substring(0, 50) + '...',\n              hasStatic: element.hasAttribute('data-static'),\n              staticValue: element.getAttribute('data-static'),\n              name: element.getAttribute('data-editor-name'),\n              uid: element.getAttribute('data-editor-uid'),\n              path: element.getAttribute('data-component-path'),\n              line: element.getAttribute('data-component-line')\n            });\n\n            console.log('✅ [IFRAME-INSPECTOR] Element has data-editor-uid - processing click');\n\n            const uid = element.getAttribute('data-editor-uid');\n\n            // All elements should have UIDs from build process - skip if missing\n            if (!uid) {\n              console.warn('\uD83C\uDFAF [IFRAME-INSPECTOR] Element missing UID - skipping (all elements should have build-time UIDs)');\n              return;\n            }\n\n            // FAST FOLLOW: Allow selection of static elements AND images\n            const staticValue = element.getAttribute('data-static');\n            const isStatic = staticValue === 'true';\n            const isTemplate = staticValue === 'template';\n            const isImage = element.tagName.toLowerCase() === 'img';\n\n            // Allow clicks on static elements OR any image\n            if (!isStatic && !isImage) {\n              console.log('❌ [IFRAME-INSPECTOR] Element not static and not an image - ignoring click');\n              return;\n            }\n\n            // DISABLED: Group UUID detection to prevent crashes\n            // Fallback to individual element only\n            const allInstances = [element];\n            const isMultiInstance = false;\n            const groupUID = null;\n\n            // Use individual UID for inspector map lookup (group UID disabled)\n            const lookupUID = uid;\n\n            console.log(`\uD83C\uDFAF [IFRAME-INSPECTOR] Element clicked with individual UID: ${uid}, group UID: ${groupUID}`);\n            console.log(`\uD83C\uDFAF [IFRAME-INSPECTOR] Using lookup UID: ${lookupUID}`);\n            console.log(`\uD83C\uDFAF [IFRAME-INSPECTOR] Found ${allInstances.length} instances`);\n            console.log('\uD83C\uDFAF [IFRAME-INSPECTOR] InspectorMap exists?', !!inspectorMap);\n            console.log('\uD83C\uDFAF [IFRAME-INSPECTOR] Mapping for this element?', !!inspectorMap[lookupUID]);\n\n            // For multi-instance elements, highlight all instances\n            if (isMultiInstance) {\n              console.log(`\uD83C\uDFAF [IFRAME-INSPECTOR] Multi-instance element - highlighting all ${allInstances.length} instances`);\n              allInstances.forEach(instance => {\n                instance.classList.add('inspector-multi-selected');\n              });\n            }\n\n            if (inspectorMap && inspectorMap[lookupUID]) {\n              // If we're already editing a different element, handle switching\n              if (isEditing && selectedElementId && selectedElementId !== uid) {\n                console.log('\uD83D\uDD04 [IFRAME-INSPECTOR] Switching from element', selectedElementId, 'to', uid);\n\n                // Send a message to save any pending changes before switching\n                window.parent.postMessage({\n                  type: 'inspector-element-switch',\n                  fromUID: selectedElementId,\n                  toUID: uid\n                }, '*');\n              }\n\n              isEditing = true;\n              const mapping = inspectorMap[lookupUID];\n\n              // Extract text content from the element\n              let elementText = \"\";\n              const textNodes = [];\n              const walker = document.createTreeWalker(\n                element,\n                NodeFilter.SHOW_TEXT,\n                null,\n                false\n              );\n              let node;\n              while (node = walker.nextNode()) {\n                if (node.textContent.trim()) {\n                  textNodes.push(node);\n                }\n              }\n              if (textNodes.length > 0) {\n                elementText = textNodes[0].textContent;\n              } else if (element.children.length === 0) {\n                elementText = element.textContent;\n              }\n\n              const tagName = element.tagName.toLowerCase();\n\n              // Extract className for styles - handle SVG elements properly\n              let className;\n              if (element instanceof SVGElement) {\n                // For SVG elements, className returns SVGAnimatedString which can't be cloned\n                className = element.getAttribute('class') || '';\n              } else {\n                // For HTML elements, className is a string\n                className = element.className || '';\n              }\n\n              // Use individual UID only (group UID disabled)\n              const mainUID = uid;\n\n              // INSTANCE INDEX DETECTION: Find which instance this is if multiple exist\n              const allInstancesWithUID = Array.from(document.querySelectorAll('[data-editor-uid=\"' + uid + '\"]'));\n              const instanceIndex = allInstancesWithUID.indexOf(element);\n              const isMultiInstance = allInstancesWithUID.length > 1;\n\n              console.log('\uD83C\uDFAF [INSTANCE-CLICK] Instance detection:', {\n                uid,\n                totalInstances: allInstancesWithUID.length,\n                thisInstanceIndex: instanceIndex,\n                isMultiInstance,\n                dataStatic: element.getAttribute('data-static')\n              });\n\n              if (isMultiInstance) {\n                console.log('\uD83C\uDFAF [INSTANCE-CLICK] Multiple instances detected!');\n                allInstancesWithUID.forEach((inst, idx) => {\n                  const isThis = inst === element;\n                  console.log(`  Instance ${idx}: <${inst.tagName.toLowerCase()}> ${isThis ? '← CLICKED' : ''}`);\n                  console.log(`    Text: \"${inst.textContent?.trim().substring(0, 30)}...\"`);\n                });\n              }\n\n              // Combine the data from both sources\n              const clickData = {\n                type: 'inspector-click',\n                data: {\n                  uid: mainUID, // Individual UID only\n                  tagName: tagName,\n                  text: elementText,\n                  isMultiInstance: isMultiInstance,\n                  instanceCount: allInstancesWithUID.length,\n                  instanceIndex: instanceIndex,  // NEW: Which instance was clicked (0-indexed)\n                  groupUID: null, // Group UUID disabled\n                  mapping: mapping.mapping || null,\n                  textSource: mapping.textSource || null,\n                  styleData: {\n                    className: className,\n                    hasClassName: element.hasAttribute('className'),\n                    // Image-specific attributes\n                    ...(tagName === 'img' && {\n                      src: element.getAttribute('src') || '',\n                      alt: element.getAttribute('alt') || '',\n                      title: element.getAttribute('title') || '',\n                      width: element.getAttribute('width') || '',\n                      height: element.getAttribute('height') || '',\n                      loading: element.getAttribute('loading') || '',\n                    }),\n                  }\n                }\n              };\n\n              console.log('\uD83D\uDCE4 [INSTANCE-SEND] Sending click data to parent:', clickData);\n              console.log('\uD83D\uDCE4 [INSTANCE-SEND] Key data:', {\n                uid: clickData.data.uid,\n                isMultiInstance: clickData.data.isMultiInstance,\n                instanceIndex: clickData.data.instanceIndex,\n                totalInstances: clickData.data.instanceCount,\n                dataStatic: element.getAttribute('data-static')\n              });\n              window.parent.postMessage(clickData, '*');\n              console.log('\uD83D\uDCE4 [INSTANCE-SEND] Message sent successfully!');\n\n              // Update selected element visually\n              selectedElementId = uid;\n              updateSelectedBox(uid);\n            } else {\n              console.log('\uD83C\uDFAF [IFRAME-INSPECTOR] No mapping found, creating basic mapping from element attributes');\n\n              // Get file path and line from element attributes\n              const filePath = element.getAttribute('data-component-path');\n              const line = element.getAttribute('data-component-line') ? parseInt(element.getAttribute('data-component-line')) : null;\n              const column = null;\n\n              // Create a basic mapping from element attributes\n              const basicMapping = {\n                file: filePath,\n                line: line,\n                column: column\n              };\n\n              // Extract text content from the element (same as above)\n              let elementText = \"\";\n              const textNodes = [];\n              const walker = document.createTreeWalker(\n                element,\n                NodeFilter.SHOW_TEXT,\n                null,\n                false\n              );\n              let node;\n              while (node = walker.nextNode()) {\n                if (node.textContent.trim()) {\n                  textNodes.push(node);\n                }\n              }\n              if (textNodes.length > 0) {\n                elementText = textNodes[0].textContent;\n              } else if (element.children.length === 0) {\n                elementText = element.textContent;\n              }\n\n              // Still send the click with basic mapping\n              const clickData = {\n                type: 'inspector-click',\n                data: {\n                  uid: uid,\n                  tagName: element.tagName.toLowerCase(),\n                  text: elementText,\n                  mapping: basicMapping,\n                  textSource: basicMapping,  // Use same for both\n                  styleData: {\n                    className: element instanceof SVGElement ? (element.getAttribute('class') || '') : (element.className || ''),\n                    hasClassName: element.hasAttribute('className'),\n                    // Image-specific attributes\n                    ...(element.tagName.toLowerCase() === 'img' && {\n                      src: element.getAttribute('src') || '',\n                      alt: element.getAttribute('alt') || '',\n                      title: element.getAttribute('title') || '',\n                      width: element.getAttribute('width') || '',\n                      height: element.getAttribute('height') || '',\n                      loading: element.getAttribute('loading') || '',\n                    }),\n                  }\n                }\n              };\n              console.log('\uD83C\uDFAF [IFRAME-INSPECTOR] Sending basic click data to parent:', clickData);\n              window.parent.postMessage(clickData, '*');\n            }\n          } else {\n            // Navigate mode - allow normal interactions\n            console.log('\uD83D\uDD04 [IFRAME-INSPECTOR] Navigate mode: allowing normal click behavior');\n            // Don't prevent default, let the click go through normally\n          }\n        }, true);\n\n        // Also prevent mousedown to catch interactions earlier\n        document.addEventListener('mousedown', function(e) {\n          if (!inspectorEnabled) return;\n          \n          // In edit mode (select) or AI mode, prevent ALL interactions\n          if (currentEditingTool === 'select' || currentEditingTool === 'ai') {\n            e.preventDefault();\n            e.stopPropagation();\n          }\n        }, true);\n\n        // Track scroll to update overlay positions\n        window.addEventListener('scroll', function() {\n          // No need to update selectedBox - CSS outline follows the element automatically\n          \n          if (currentElement && currentElement !== selectedElementRef && inspectorEnabled) {\n            updateHoverBox(currentElement);\n          }\n          updateImageIndicators(); // Update image indicators on scroll\n        });\n\n        // setupChangeObserver function moved to before navigateToPage\n\n        // Delay initialization to ensure DOM is ready\n        setTimeout(() => {\n          console.log('\uD83C\uDFAF [IFRAME-INSPECTOR] Auto-init after 100ms');\n          if (!inspectorInitialized) {\n            initInspector();\n          }\n\n          // Auto-enable inspector mode for ESM preview\n          inspectorEnabled = true;\n          console.log('\uD83C\uDFAF [IFRAME-INSPECTOR] Auto-enabled inspector mode');\n          toggleInspectorVisual(true);\n          updateCursorModeVisual(); // Apply initial cursor mode styles and set mode classes\n\n          // Check for elements with data-editor-uid\n          const elementsWithId = document.querySelectorAll('[data-editor-uid]');\n          console.log('\uD83C\uDFAF [IFRAME-INSPECTOR] Found elements with data-editor-uid:', elementsWithId.length);\n\n          // Log details about each editable element\n          elementsWithId.forEach((el, index) => {\n            const uid = el.getAttribute('data-editor-uid');\n            const staticValue = el.getAttribute('data-static');\n            const tagName = el.tagName.toLowerCase();\n            const text = el.textContent?.trim().substring(0, 50) || '';\n            console.log(`  Element ${index + 1}: <${tagName}> UID=${uid} static=${staticValue} text=\"${text}\"`);\n          });\n        }, 100);\n        }\n      } catch (error) {\n      }\n    <\/script>")}var Z=s(28662);let ee=null,et=()=>({initializeEsbuild:(0,a.useCallback)(async()=>{ee||(ee=(async()=>{try{await Z.initialize({wasmURL:"https://static.famous.ai/esbuild.wasm"})}catch(e){if(e instanceof Error&&e.message.includes('Cannot call "initialize" more than once'))return;throw e}})()),await ee},[])});function es(e){let{previewUrl:t,previewMode:s,error:r,status:l,currentInspectorMode:o,editingTool:i,onIframeRef:c,selectedPageRoute:d}=e,u=(0,a.useRef)(null),m=(0,a.useRef)(null),g=(0,a.useRef)(!1);a.useEffect(()=>{g.current=!1},[t]),(0,a.useEffect)(()=>{if(d){if(null===u.current){u.current=d;return}u.current!==d&&(h.getState().clearSelectedElement(),u.current=d)}},[d]);let x=e=>{e&&e.contentWindow&&!g.current&&(m.current=e,g.current=!0,setTimeout(()=>{try{if(o){var t;null===(t=e.contentWindow)||void 0===t||t.postMessage({type:"inspector-toggle",enabled:o&&("select"===i||"ai"===i)},"*")}}catch(e){}},100))};return(0,n.jsx)("div",{className:"\n        flex-1 relative flex items-center justify-center\n        transition-all duration-300 ease-in-out\n        ".concat("mobile"===s?"bg-gray-100 p-8":"p-0 bg-transparent","\n      "),"data-sentry-component":"PreviewFrame","data-sentry-source-file":"PreviewFrame.tsx",children:t?(0,n.jsxs)("div",{className:"\n            relative overflow-hidden\n            transition-all duration-300 ease-in-out\n            ".concat("mobile"===s?"w-[375px] h-[812px] max-h-full border-[14px] border-gray-900 rounded-[50px] shadow-2xl bg-black":"w-full h-full border-0 rounded-none shadow-none bg-transparent","\n          "),style:{transformOrigin:"center center"},children:[(0,n.jsx)("div",{className:"\n              absolute top-0 left-1/2 w-[150px] h-[30px] bg-gray-900 rounded-b-[20px] z-10\n              transition-all duration-300 ease-in-out transform -translate-x-1/2\n              ".concat("mobile"===s?"opacity-100 scale-100":"opacity-0 scale-75","\n            ")}),(0,n.jsx)("iframe",{ref:e=>{c(e),m.current=e},src:t,className:"\n              w-full h-full border-0\n              transition-all duration-300 ease-in-out\n              ".concat("mobile"===s?"rounded-[36px]":"rounded-none","\n            "),sandbox:"allow-scripts allow-same-origin allow-modals",title:"React App Preview",onLoad:e=>x(e.currentTarget)},t)]}):(0,n.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500",children:r?"Build failed - check console for details":"Preview ready"===l?l:(0,n.jsxs)("svg",{className:"animate-spin h-10 w-10 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})})}var en=s(72099),ea=s(86791),er=s(37044),el=s(37610),eo=s(64308);function ei(e){let{textareaRef:t,iframeRef:s,handleRealTimeTextChange:r}=e,l=h(e=>e.editingText),o=h(e=>e.selectedElement),i=h(e=>e.setSelectedElement),c=h(e=>e.setEditingText);return(0,a.useEffect)(()=>{let e=setTimeout(()=>{if(t.current){let e=t.current;e.style.height="auto",e.style.overflow="hidden";let s=parseInt(window.getComputedStyle(e).lineHeight),n=parseInt(window.getComputedStyle(e).paddingTop),a=parseInt(window.getComputedStyle(e).paddingBottom),r=parseInt(window.getComputedStyle(e).borderTopWidth),l=parseInt(window.getComputedStyle(e).borderBottomWidth),o=Math.min(Math.max(e.scrollHeight,s+n+a+r+l),200);e.style.height="".concat(o,"px"),e.style.overflowY=o>=200?"auto":"hidden"}},0);return()=>clearTimeout(e)},[l,t]),(0,a.useEffect)(()=>{if(t.current){let e=t.current;e.style.height="auto",e.style.overflow="hidden";let s=parseInt(window.getComputedStyle(e).lineHeight),n=parseInt(window.getComputedStyle(e).paddingTop),a=parseInt(window.getComputedStyle(e).paddingBottom),r=parseInt(window.getComputedStyle(e).borderTopWidth),l=parseInt(window.getComputedStyle(e).borderBottomWidth),o=Math.min(Math.max(e.scrollHeight,s+n+a+r+l),200);e.style.height="".concat(o,"px"),e.style.overflowY=o>=200?"auto":"hidden"}},[t]),(0,a.useEffect)(()=>{if(t.current&&o&&l){let e=setTimeout(()=>{if(t.current){let e=t.current;e.style.height="auto";let s=Math.min(e.scrollHeight,200);e.style.height="".concat(s,"px"),e.style.overflowY=s>=200?"auto":"hidden"}},100);return()=>clearTimeout(e)}},[o,l,t]),(0,n.jsxs)(en.q7,{value:"text",className:"bg-gray-800/30 rounded-lg overflow-hidden","data-sentry-element":"Accordion.Item","data-sentry-component":"TextEditor","data-sentry-source-file":"TextEditor.tsx",children:[(0,n.jsx)(en.Y9,{"data-sentry-element":"Accordion.Header","data-sentry-source-file":"TextEditor.tsx",children:(0,n.jsxs)(en.l9,{"data-testid":"inspector-text-accordion",className:"w-full px-4 py-3 flex items-center justify-between text-left hover:bg-gray-800/50 transition-colors group","data-sentry-element":"Accordion.Trigger","data-sentry-source-file":"TextEditor.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(el.A,{className:"w-4 h-4 text-gray-400","data-sentry-element":"Type","data-sentry-source-file":"TextEditor.tsx"}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Text"})]}),(0,n.jsx)(eo.A,{className:"w-4 h-4 text-gray-400 transition-transform group-data-[state=open]:rotate-180","data-sentry-element":"ChevronDown","data-sentry-source-file":"TextEditor.tsx"})]})}),(0,n.jsx)(en.UC,{className:"data-[state=open]:animate-accordion-down data-[state=closed]:animate-accordion-up overflow-hidden","data-sentry-element":"Accordion.Content","data-sentry-source-file":"TextEditor.tsx",children:(0,n.jsx)("div",{className:"p-4 pt-3",children:(0,n.jsx)("textarea",{ref:t,"data-testid":"inspector-text-editor",value:l,onChange:e=>r(e.target.value),onKeyDown:e=>{if("Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),i(null),c(""),s&&s.contentWindow)){var t;null===(t=s.contentWindow)||void 0===t||t.postMessage({type:"editor-closed"},"*")}},className:"w-full px-2 py-1.5 bg-gray-800/50 border border-gray-600/50 rounded-lg text-white text-sm placeholder-gray-400 focus:ring-1 focus:ring-blue-500/50 focus:border-blue-500/50 transition-all resize-none overflow-hidden leading-normal",rows:1,placeholder:"Edit text..."})})})]})}var ec=s(74859),ed=s(24679),eu=s(25267),em=s(8998),eg=s(55588);let eh=[{value:"text-left",label:"Left",icon:(0,n.jsx)(ed.A,{className:"w-5 h-5"})},{value:"text-center",label:"Center",icon:(0,n.jsx)(eu.A,{className:"w-5 h-5"})},{value:"text-right",label:"Right",icon:(0,n.jsx)(em.A,{className:"w-5 h-5"})},{value:"text-justify",label:"Justify",icon:(0,n.jsx)(eg.A,{className:"w-5 h-5"})}];function ex(e){let{buildCurrentClassName:t,sendInstantStyleUpdate:s}=e,a=h(e=>e.selectedTextAlign),r=h(e=>e.selectedElement),l=h(e=>e.updateElementStyles),o=h(e=>e.setHasUnsavedChanges),i=h(e=>e.setPendingElementChange);return(0,n.jsxs)("div",{"data-sentry-component":"TextAlignment","data-sentry-source-file":"TextAlignment.tsx",children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Text Position"}),(0,n.jsx)("div",{className:"grid grid-cols-4 gap-1.5",children:eh.map(e=>{var c,d;return(0,n.jsxs)("button",{"data-testid":"text-align-".concat(e.label.toLowerCase()),onClick:()=>{let n=e.value;if(l({textAlign:n}),r){var a,c;let e=t({textAlign:n});s(r.uid,e),i(r.uid,(null===(a=r.textSource)||void 0===a?void 0:a.file)||(null===(c=r.mapping)||void 0===c?void 0:c.file)||r.path,{styleChanges:{textAlignClass:n}}),o(!0)}},className:"relative flex flex-col items-center justify-center p-2 h-14 rounded-lg transition-all ".concat(a===e.value||""===a&&(null==r?void 0:null===(d=r.styleData)||void 0===d?void 0:null===(c=d.className)||void 0===c?void 0:c.includes(e.value))?"bg-blue-500/30 text-blue-400 ring-1 ring-blue-500/50":"bg-gray-800/50 text-gray-500 hover:text-gray-300 hover:bg-gray-700/50"),title:e.label,children:[(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center",children:e.icon}),(0,n.jsx)("span",{className:"text-[9px] font-medium text-center mt-0.5",children:e.label})]},e.value)})})]})}let ep=["black","white","gray-500","red-500","blue-500","green-500","yellow-500","purple-500"],ef=e=>{switch(e){case"black":return"bg-black";case"white":return"bg-white";case"gray-500":return"bg-gray-500";case"red-500":return"bg-red-500";case"blue-500":return"bg-blue-500";case"green-500":return"bg-green-500";case"yellow-500":return"bg-yellow-500";case"purple-500":return"bg-purple-500";default:return""}};function eb(e){let{buildCurrentClassName:t,sendInstantStyleUpdate:s}=e,a=h(e=>e.selectedTextColor),r=h(e=>e.selectedElement),l=h(e=>e.updateElementStyles),o=h(e=>e.setHasUnsavedChanges),i=h(e=>e.setShowCustomColorPicker),c=h(e=>e.setCustomTextColor),d=h(e=>e.customTextColor),u=h(e=>e.setPendingElementChange);return(0,n.jsxs)("div",{className:"p-2 bg-gray-800/30 rounded-lg","data-sentry-component":"TextColor","data-sentry-source-file":"TextColor.tsx",children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-3 px-1",children:"Text Color"}),(0,n.jsxs)("div",{className:"grid grid-cols-6 gap-2 px-1",children:[a&&a.startsWith("text-[")&&(()=>{let e=a.slice(6,-1);return(0,n.jsx)("button",{"data-testid":"text-color-custom-selected",onClick:()=>{i(!0),c(a.slice(6,-1))},className:"w-8 h-8 rounded-lg border-2 transition-all border-blue-400 scale-110 shadow-lg shadow-blue-400/30 relative animate-fadeIn",style:{backgroundColor:e},title:"Custom: ".concat(e),children:(0,n.jsx)("svg",{className:"absolute inset-0 w-3 h-3 m-auto text-white mix-blend-difference",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})},"custom-selected")})(),ep.map(e=>{var i,c;return(0,n.jsx)("button",{"data-testid":"text-color-".concat(e),onClick:()=>{var n,a,i,c;let d="text-"+e;if(console.log("\uD83C\uDFA8 [TEXT-COLOR] Button clicked:",{color:e,newTextColor:d,hasSelectedElement:!!r,uid:null==r?void 0:r.uid,filePath:(null==r?void 0:null===(n=r.textSource)||void 0===n?void 0:n.file)||(null==r?void 0:null===(a=r.mapping)||void 0===a?void 0:a.file)||(null==r?void 0:r.path)}),l({textColor:d}),r){let e=(null===(i=r.textSource)||void 0===i?void 0:i.file)||(null===(c=r.mapping)||void 0===c?void 0:c.file)||r.path,n=t({textColor:d});console.log("\uD83C\uDFA8 [TEXT-COLOR] Updating element:",{uid:r.uid,filePath:e,newClassName:n,styleChange:{textColorClass:d}}),s(r.uid,n),console.log("\uD83C\uDFA8 [TEXT-COLOR] About to call setPendingElementChange..."),u(r.uid,e,{styleChanges:{textColorClass:d}}),console.log("\uD83C\uDFA8 [TEXT-COLOR] setPendingElementChange called successfully"),o(!0)}else console.error("\uD83C\uDFA8 [TEXT-COLOR] No selected element!")},className:"w-8 h-8 rounded-lg border-2 transition-all ".concat(a==="text-"+e||""===a&&(null==r?void 0:null===(c=r.styleData)||void 0===c?void 0:null===(i=c.className)||void 0===i?void 0:i.includes("text-"+e))?"border-blue-400 scale-110":"border-gray-600 hover:border-gray-400"," ").concat(ef(e))},e)}),(0,n.jsx)("button",{"data-testid":"text-color-custom",onClick:()=>{i(!0),a&&a.startsWith("text-[#")?c(a.slice(6,-1)):d&&"#000000"!==d||c("#3B82F6")},className:"relative w-8 h-8 rounded-lg border-2 transition-all flex items-center justify-center group overflow-hidden border-gray-600 hover:border-gray-400 hover:scale-105",style:{background:"conic-gradient(from 180deg at 50% 50%, #ff0000 0deg, #ff8800 45deg, #ffd700 90deg, #00ff00 135deg, #00ffff 180deg, #0000ff 225deg, #8800ff 270deg, #ff00ff 315deg, #ff0000 360deg)"},title:"Pick custom color",children:(0,n.jsx)("div",{className:"absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-colors flex items-center justify-center",children:(0,n.jsx)("svg",{className:"w-4 h-4 text-white drop-shadow-lg",fill:"none",stroke:"currentColor",strokeWidth:2.5,viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"TextColor.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4","data-sentry-element":"path","data-sentry-source-file":"TextColor.tsx"})})})})]})]})}let ey=["text-xs","text-sm","text-base","text-lg","text-xl","text-2xl","text-3xl","text-4xl","text-5xl","text-6xl"];function ev(e){let{buildCurrentClassName:t,sendInstantStyleUpdate:s}=e,a=h(e=>e.selectedTextSize),r=h(e=>e.selectedElement),l=h(e=>e.updateElementStyles),o=h(e=>e.setHasUnsavedChanges),i=h(e=>e.setPendingElementChange);return(0,n.jsxs)("div",{className:"p-2 bg-gray-800/30 rounded-lg","data-sentry-component":"TextSize","data-sentry-source-file":"TextSize.tsx",children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-3 px-1",children:"Font Size"}),(0,n.jsxs)("div",{className:"flex items-center justify-between px-1",children:[(0,n.jsx)("button",{onClick:()=>{var e,n,c,d;console.log("\uD83C\uDFA8 [TEXT-SIZE] handleDecrease called, selectedElement:",r);let u=ey.indexOf(a||"text-base");if(u>0){let a=ey[u-1];if(l({textSize:a}),r){let l=t({textSize:a});s(r.uid,l),i(r.uid,(null===(e=r.textSource)||void 0===e?void 0:e.file)||(null===(n=r.mapping)||void 0===n?void 0:n.file)||r.path,{styleChanges:{textSizeClass:a}}),o(!0)}}else if(-1===u){let e="text-4xl";if(l({textSize:e}),r){let n=t({textSize:e});s(r.uid,n),i(r.uid,(null===(c=r.textSource)||void 0===c?void 0:c.file)||(null===(d=r.mapping)||void 0===d?void 0:d.file)||r.path,{styleChanges:{textSizeClass:e}}),o(!0)}}},className:"p-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:"text-xs"===a,children:(0,n.jsx)("svg",{className:"w-4 h-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"TextSize.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4","data-sentry-element":"path","data-sentry-source-file":"TextSize.tsx"})})}),(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)("span",{className:"font-medium text-gray-300 transition-all ".concat((()=>{switch(a){case"text-xs":return"text-xs";case"text-sm":return"text-sm";case"text-base":default:return"text-base";case"text-lg":return"text-lg";case"text-xl":return"text-xl";case"text-2xl":return"text-2xl";case"text-3xl":return"text-3xl";case"text-4xl":return"text-4xl";case"text-5xl":return"text-5xl";case"text-6xl":return"text-6xl"}})()),children:"Aa"})}),(0,n.jsx)("button",{onClick:()=>{var e,n,c,d;let u=ey.indexOf(a||"text-base");if(u<ey.length-1&&-1!==u){let a=ey[u+1];if(l({textSize:a}),r){let l=t({textSize:a});s(r.uid,l),i(r.uid,(null===(e=r.textSource)||void 0===e?void 0:e.file)||(null===(n=r.mapping)||void 0===n?void 0:n.file)||r.path,{styleChanges:{textSizeClass:a}}),o(!0)}}else if(-1===u){let e="text-6xl";if(l({textSize:e}),r){let n=t({textSize:e});s(r.uid,n),i(r.uid,(null===(c=r.textSource)||void 0===c?void 0:c.file)||(null===(d=r.mapping)||void 0===d?void 0:d.file)||r.path,{styleChanges:{textSizeClass:e}}),o(!0)}}},className:"p-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:"text-6xl"===a,children:(0,n.jsx)("svg",{className:"w-4 h-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"TextSize.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4","data-sentry-element":"path","data-sentry-source-file":"TextSize.tsx"})})})]})]})}let ej=["transparent","white","gray-100","gray-500","gray-900","red-500","blue-500","green-500","yellow-500","purple-500"],ew=e=>{switch(e){case"transparent":return"bg-transparent border-2 border-dashed border-gray-500";case"white":return"bg-white";case"gray-100":return"bg-gray-100";case"gray-500":return"bg-gray-500";case"gray-900":return"bg-gray-900";case"red-500":return"bg-red-500";case"blue-500":return"bg-blue-500";case"green-500":return"bg-green-500";case"yellow-500":return"bg-yellow-500";case"purple-500":return"bg-purple-500";default:return""}};function eN(e){let{buildCurrentClassName:t,sendInstantStyleUpdate:s}=e,a=h(e=>e.selectedBgColor),r=h(e=>e.selectedElement),l=h(e=>e.updateElementStyles),o=h(e=>e.setHasUnsavedChanges),i=h(e=>e.setShowCustomColorPicker),c=h(e=>e.setCustomTextColor),d=h(e=>e.setPendingElementChange),u=h(e=>e.customTextColor);return(0,n.jsxs)("div",{className:"p-2 bg-gray-800/30 rounded-lg","data-sentry-component":"BackgroundColor","data-sentry-source-file":"BackgroundColor.tsx",children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-3 px-1",children:"Background Color"}),(0,n.jsxs)("div",{className:"grid grid-cols-5 gap-2 px-1",children:[a&&a.startsWith("bg-[")&&(()=>{let e=a.slice(4,-1);return(0,n.jsx)("button",{"data-testid":"bg-color-custom-selected",onClick:()=>{i(!0),c(a.slice(4,-1))},className:"w-8 h-8 rounded-lg border-2 transition-all border-blue-400 scale-110 shadow-lg shadow-blue-400/30 relative animate-fadeIn",style:{backgroundColor:e},title:"Custom Background: ".concat(e),children:(0,n.jsx)("svg",{className:"absolute inset-0 w-3 h-3 m-auto text-white mix-blend-difference",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})},"custom-selected")})(),ej.map(e=>{var i,c;return(0,n.jsx)("button",{"data-testid":"bg-color-".concat(e),onClick:()=>{var n,a,i,c;let u="bg-"+e;if(console.log("\uD83C\uDFA8 [BG-COLOR] Button clicked:",{color:e,newBgColor:u,hasSelectedElement:!!r,uid:null==r?void 0:r.uid,filePath:(null==r?void 0:null===(n=r.textSource)||void 0===n?void 0:n.file)||(null==r?void 0:null===(a=r.mapping)||void 0===a?void 0:a.file)||(null==r?void 0:r.path)}),l({bgColor:u}),r){let e=(null===(i=r.textSource)||void 0===i?void 0:i.file)||(null===(c=r.mapping)||void 0===c?void 0:c.file)||r.path,n=t({bgColor:u});console.log("\uD83C\uDFA8 [BG-COLOR] Updating element:",{uid:r.uid,filePath:e,newClassName:n,styleChange:{bgColorClass:u}}),s(r.uid,n),console.log("\uD83C\uDFA8 [BG-COLOR] About to call setPendingElementChange..."),d(r.uid,e,{styleChanges:{bgColorClass:u}}),console.log("\uD83C\uDFA8 [BG-COLOR] setPendingElementChange called successfully"),o(!0)}else console.error("\uD83C\uDFA8 [BG-COLOR] No selected element!")},className:"w-8 h-8 rounded-lg border-2 transition-all ".concat(a==="bg-"+e||""===a&&(null==r?void 0:null===(c=r.styleData)||void 0===c?void 0:null===(i=c.className)||void 0===i?void 0:i.includes("bg-"+e))?"border-blue-400 scale-110":"border-gray-600 hover:border-gray-400"," ").concat(ew(e)),title:"transparent"===e?"Transparent":"Background ".concat(e),children:"transparent"===e&&(0,n.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,n.jsx)("span",{className:"text-gray-400 text-xs font-bold",children:"∅"})})},e)}),(0,n.jsx)("button",{"data-testid":"bg-color-custom",onClick:()=>{i(!0),a&&a.startsWith("bg-[#")?c(a.slice(4,-1)):u&&"#000000"!==u||c("#3B82F6")},className:"relative w-8 h-8 rounded-lg border-2 transition-all flex items-center justify-center group overflow-hidden border-gray-600 hover:border-gray-400 hover:scale-105",style:{background:"conic-gradient(from 180deg at 50% 50%, #ff0000 0deg, #ff8800 45deg, #ffd700 90deg, #00ff00 135deg, #00ffff 180deg, #0000ff 225deg, #8800ff 270deg, #ff00ff 315deg, #ff0000 360deg)"},title:"Pick custom background color",children:(0,n.jsx)("div",{className:"absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-colors flex items-center justify-center",children:(0,n.jsx)("svg",{className:"w-4 h-4 text-white drop-shadow-lg",fill:"none",stroke:"currentColor",strokeWidth:2.5,viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"BackgroundColor.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4","data-sentry-element":"path","data-sentry-source-file":"BackgroundColor.tsx"})})})})]})]})}var ek=s(30489),eC=s(34624),eS=s(36703),eE=s(34117),eT=s(75936),eI=s(96510),eA=s(26451),eD=s(10929);function eP(e){if(!e||!e.startsWith("bg-[url("))return"";let t=e.match(/^bg-\[url\('(.+)'\)\]$/);return t&&t[1]?t[1].replace(/\\'/g,"'"):""}let eM=[{name:"Linear Blue",class:"bg-gradient-to-r from-blue-400 to-blue-600"},{name:"Linear Purple",class:"bg-gradient-to-r from-purple-400 to-purple-600"},{name:"Linear Green",class:"bg-gradient-to-r from-green-400 to-green-600"},{name:"Sunset",class:"bg-gradient-to-r from-orange-400 via-red-500 to-pink-500"},{name:"Ocean",class:"bg-gradient-to-r from-cyan-400 to-blue-500"},{name:"Forest",class:"bg-gradient-to-r from-green-400 to-green-600"}],eL=[{name:"Cover",class:"bg-cover"},{name:"Contain",class:"bg-contain"},{name:"Auto",class:"bg-auto"}],eO=[{name:"Center",class:"bg-center"},{name:"Top",class:"bg-top"},{name:"Bottom",class:"bg-bottom"},{name:"Left",class:"bg-left"},{name:"Right",class:"bg-right"}];function eR(e){let{buildCurrentClassName:t,sendInstantStyleUpdate:s,sendInstantBackgroundUpdate:r}=e,[l,o]=(0,a.useState)([]),[i,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(""),[m,g]=(0,a.useState)("images"),[x,p]=(0,a.useState)(""),[f,b]=(0,a.useState)("bg-cover"),[y,j]=(0,a.useState)("bg-center"),[w,N]=(0,a.useState)(!1),[k,C]=(0,a.useState)(!1),[S,E]=(0,a.useState)(null),T=h(e=>e.setPendingElementChange),[I,A]=(0,a.useState)(!1),D=(0,a.useRef)(null),P=h(e=>e.selectedElement),M=h(e=>e.setHasUnsavedChanges);(0,a.useEffect)(()=>{if(P){var e,t;let s=(null===(t=P.styleData)||void 0===t?void 0:null===(e=t.className)||void 0===e?void 0:e.split(" "))||[],n=s.find(e=>e.startsWith("bg-[url(")||e.startsWith("bg-gradient-"))||"",a=s.find(e=>eL.some(t=>t.class===e))||"bg-cover",r=s.find(e=>eO.some(t=>t.class===e))||"bg-center";p(n),b(a),j(r)}},[P]);let L=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";c(!0);try{let t=new URLSearchParams;e&&t.append("search",e),t.append("limit","20");let s=await fetch("/api/user/images?".concat(t));if(!s.ok)throw 401===s.status?v.oR.error("Please log in to access your images"):v.oR.error("Failed to load your images"),Error("HTTP ".concat(s.status,": Failed to fetch images"));let n=await s.json();n&&Array.isArray(n.images)?o(n.images):o([])}catch(e){console.error("Error fetching user images:",e),o([])}finally{c(!1)}},[]);(0,a.useEffect)(()=>{L(d)},[L,d]);let O=(0,a.useCallback)(e=>{u(e),L(e)},[L]),R=(0,a.useCallback)((e,n,a)=>{var l,o;if(!P)return;let i={},c=e||x,d=n||f,u=a||y;if(void 0!==e&&(i.bgImageClass=e,p(e)),n&&(i.bgSizeClass=n,b(n)),a&&(i.bgPositionClass=a,j(a)),c&&!c.startsWith("bg-gradient-"))r(P.uid,c,d,u);else{let e=t({bgImage:c,bgSize:d,bgPosition:u});s(P.uid,e)}let{updateElementStyles:m}=h.getState();m({bgImage:c,bgSize:d,bgPosition:u}),T(P.uid,(null===(l=P.textSource)||void 0===l?void 0:l.file)||(null===(o=P.mapping)||void 0===o?void 0:o.file)||P.path,{styleChanges:i}),M(!0)},[P,x,f,y,t,s,r,T,M]),F=(0,a.useCallback)(e=>{var n,a;if(!P)return;let r=function(e){if(!e||"string"!=typeof e)return"";try{new URL(e)}catch(t){if(!e.startsWith("/")&&!e.startsWith("./")&&!e.startsWith("../"))return console.warn("Invalid URL format for background image:",e),""}let t=e;return(t=t.replace(/'/g,"\\'")).includes("javascript:")||t.includes("data:text/html")?(console.error("Blocked potentially malicious URL:",e),""):"bg-[url('".concat(t,"')]")}(e);if(!r){v.oR.error("Invalid image URL");return}p(r);let{updateElementStyles:l}=h.getState();l({bgImage:r});let o=t({bgImage:r,bgSize:f,bgPosition:y});s(P.uid,o),T(P.uid,(null===(n=P.textSource)||void 0===n?void 0:n.file)||(null===(a=P.mapping)||void 0===a?void 0:a.file)||P.path,{styleChanges:{bgImageClass:r,bgSizeClass:f,bgPositionClass:y}}),M(!0)},[P,f,y,t,s,T,M]),B=(0,a.useCallback)(e=>{var n,a;if(!P)return;p(e);let{updateElementStyles:r}=h.getState();r({bgImage:e});let l=t({bgImage:e,bgSize:f,bgPosition:y});s(P.uid,l),T(P.uid,(null===(n=P.textSource)||void 0===n?void 0:n.file)||(null===(a=P.mapping)||void 0===a?void 0:a.file)||P.path,{styleChanges:{bgImageClass:e,bgSizeClass:f,bgPositionClass:y}}),M(!0)},[P,f,y,t,s,T,M]),U=(0,a.useCallback)(()=>{var e,t;if(!P)return;p("");let{updateElementStyles:s}=h.getState();s({bgImage:""}),r(P.uid,"",f,y),T(P.uid,(null===(e=P.textSource)||void 0===e?void 0:e.file)||(null===(t=P.mapping)||void 0===t?void 0:t.file)||P.path,{styleChanges:{backgroundImage:"",bgSizeClass:f,bgPositionClass:y}}),M(!0)},[P,f,y,r,T,M]),z=(0,a.useCallback)(e=>{e.length>0&&(F(e[0]),N(!1),L(d),v.oR.success("Image uploaded and applied as background"))},[F,L,d]),W=(0,a.useCallback)((e,t)=>{t.stopPropagation(),E(e),C(!0)},[]),_=(0,a.useCallback)(async()=>{if(S){A(!0);try{let e=await fetch("/api/user/images/".concat(S.id),{method:"DELETE"});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to delete image")}eP(x)===S.fileUrl&&U(),o(e=>e.filter(e=>e.id!==S.id)),v.oR.success("Image deleted successfully"),C(!1),E(null)}catch(e){console.error("Error deleting image:",e),v.oR.error(e instanceof Error?e.message:"Failed to delete image")}finally{A(!1)}}},[S,x,U]),H=(0,a.useCallback)(()=>{C(!1),E(null)},[]);return(0,n.jsxs)("div",{className:"p-2 bg-gray-800/30 rounded-lg","data-sentry-component":"BackgroundImage","data-sentry-source-file":"BackgroundImage.tsx",children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-3 px-1",children:"Background Image"}),(0,n.jsxs)("div",{className:"flex mb-3 bg-gray-700/50 rounded-lg p-1",children:[(0,n.jsxs)("button",{onClick:()=>g("images"),className:"flex-1 px-3 py-1.5 text-xs font-medium rounded-md transition-colors ".concat("images"===m?"bg-blue-600 text-white":"text-gray-400 hover:text-gray-300"),children:[(0,n.jsx)(ek.A,{className:"w-3 h-3 inline mr-1","data-sentry-element":"Image","data-sentry-source-file":"BackgroundImage.tsx"}),"Images"]}),(0,n.jsxs)("button",{onClick:()=>g("gradients"),className:"flex-1 px-3 py-1.5 text-xs font-medium rounded-md transition-colors ".concat("gradients"===m?"bg-blue-600 text-white":"text-gray-400 hover:text-gray-300"),children:[(0,n.jsx)(ec.A,{className:"w-3 h-3 inline mr-1","data-sentry-element":"Palette","data-sentry-source-file":"BackgroundImage.tsx"}),"Gradients"]})]}),x&&(0,n.jsxs)("div",{className:"mb-3 p-2 bg-gray-700/30 rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.jsx)("span",{className:"text-xs text-gray-400",children:"Current Background"}),(0,n.jsx)("button",{onClick:U,className:"text-red-400 hover:text-red-300 p-1",title:"Clear background",children:(0,n.jsx)(eC.A,{className:"w-3 h-3"})})]}),(0,n.jsx)("div",{className:"w-full h-12 rounded-md ".concat(x.startsWith("bg-gradient-")?x:""," ").concat(f," ").concat(y),style:x&&!x.startsWith("bg-gradient-")?{backgroundImage:"url('".concat(x,"')"),backgroundSize:f.replace("bg-",""),backgroundPosition:y.replace("bg-","")}:{}})]}),"images"===m?(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("button",{onClick:()=>N(!0),className:"w-full bg-white/5 hover:bg-white/10 border-2 border-dashed border-gray-600 hover:border-gray-500 rounded-lg p-4 transition-all group",children:[(0,n.jsx)(eS.A,{className:"w-4 h-4 mx-auto mb-1 text-gray-400 group-hover:text-gray-300"}),(0,n.jsx)("div",{className:"text-xs text-gray-300 font-medium",children:"Upload New Image"}),(0,n.jsx)("div",{className:"text-xs text-gray-500 mt-0.5",children:"JPG, PNG, GIF up to 10MB"})]}),l.length>6&&(0,n.jsx)("input",{type:"text",value:d,onChange:e=>O(e.target.value),placeholder:"Search images...",className:"w-full px-3 py-2 bg-gray-700/50 border border-gray-600/50 rounded-lg text-white placeholder-gray-500 text-xs focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50 transition-colors"}),i?(0,n.jsx)("div",{className:"flex items-center justify-center py-6",children:(0,n.jsx)("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"})}):l.length>0?(0,n.jsx)("div",{className:"grid grid-cols-3 gap-2 max-h-40 overflow-y-auto",children:l.map(e=>(0,n.jsxs)("button",{onClick:()=>F(e.fileUrl),className:"relative aspect-square rounded-md overflow-hidden transition-all group ".concat(eP(x)===e.fileUrl?"ring-2 ring-blue-500":"hover:ring-2 hover:ring-white/30"),title:e.altText||e.filename,children:[(0,n.jsx)("img",{src:e.fileUrl,alt:e.altText||e.filename,className:"w-full h-full object-cover"}),(0,n.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-all"}),(0,n.jsx)("button",{onClick:t=>W(e,t),className:"absolute top-1 right-1 bg-red-500 hover:bg-red-600 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-all z-10",title:"Delete image",children:(0,n.jsx)(eE.A,{className:"w-2.5 h-2.5"})}),eP(x)===e.fileUrl&&(0,n.jsx)("div",{className:"absolute inset-0 bg-blue-500/30 flex items-center justify-center",children:(0,n.jsx)(eT.A,{className:"w-4 h-4 text-white drop-shadow-lg"})})]},e.id))}):(0,n.jsxs)("div",{className:"text-center py-6 text-gray-500",children:[(0,n.jsx)(eI.A,{className:"w-6 h-6 mx-auto mb-2 opacity-50"}),(0,n.jsx)("div",{className:"text-xs",children:"No images yet"}),(0,n.jsx)("div",{className:"text-xs mt-1 opacity-70",children:d?"No images match your search":"Upload images in the main interface"})]})]}):(0,n.jsx)("div",{className:"grid grid-cols-2 gap-2",children:eM.map(e=>(0,n.jsxs)("button",{onClick:()=>B(e.class),className:"relative h-12 rounded-md overflow-hidden transition-all ".concat(x===e.class?"ring-2 ring-blue-500":"hover:ring-2 hover:ring-white/30"," ").concat(e.class),title:e.name,children:[(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:x===e.class&&(0,n.jsx)(eT.A,{className:"w-4 h-4 text-white drop-shadow-lg"})}),(0,n.jsx)("div",{className:"absolute bottom-1 left-1 right-1",children:(0,n.jsx)("div",{className:"bg-black/50 text-white text-xs px-1 py-0.5 rounded text-center",children:e.name})})]},e.name))}),x&&"images"===m&&(0,n.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-700/50 space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)(eA.A,{className:"w-3 h-3 text-gray-400"}),(0,n.jsx)("span",{className:"text-xs text-gray-400",children:"Background Settings"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Size"}),(0,n.jsx)("div",{className:"grid grid-cols-3 gap-1",children:eL.map(e=>(0,n.jsx)("button",{onClick:()=>R(x,e.class),className:"px-2 py-1 text-xs rounded border transition-colors ".concat(f===e.class?"border-blue-500 bg-blue-500/20 text-blue-300":"border-gray-600 text-gray-400 hover:border-gray-500"),children:e.name},e.name))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Position"}),(0,n.jsx)("div",{className:"grid grid-cols-3 gap-1",children:eO.map(e=>(0,n.jsx)("button",{onClick:()=>R(x,f,e.class),className:"px-2 py-1 text-xs rounded border transition-colors ".concat(y===e.class?"border-blue-500 bg-blue-500/20 text-blue-300":"border-gray-600 text-gray-400 hover:border-gray-500"),children:e.name},e.name))})]})]}),w&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-gray-900 rounded-lg w-full max-w-md p-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Upload Background Image"}),(0,n.jsx)("button",{onClick:()=>N(!1),className:"p-1 hover:bg-gray-800 rounded-lg transition-colors",children:(0,n.jsx)(eC.A,{className:"w-5 h-5 text-gray-400"})})]}),(0,n.jsx)(eD.A,{ref:D,onImagesUploaded:z,maxFiles:1,showPreview:!0})]})}),k&&S&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-gray-900 rounded-lg w-full max-w-md p-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Delete Image"}),(0,n.jsx)("button",{onClick:H,className:"p-1 hover:bg-gray-800 rounded-lg transition-colors",disabled:I,children:(0,n.jsx)(eC.A,{className:"w-5 h-5 text-gray-400"})})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("div",{className:"relative bg-white/5 rounded-xl p-3 max-h-32 overflow-hidden",children:(0,n.jsx)("img",{src:S.fileUrl,alt:S.altText||S.filename,className:"w-full h-auto max-h-24 object-contain rounded-lg"})}),(0,n.jsx)("div",{className:"text-sm text-gray-300 mt-2 truncate",children:S.filename})]}),(0,n.jsx)("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4 mb-4",children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)(eE.A,{className:"w-5 h-5 text-red-400"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-sm font-medium text-red-300",children:"This action cannot be undone"}),(0,n.jsx)("div",{className:"text-sm text-red-400 mt-1",children:"This will permanently delete the image from your account."})]})]})}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("button",{onClick:H,disabled:I,className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,n.jsx)("button",{onClick:_,disabled:I,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:I?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Deleting..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eE.A,{className:"w-4 h-4"}),"Delete"]})})]})]})})]})}let eF=[{name:"0",class:""},{name:"XS",class:"p-1"},{name:"S",class:"p-2"},{name:"M",class:"p-4"},{name:"L",class:"p-6"},{name:"XL",class:"p-8"}],eB=[{name:"0",class:""},{name:"XS",class:"m-1"},{name:"S",class:"m-2"},{name:"M",class:"m-4"},{name:"L",class:"m-6"},{name:"XL",class:"m-8"}];function eU(e){let{buildCurrentClassName:t,sendInstantStyleUpdate:s}=e,a=h(e=>e.selectedPadding),r=h(e=>e.selectedMargin),l=h(e=>e.selectedElement),o=h(e=>e.updateElementStyles),i=h(e=>e.setHasUnsavedChanges),c=h(e=>e.setPendingElementChange),d=e=>{if(o({padding:e}),l){var n,a;let r=t({padding:e});s(l.uid,r),c(l.uid,(null===(n=l.textSource)||void 0===n?void 0:n.file)||(null===(a=l.mapping)||void 0===a?void 0:a.file)||l.path,{styleChanges:{paddingClass:e}}),i(!0)}},u=e=>{if(o({margin:e}),l){var n,a;let r=t({margin:e});s(l.uid,r),c(l.uid,(null===(n=l.textSource)||void 0===n?void 0:n.file)||(null===(a=l.mapping)||void 0===a?void 0:a.file)||l.path,{styleChanges:{marginClass:e}}),i(!0)}};return(0,n.jsxs)("div",{className:"p-2 bg-gray-800/30 rounded-lg space-y-4","data-sentry-component":"SpacingControls","data-sentry-source-file":"SpacingControls.tsx",children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-400 mb-3 px-1",children:"Spacing"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-500 mb-2",children:"Padding"}),(0,n.jsx)("div",{className:"grid grid-cols-6 gap-1",children:eF.map(e=>{var t,s;return(0,n.jsx)("button",{"data-testid":"padding-".concat(e.name.toLowerCase()),onClick:()=>d(e.class),className:"px-2 py-1.5 text-xs font-medium rounded border transition-colors ".concat(a!==e.class&&(""!==a||""!==e.class||(null==l?void 0:null===(s=l.styleData)||void 0===s?void 0:null===(t=s.className)||void 0===t?void 0:t.includes("p-")))?"border-gray-600 text-gray-400 hover:border-gray-500 hover:text-gray-300":"border-blue-500 bg-blue-500/20 text-blue-300"),title:"Padding ".concat(e.name).concat(e.class?" (".concat(e.class,")"):""),children:e.name},e.name)})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-500 mb-2",children:"Margin"}),(0,n.jsx)("div",{className:"grid grid-cols-6 gap-1",children:eB.map(e=>{var t,s;return(0,n.jsx)("button",{"data-testid":"margin-".concat(e.name.toLowerCase()),onClick:()=>u(e.class),className:"px-2 py-1.5 text-xs font-medium rounded border transition-colors ".concat(r!==e.class&&(""!==r||""!==e.class||(null==l?void 0:null===(s=l.styleData)||void 0===s?void 0:null===(t=s.className)||void 0===t?void 0:t.includes("m-")))?"border-gray-600 text-gray-400 hover:border-gray-500 hover:text-gray-300":"border-blue-500 bg-blue-500/20 text-blue-300"),title:"Margin ".concat(e.name).concat(e.class?" (".concat(e.class,")"):""),children:e.name},e.name)})})]})]})}function ez(e){let{buildCurrentClassName:t,sendInstantStyleUpdate:s,sendInstantBackgroundUpdate:a}=e,r=h(e=>e.selectedElement),l=(null==r?void 0:r.text)&&r.text.trim().length>0;return(0,n.jsxs)(en.q7,{value:"styles",className:"bg-gray-800/30 rounded-lg overflow-hidden","data-sentry-element":"Accordion.Item","data-sentry-component":"StylesPanel","data-sentry-source-file":"StylesPanel.tsx",children:[(0,n.jsx)(en.Y9,{"data-sentry-element":"Accordion.Header","data-sentry-source-file":"StylesPanel.tsx",children:(0,n.jsxs)(en.l9,{"data-testid":"inspector-style-accordion",className:"w-full px-4 py-3 flex items-center justify-between text-left hover:bg-gray-800/50 transition-colors group","data-sentry-element":"Accordion.Trigger","data-sentry-source-file":"StylesPanel.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(ec.A,{className:"w-4 h-4 text-gray-400","data-sentry-element":"Palette","data-sentry-source-file":"StylesPanel.tsx"}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Styles"})]}),(0,n.jsx)(eo.A,{className:"w-4 h-4 text-gray-400 transition-transform group-data-[state=open]:rotate-180","data-sentry-element":"ChevronDown","data-sentry-source-file":"StylesPanel.tsx"})]})}),(0,n.jsx)(en.UC,{className:"data-[state=open]:animate-accordion-down data-[state=closed]:animate-accordion-up overflow-hidden","data-sentry-element":"Accordion.Content","data-sentry-source-file":"StylesPanel.tsx",children:(0,n.jsxs)("div",{className:"p-4 pt-3 space-y-3",children:[l&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ex,{buildCurrentClassName:t,sendInstantStyleUpdate:s}),(0,n.jsx)(eb,{buildCurrentClassName:t,sendInstantStyleUpdate:s}),(0,n.jsx)(ev,{buildCurrentClassName:t,sendInstantStyleUpdate:s})]}),(0,n.jsx)(eN,{buildCurrentClassName:t,sendInstantStyleUpdate:s,"data-sentry-element":"BackgroundColor","data-sentry-source-file":"StylesPanel.tsx"}),(0,n.jsx)(eR,{buildCurrentClassName:t,sendInstantStyleUpdate:s,sendInstantBackgroundUpdate:a,"data-sentry-element":"BackgroundImage","data-sentry-source-file":"StylesPanel.tsx"}),(0,n.jsx)(eU,{buildCurrentClassName:t,sendInstantStyleUpdate:s,"data-sentry-element":"SpacingControls","data-sentry-source-file":"StylesPanel.tsx"})]})})]})}var eW=s(7612);let e_=["#000000","#FFFFFF","#EF4444","#3B82F6","#10B981","#F59E0B","#8B5CF6","#EC4899"];function eH(e){let{buildCurrentClassName:t,sendInstantStyleUpdate:s}=e,a=h(e=>e.showCustomColorPicker),r=h(e=>e.setShowCustomColorPicker),l=h(e=>e.customTextColor),o=h(e=>e.setPendingElementChange),i=h(e=>e.setCustomTextColor),c=h(e=>e.applyCustomTextColor),d=h(e=>e.selectedElement),u=h(e=>e.setHasUnsavedChanges);return a?(0,n.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 animate-fadeIn",onClick:e=>{e.target===e.currentTarget&&r(!1)},"data-sentry-component":"CustomColorPicker","data-sentry-source-file":"CustomColorPicker.tsx",children:(0,n.jsxs)("div",{"data-testid":"custom-color-picker-modal",className:"bg-gray-900/95 backdrop-blur rounded-2xl p-5 w-80 shadow-2xl border border-gray-700/50 animate-slideUp",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-5",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"w-8 h-8 rounded-lg",style:{backgroundColor:l}}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-sm font-semibold text-gray-100",children:"Custom Color"}),(0,n.jsx)("p",{className:"text-xs text-gray-400",children:"Choose any color"})]})]}),(0,n.jsx)("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-200 hover:bg-gray-800 p-1 rounded-lg transition-colors",children:(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"CustomColorPicker.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12","data-sentry-element":"path","data-sentry-source-file":"CustomColorPicker.tsx"})})})]}),(0,n.jsx)("div",{className:"mb-4 rounded-xl overflow-hidden",children:(0,n.jsx)(eW.jI,{color:l,onChange:e=>{e&&i(e)},style:{width:"100%",height:"200px"},"data-sentry-element":"HexColorPicker","data-sentry-source-file":"CustomColorPicker.tsx"})}),(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,n.jsx)("span",{className:"text-gray-500 text-sm",children:"#"})}),(0,n.jsx)("input",{type:"text",placeholder:"#8B5CF6",value:l.replace("#",""),onChange:e=>{let t=e.target.value;/^[0-9A-Fa-f]{0,6}$/.test(t)&&i("#"+t)},className:"w-full pl-8 pr-3 py-2 text-sm border border-gray-700 rounded-lg bg-gray-800/50 text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",maxLength:6}),(0,n.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,n.jsx)("div",{className:"w-5 h-5 rounded border border-gray-600",style:{backgroundColor:l}})})]})}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"Quick colors"}),(0,n.jsx)("div",{className:"flex gap-1",children:e_.map(e=>(0,n.jsx)("button",{onClick:()=>i(e),className:"w-7 h-7 rounded-md border border-gray-700 hover:scale-110 transition-transform",style:{backgroundColor:e}},e))})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>r(!1),className:"flex-1 px-3 py-2 text-sm text-gray-400 hover:text-gray-200 hover:bg-gray-800 rounded-lg transition-all",children:"Cancel"}),(0,n.jsx)("button",{onClick:()=>{c();let e=h.getState(),n="text-[".concat(e.customTextColor,"]");if(d){var a,l;let e=t({textColor:n});s(d.uid,e),o(d.uid,(null===(a=d.textSource)||void 0===a?void 0:a.file)||(null===(l=d.mapping)||void 0===l?void 0:l.file)||d.path,{styleChanges:{textColorClass:n}}),u(!0)}r(!1)},className:"flex-1 px-3 py-2 text-sm bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-all font-medium",children:"Apply"})]})]})}):null}function eG(e){let{selectedElement:t,sendInstantStyleUpdate:s,sendInstantImageUpdate:r}=e,[l,o]=(0,a.useState)([]),[i,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1),[m,g]=(0,a.useState)(""),[x,p]=(0,a.useState)(""),[f,b]=(0,a.useState)({alt:"",title:"",src:""}),[y,j]=(0,a.useState)(!1),[w,N]=(0,a.useState)(null),[k,C]=(0,a.useState)(!1),S=(0,a.useRef)(null),E=h(e=>e.setPendingElementChange);(0,a.useEffect)(()=>{if(t)try{var e,s,n,a,r,l,o,i,c;let d=(null===(e=t.styleData)||void 0===e?void 0:e.src)||t.text||(null===(n=t.innerHTML)||void 0===n?void 0:null===(s=n.match(/src="([^"]+)"/))||void 0===s?void 0:s[1])||"",u=(null===(a=t.styleData)||void 0===a?void 0:a.alt)||(null===(l=t.innerHTML)||void 0===l?void 0:null===(r=l.match(/alt="([^"]+)"/))||void 0===r?void 0:r[1])||"",m=(null===(o=t.styleData)||void 0===o?void 0:o.title)||(null===(c=t.innerHTML)||void 0===c?void 0:null===(i=c.match(/title="([^"]+)"/))||void 0===i?void 0:i[1])||"";b({src:d,alt:u,title:m}),p(d)}catch(e){console.error("Error extracting image metadata:",e),b({src:"",alt:"",title:""}),p("")}},[t]);let T=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";c(!0);try{let t=new URLSearchParams;e&&t.append("search",e),t.append("limit","50");let s=await fetch("/api/user/images?".concat(t));if(!s.ok)throw 401===s.status?v.oR.error("Please log in to access your images"):500===s.status?v.oR.error("Server error while loading images"):v.oR.error("Failed to load your images"),Error("HTTP ".concat(s.status,": Failed to fetch images"));let n=await s.json();if(!n||!Array.isArray(n.images)){console.warn("Invalid response format from /api/user/images:",n),o([]);return}o(n.images)}catch(e){console.error("Error fetching user images:",e),o([]),e instanceof Error&&!e.message.includes("HTTP")&&v.oR.error("Network error while loading images")}finally{c(!1)}},[]);(0,a.useEffect)(()=>{T(m)},[T,m]);let I=(0,a.useCallback)(e=>{g(e),T(e)},[T]),A=(0,a.useCallback)(e=>{try{if(!e||"string"!=typeof e){v.oR.error("Invalid image URL");return}if(p(e),b(t=>({...t,src:e})),t){var s,n;console.log("\uD83D\uDDBC️ [IMAGE-EDITOR] Updating image src:",{selectedElement:t,imageUrl:e,uid:t.uid,tagName:t.tagName});let a=E(t.uid,(null===(s=t.textSource)||void 0===s?void 0:s.file)||(null===(n=t.mapping)||void 0===n?void 0:n.file)||t.path,{styleChanges:{src:e}});if(console.log("\uD83D\uDDBC️ [IMAGE-EDITOR] Update result:",a),!a||!1===a||"object"==typeof a&&!a.success){console.error("\uD83D\uDDBC️ [IMAGE-EDITOR] Failed to update image:",a),v.oR.error("Failed to update image");return}r(t.uid,e)}else{v.oR.error("No element selected");return}}catch(e){console.error("Error selecting image:",e),v.oR.error("Failed to select image")}},[t,E,r]);(0,a.useCallback)((e,s)=>{try{if(!e||"string"!=typeof e){console.error("Invalid field name for metadata change:",e);return}if(b(t=>({...t,[e]:s})),t){var n,a;let r={};r[e]=s;let l=E(t.uid,(null===(n=t.textSource)||void 0===n?void 0:n.file)||(null===(a=t.mapping)||void 0===a?void 0:a.file)||t.path,{styleChanges:r});l&&("object"!=typeof l||l.success)||console.warn("Failed to update ".concat(e," attribute:"),(null==l?void 0:l.error)||"Unknown error")}}catch(e){console.error("Error updating metadata:",e)}},[t,E]);let D=(0,a.useCallback)(e=>{e.length>0&&(A(e[0]),u(!1),T(m),v.oR.success("Image uploaded and selected"))},[A,T,m]),P=(0,a.useCallback)((e,t)=>{t.stopPropagation(),N(e),j(!0)},[]),M=(0,a.useCallback)(async()=>{if(w){C(!0);try{let e=await fetch("/api/user/images/".concat(w.id),{method:"DELETE"});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to delete image")}x===w.fileUrl&&(p(""),b(e=>({...e,src:""}))),o(e=>e.filter(e=>e.id!==w.id)),v.oR.success("Image deleted successfully"),j(!1),N(null)}catch(e){console.error("Error deleting image:",e),v.oR.error(e instanceof Error?e.message:"Failed to delete image")}finally{C(!1)}}},[w,x]),L=(0,a.useCallback)(()=>{j(!1),N(null)},[]);return(0,n.jsxs)("div",{className:"p-4 space-y-4","data-sentry-component":"ImageEditor","data-sentry-source-file":"ImageEditor.tsx",children:[(0,n.jsxs)("div",{className:"bg-gray-800/30 rounded-lg p-4",children:[(0,n.jsxs)("h3",{className:"text-gray-300 text-sm font-medium mb-3 flex items-center gap-2",children:[(0,n.jsx)(ek.A,{className:"w-4 h-4","data-sentry-element":"Image","data-sentry-source-file":"ImageEditor.tsx"}),"Current Image"]}),x?(0,n.jsx)("div",{className:"relative group",children:(0,n.jsxs)("div",{className:"relative bg-white/5 rounded-xl p-3 max-h-40 overflow-hidden",children:[(0,n.jsx)("img",{src:x,alt:f.alt||"Current image",className:"w-full h-auto max-h-32 object-contain rounded-lg"}),(0,n.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-all rounded-xl flex items-center justify-center opacity-0 group-hover:opacity-100",children:(0,n.jsx)("button",{onClick:()=>p(""),className:"px-4 py-2 bg-white text-black rounded-lg font-medium hover:bg-gray-100 transition-colors",children:"Change"})})]})}):(0,n.jsxs)("div",{className:"bg-white/5 rounded-xl p-6 text-center text-gray-400",children:[(0,n.jsx)(ek.A,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,n.jsx)("div",{className:"text-sm",children:"No image selected"}),(0,n.jsx)("div",{className:"text-xs mt-1 opacity-70",children:"Choose from your images below"})]})]}),(0,n.jsx)("div",{className:"space-y-4",children:(0,n.jsxs)("button",{onClick:()=>u(!0),className:"w-full bg-white/5 hover:bg-white/10 border-2 border-dashed border-gray-600 hover:border-gray-500 rounded-xl p-6 transition-all group",children:[(0,n.jsx)(eS.A,{className:"w-6 h-6 mx-auto mb-2 text-gray-400 group-hover:text-gray-300","data-sentry-element":"Upload","data-sentry-source-file":"ImageEditor.tsx"}),(0,n.jsx)("div",{className:"text-sm text-gray-300 font-medium",children:"Upload New Image"}),(0,n.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG, GIF up to 10MB"})]})}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("h3",{className:"text-gray-300 font-medium",children:"Your Images"}),l.length>0&&(0,n.jsx)("span",{className:"text-xs text-gray-500 bg-white/10 px-2 py-1 rounded-md",children:l.length})]}),l.length>6&&(0,n.jsx)("input",{type:"text",value:m,onChange:e=>I(e.target.value),placeholder:"Search images...",className:"w-full px-4 py-2 bg-white/5 border border-gray-600/50 rounded-lg text-white placeholder-gray-500 focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50 transition-colors"}),i?(0,n.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,n.jsx)("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"})}):l.length>0?(0,n.jsx)("div",{className:"grid grid-cols-3 gap-3 max-h-80 overflow-y-auto",children:l.map(e=>(0,n.jsxs)("button",{onClick:()=>A(e.fileUrl),className:"relative aspect-square rounded-xl overflow-hidden transition-all group ".concat(x===e.fileUrl?"ring-2 ring-blue-500 ring-offset-2 ring-offset-gray-900":"hover:ring-2 hover:ring-white/30 hover:ring-offset-2 hover:ring-offset-gray-900"),title:e.altText||e.filename,children:[(0,n.jsx)("img",{src:e.fileUrl,alt:e.altText||e.filename,className:"w-full h-full object-cover"}),(0,n.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-all"}),(0,n.jsx)("button",{onClick:t=>P(e,t),className:"absolute top-1 right-1 bg-red-500 hover:bg-red-600 text-white rounded-full p-1.5 opacity-0 group-hover:opacity-100 transition-all z-10",title:"Delete image",children:(0,n.jsx)(eE.A,{className:"w-3 h-3"})}),x===e.fileUrl&&(0,n.jsx)("div",{className:"absolute inset-0 bg-blue-500/30 flex items-center justify-center",children:(0,n.jsx)(eT.A,{className:"w-6 h-6 text-white drop-shadow-lg"})})]},e.id))}):(0,n.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,n.jsx)(eI.A,{className:"w-10 h-10 mx-auto mb-3 opacity-50"}),(0,n.jsx)("div",{className:"font-medium",children:"No images yet"}),(0,n.jsx)("div",{className:"text-sm mt-1 opacity-70",children:m?"No images match your search":"Upload your first image above"})]})]}),d&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-gray-900 rounded-lg w-full max-w-md p-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Upload New Image"}),(0,n.jsx)("button",{onClick:()=>u(!1),className:"p-1 hover:bg-gray-800 rounded-lg transition-colors",children:(0,n.jsx)(eC.A,{className:"w-5 h-5 text-gray-400"})})]}),(0,n.jsx)(eD.A,{ref:S,onImagesUploaded:D,maxFiles:1,showPreview:!0})]})}),y&&w&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-gray-900 rounded-lg w-full max-w-md p-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Delete Image"}),(0,n.jsx)("button",{onClick:L,className:"p-1 hover:bg-gray-800 rounded-lg transition-colors",disabled:k,children:(0,n.jsx)(eC.A,{className:"w-5 h-5 text-gray-400"})})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("div",{className:"relative bg-white/5 rounded-xl p-3 max-h-32 overflow-hidden",children:(0,n.jsx)("img",{src:w.fileUrl,alt:w.altText||w.filename,className:"w-full h-auto max-h-24 object-contain rounded-lg"})}),(0,n.jsx)("div",{className:"text-sm text-gray-300 mt-2 truncate",children:w.filename})]}),(0,n.jsx)("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4 mb-4",children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)(eE.A,{className:"w-5 h-5 text-red-400"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-sm font-medium text-red-300",children:"This action cannot be undone"}),(0,n.jsx)("div",{className:"text-sm text-red-400 mt-1",children:"This will permanently delete the image from your account."})]})]})}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("button",{onClick:L,disabled:k,className:"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,n.jsx)("button",{onClick:M,disabled:k,className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:k?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Deleting..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eE.A,{className:"w-4 h-4"}),"Delete"]})})]})]})})]})}function eV(e){let{iframeRef:t,textareaRef:s,handleRealTimeTextChange:a,buildCurrentClassName:r,sendInstantStyleUpdate:l,sendInstantImageUpdate:o,sendInstantBackgroundUpdate:i}=e,c=h(e=>e.selectedElement),d=h(e=>e.editingText),u=h(e=>e.clearSelectedElement),m=h(e=>e.setTaggedSelection),g=h(e=>e.setInspectorMode),x=h(e=>e.setEditingTool),p=h(e=>e.setAiSelectionMode),f=h(e=>e.setPreviewType);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"h-full bg-gray-900 border-l border-gray-700 shadow-2xl transition-all duration-300 ease-in-out overflow-hidden flex-shrink-0 ".concat(c?"w-80":"w-0"),children:c&&(0,n.jsxs)("div",{"data-inspect-drawer":!0,tabIndex:-1,autoFocus:!0,onKeyDown:e=>{if("Escape"===e.key){e.preventDefault(),e.stopPropagation();let{clearPendingElementChanges:n,clearSelectedElement:a}=h.getState();if((null==c?void 0:c.uid)&&n(c.uid),a(),t&&t.contentWindow){var s;null===(s=t.contentWindow)||void 0===s||s.postMessage({type:"editor-closed"},"*")}}},className:"h-full flex flex-col outline-none",children:[(0,n.jsx)("div",{className:"p-4 border-b border-gray-700/50",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(ea.A,{className:"w-4 h-4 text-gray-400"}),(0,n.jsx)("h2",{className:"text-sm font-semibold text-gray-100",children:c.isImage?"Image Editor":c.isSVG?"Icon Editor":(()=>{var e;let t=(null===(e=c.tagName)||void 0===e?void 0:e.toLowerCase())||"",s=["div","section","article","header","footer","main","nav","aside"],n=c.text&&c.text.trim().length>0,a=c.isMultiInstance,r=c.instanceCount||1;return a&&r>1?"Multi-Instance Editor (".concat(r," instances)"):s.includes(t)&&!n?"Background Editor":s.includes(t)?"Container Editor":["p","span","h1","h2","h3","h4","h5","h6","a","button","label","li"].includes(t)?"Text Editor":"Element Editor"})()})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:()=>{var e,n,a,r,l,o,i,h,b,y,j;if(c){if(c.isImage||(null===(e=c.tagName)||void 0===e?void 0:e.toLowerCase())==="img")m({text:(null===(n=c.styleData)||void 0===n?void 0:n.alt)||(null===(a=c.styleData)||void 0===a?void 0:a.title)||"Image element",elementId:c.uid,elementType:c.tagName,filePath:c.filePath||"src/App.tsx",className:(null===(r=c.styleData)||void 0===r?void 0:r.className)||"",astPosition:{line:c.line||0,column:c.column||0,startIndex:c.startIndex||0,endIndex:c.endIndex||0},surroundingContext:c.context,computedStyles:c.computedStyles,isImage:!0,imageSrc:(null===(l=c.styleData)||void 0===l?void 0:l.src)||"",imageAlt:(null===(o=c.styleData)||void 0===o?void 0:o.alt)||"",imageTitle:(null===(i=c.styleData)||void 0===i?void 0:i.title)||""}),v.oR.success("Image element captured for AI");else{let e=s.current;if(e){let t=e.value.substring(e.selectionStart,e.selectionEnd);if(t.trim())m({text:t,elementId:c.uid,elementType:c.tagName,filePath:c.filePath||"src/App.tsx",className:(null===(y=c.styleData)||void 0===y?void 0:y.className)||"",astPosition:{line:c.line||0,column:c.column||0,startIndex:c.startIndex||0,endIndex:c.endIndex||0},surroundingContext:c.context,computedStyles:c.computedStyles}),v.oR.success("Selected text captured for AI");else{let e=d.trim();if(!e){v.oR.error("No text to select");return}m({text:e,elementId:c.uid,elementType:c.tagName,filePath:c.filePath||"src/App.tsx",className:(null===(b=c.styleData)||void 0===b?void 0:b.className)||"",astPosition:{line:c.line||0,column:c.column||0,startIndex:c.startIndex||0,endIndex:c.endIndex||0},surroundingContext:c.context,computedStyles:c.computedStyles}),v.oR.success("Full element text captured for AI")}}else m({text:d.trim()||c.text||"Element",elementId:c.uid,elementType:c.tagName,filePath:c.filePath||"src/App.tsx",className:(null===(h=c.styleData)||void 0===h?void 0:h.className)||"",astPosition:{line:c.line||0,column:c.column||0,startIndex:c.startIndex||0,endIndex:c.endIndex||0},surroundingContext:c.context,computedStyles:c.computedStyles}),v.oR.success("Element captured for AI")}g(!0),x("ai"),p(!0),f("new"),t&&t.contentWindow&&(null===(j=t.contentWindow)||void 0===j||j.postMessage({type:"editing-tool-change",tool:"ai"},"*"),setTimeout(()=>{var e;null===(e=t.contentWindow)||void 0===e||e.postMessage({type:"inspector-toggle",enabled:!0},"*")},50)),u(),t&&t.contentWindow&&setTimeout(()=>{var e;null===(e=t.contentWindow)||void 0===e||e.postMessage({type:"editor-closed"},"*")},100)}},className:"text-gray-400 hover:text-gray-200 hover:bg-gray-800 p-1 rounded-lg transition-colors",title:"Ask AI",children:(0,n.jsx)(er.A,{className:"w-4 h-4"})}),(0,n.jsx)("button",{onClick:()=>{let{clearPendingElementChanges:e,clearSelectedElement:s}=h.getState();if((null==c?void 0:c.uid)&&e(c.uid),s(),t&&t.contentWindow){var n;null===(n=t.contentWindow)||void 0===n||n.postMessage({type:"editor-closed"},"*")}},className:"text-gray-400 hover:text-gray-200 hover:bg-gray-800 p-1 rounded-lg transition-colors",title:"Close sidebar",children:(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})}),(0,n.jsx)("div",{className:"flex-1 overflow-y-auto",children:c.isImage?(0,n.jsx)(eG,{selectedElement:c,sendInstantStyleUpdate:l,sendInstantImageUpdate:o}):c.isSVG?(0,n.jsx)("div",{className:"p-4",children:(0,n.jsxs)("div",{className:"bg-gray-800/30 rounded-lg p-6 text-center",children:[(0,n.jsx)("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v12a4 4 0 004 4h4a2 2 0 002-2V5z"})}),(0,n.jsx)("h3",{className:"text-gray-300 text-lg font-medium mb-2",children:"Icon Editor"}),(0,n.jsx)("p",{className:"text-gray-500 text-sm",children:"Icons TODO"})]})}):(0,n.jsxs)(en.bL,{type:"multiple",defaultValue:["text","styles"],className:"p-4 space-y-3",children:[(0,n.jsx)(ei,{textareaRef:s,iframeRef:t,handleRealTimeTextChange:a}),(0,n.jsx)(ez,{buildCurrentClassName:r,sendInstantStyleUpdate:l,sendInstantBackgroundUpdate:i})]})})]})}),(0,n.jsx)(eH,{buildCurrentClassName:r,sendInstantStyleUpdate:l,"data-sentry-element":"CustomColorPicker","data-sentry-source-file":"InspectorDrawer.tsx"})]})}let eJ=async(e,t,s)=>{"esbuild_inject_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));try{let n=w.parse(e,{sourceType:"module",plugins:["jsx","typescript","decorators-legacy","classProperties","optionalChaining","nullishCoalescingOperator","exportDefaultFrom","dynamicImport"]}),a=0,r={},l=0,o=0,i=0,c=0,d=0,u=e=>e.attributes.some(e=>{var t;return k.isJSXAttribute(e)&&(null===(t=e.name)||void 0===t?void 0:t.name)==="data-static"});return(0,N.default)(n,{JSXElement(e){o++;let n=e.node,m=n.openingElement,g="unknown";k.isJSXIdentifier(m.name)&&(g=m.name.name);let x=!1,p="";if(n.children.forEach((e,n)=>{var o,d,u,m,h,f;if(k.isJSXText(e)&&e.value.trim()){i++,x||(p=e.value.trim(),x=!0);let n="".concat(t,"_text_").concat(a++),c={type:"literal",value:e.value.trim(),file:t,line:(null===(o=e.loc)||void 0===o?void 0:o.start.line)||0,column:(null===(d=e.loc)||void 0===d?void 0:d.start.column)||0,parent:g};l++,r[n]=c,s[n]=c}else if(k.isJSXExpressionContainer(e)&&!x){c++;let n=e.expression,l="".concat(t,"_expr_").concat(a++),o=null,i="";k.isIdentifier(n)?(o={type:"variable",varName:n.name,file:t,line:(null===(u=n.loc)||void 0===u?void 0:u.start.line)||0,column:(null===(m=n.loc)||void 0===m?void 0:m.start.column)||0},i="{".concat(n.name,"}"),x=!0,p=i):k.isStringLiteral(n)&&(o={type:"literal",value:n.value,file:t,line:(null===(h=n.loc)||void 0===h?void 0:h.start.line)||0,column:(null===(f=n.loc)||void 0===f?void 0:f.start.column)||0},i=n.value,x=!0,p=i),o&&(r[l]=o,s[l]=o)}}),x){var f,b,y,v;let e;"".concat(t.replace(/\\/g,"/"),":").concat((null===(f=n.loc)||void 0===f?void 0:f.start.line)||0,":").concat((null===(b=n.loc)||void 0===b?void 0:b.start.column)||0);let s=h.getState().getUidInjectedAST(t);s&&(0,N.default)(s,{JSXElement(t){var s,a,r,l;let o=t.node;if((null===(s=o.loc)||void 0===s?void 0:s.start.line)===(null===(a=n.loc)||void 0===a?void 0:a.start.line)&&(null===(r=o.loc)||void 0===r?void 0:r.start.column)===(null===(l=n.loc)||void 0===l?void 0:l.start.column)){let s=o.openingElement.attributes.find(e=>{var t;return k.isJSXAttribute(e)&&(null===(t=e.name)||void 0===t?void 0:t.name)==="data-editor-uid"});s&&k.isStringLiteral(s.value)&&(e=s.value.value,t.stop())}}}),e||(e=(0,Y.A)()),null===(v=m.attributes.find(e=>k.isJSXAttribute(e)&&"className"===e.name.name))||void 0===v||null===(y=v.value)||void 0===y||y.value;let a=u(m);console.log("\uD83D\uDCDD [TEXT-TRACK] Processing ".concat(g," - already has data-static: ").concat(a));let r=[];console.log("\uD83D\uDCDD [TEXT-TRACK] Skipping data-static handling for ".concat(g," - inspector injection handles this")),a?console.log("\uD83D\uDCDD [TEXT-TRACK] Preserving inspector injection decision for ".concat(g)):console.log("\uD83D\uDCDD [TEXT-TRACK] Inspector injection determined ".concat(g," should NOT have data-static (likely dynamic)"));let l=h.getState().selectedElement;l&&l.originalText===p&&r.push(k.jsxAttribute(k.jsxIdentifier("data-editor-selected"),k.stringLiteral("true"))),r.length>0&&(m.attributes.push(...r),d++),console.log("\uD83D\uDCDD [TEXT-TRACK] ".concat(g," processed - NO inspector attributes added (handled by inspector injection)"))}},VariableDeclarator(e){if(k.isIdentifier(e.node.id)&&e.node.init){let l=e.node.id.name;if(k.isStringLiteral(e.node.init)){var n,a;let o="".concat(t,"_var_").concat(l),i={type:"variable",value:e.node.init.value,varName:l,file:t,line:(null===(n=e.node.loc)||void 0===n?void 0:n.start.line)||0,column:(null===(a=e.node.loc)||void 0===a?void 0:a.start.column)||0};r[o]=i,s[o]=i,s&&(s["var_".concat(l,"_").concat(t)]=i)}}}}),{code:(0,X.default)(n,{retainLines:!1,compact:!1,concise:!1}).code,uidInjectedAST:n,inspectorMap:s}}catch(t){return{code:e,uidInjectedAST:null,inspectorMap:{}}}},e$=e=>{let{localFiles:t,initializeEsbuild:s,setError:n,setStatus:r,setPreviewUrl:l,previewUrl:o,injectInspectorSupport:i,createInspectorScript:c,onASTCapture:d,projectData:u,selectedPageRoute:m}=e;return{buildPreview:(0,a.useCallback)(async()=>{let e=h.getState().changedFiles,a={...t,...e};if(!a||0===Object.keys(a).length){n("No files provided");return}try{var g,x;n(""),r("Initializing esbuild..."),await s();let e=null,t="",h="";for(let e of["tailwind.config.ts","tailwind.config.js","tailwind.config.mjs","src/tailwind.config.ts","src/tailwind.config.js","src/tailwind.config.mjs"])if(a[e]){h=a[e];break}if(h)try{let t=h.replace(/import\s+type\s+\{[^}]+\}\s+from\s+["'][^"']+["'];?\s*/g,"").replace(/import\s+.*?\s+from\s+["'][^"']+["'];?\s*/g,"").replace(/export\s+default\s+/g,"const tailwindConfig = ").replace(/\s+satisfies\s+Config\s*;?$/m,";").replace(/\s+satisfies\s+Config/g,"").replace(/:\s*Config(?=\s*=)/g,"").replace(/\s+satisfies\s+Config/g,"").replace(/plugins:\s*\[[^\]]*\]/g,"plugins: []"),s=(t=t.replace(/\}\s*satisfies\s+Config\s*;?\s*$/,"}")).match(/const\s+tailwindConfig\s*=\s*(\{[\s\S]*\})[\s;]*$/);if(s){let t=s[1];e=t=t.replace(/plugins:\s*\[[^\]]*\]/g,"plugins: []")}}catch(e){}for(let[e,s]of Object.entries(a).filter(e=>{let[t]=e;return t.endsWith(".css")})){let e=s.match(/:root\s*\{([^}]+)\}/),n=s.match(/\.dark\s*\{([^}]+)\}/);if(e){let s=e[1].trim();s.endsWith(";")||(s+=";"),t+=":root { ".concat(s," }\n")}if(n){let e=n[1].trim();e.endsWith(";")||(e+=";"),t+=".dark { ".concat(e," }\n")}let a=s.match(/@layer\s+base\s*\{([\s\S]*?)\n\}/g);a&&a.forEach(e=>{let s=e.match(/:root\s*\{([^}]+)\}/);if(s&&!t.includes(s[1])){let e=s[1].trim();e.endsWith(";")||(e+=";"),t+=":root { ".concat(e," }\n")}})}r("Finding entry point...");let p=["src/main.tsx","src/index.tsx","src/App.tsx","main.tsx","index.tsx","App.tsx"],f="",b="";for(let e of p)if(a[e]){f=e,b=a[e];break}if(!b)throw Error("No entry point found. Looking for: ".concat(p.join(", ")));r("Parsing package.json...");let y={};if(a["package.json"])try{let e=JSON.parse(a["package.json"]),t=await fetch("/api/npm/import-map",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dependencies:e.dependencies||{},devDependencies:e.devDependencies||{}})});t.ok&&(y=(await t.json()).imports)}catch(e){}r("Injecting inspector support...");let v=a,j={};try{let e=await i(a);v=e.inspectorFiles,j=e.inspectorMap}catch(e){}r("Building with esbuild...");let w=Date.now(),N="\n// CACHE_BREAKER_".concat(w,"_").concat(Math.random().toString(36),"\n"),k=(v[f]||b)+N,C=await Z.build({stdin:{contents:k,loader:f.endsWith(".tsx")?"tsx":f.endsWith(".ts")?"ts":f.endsWith(".jsx")?"jsx":"js",resolveDir:"/"},format:"esm",bundle:!0,write:!1,jsx:"automatic",platform:"browser",target:"es2020",metafile:!1,define:{"process.env.NODE_ENV":'"development"',"import.meta.env.VITE_SUPABASE_URL":'"'.concat((null==u?void 0:u.supabaseProjectUrl)||"",'"'),"import.meta.env.VITE_SUPABASE_ANON_KEY":'"'.concat((null==u?void 0:u.supabaseAnonKey)||"",'"')},plugins:[{name:"virtual-files",setup(e){Object.entries(v).filter(e=>{let[t,s]=e;return"string"==typeof s&&(t.endsWith(".css")||t.includes("index.css")||t.includes("globals.css"))}).some(e=>{let[t,s]=e;return s.includes("@tailwind")})||(v["__tailwind__.css"]="@tailwind base;\\n@tailwind components;\\n@tailwind utilities;"),e.onResolve({filter:/.*/},e=>{if(!e.path.startsWith(".")&&!e.path.startsWith("@/")&&!e.path.startsWith("/")&&!e.path.endsWith(".css")&&!e.path.endsWith(".scss"))return{path:e.path,external:!0};if(e.path.endsWith(".css")||e.path.endsWith(".scss")||e.path.includes("index.css")){for(let t of[e.path,"src/".concat(e.path),e.path.replace("@/","src/"),e.path.replace("./","src/")])if(v[t])return{path:t,namespace:"virtual-css"};return{path:e.path,namespace:"virtual-css"}}let t=e.importer?e.importer.split("/").slice(0,-1).join("/"):"src",s=[];if(e.path.startsWith("@/")){let t=e.path.replace("@/","src/");s.push(t)}else if(e.path.startsWith("./")){let n=e.path.replace("./",t+"/");s.push(n),s.push(e.path.replace("./","src/"))}else if(e.path.startsWith("../")){let n=t.split("/"),a=e.path.split("/"),r=[...n];for(let e of a)".."===e?r.pop():"."!==e&&r.push(e);s.push(r.join("/"))}else s.push(e.path),s.push("src/".concat(e.path));let n=["",".tsx",".ts",".jsx",".js","/index.tsx","/index.ts","/index.jsx","/index.js"];for(let e of s)for(let t of n){let s=e+t;if(v[s])return{path:s,namespace:"virtual"}}return{path:e.path,external:!0}}),e.onLoad({filter:/.*/,namespace:"virtual-css"},async e=>{let t=v[e.path]||"",s=t.includes("@tailwind");return"src/App.css"===e.path?{contents:"\n                    // App.css skipped - contains conflicting #root styles\n                    export default {};\n                  ",loader:"js"}:s?{contents:"\n                    // Tailwind CSS file skipped - Play CDN handles all Tailwind classes\n                    export default {};\n                  ",loader:"js"}:{contents:"\n                const css = ".concat(JSON.stringify(t),";\n\n                if (css && css.trim()) {\n\n                  // Create style element with unique ID to prevent duplicates\n                  const styleId = 'css-").concat(e.path.replace(/[^a-zA-Z0-9]/g,"-"),"';\n\n                  let style = document.getElementById(styleId);\n\n                  if (!style) {\n                    style = document.createElement('style');\n                    style.id = styleId;\n                    style.setAttribute('data-source', '").concat(e.path,"');\n                    style.setAttribute('data-timestamp', new Date().toISOString());\n                    document.head.appendChild(style);\n                  }\n\n                  style.textContent = css;\n                }\n\n                export default css;\n              "),loader:"js"}}),e.onLoad({filter:/.*/,namespace:"virtual"},async e=>{let t=v[e.path];if(!t)return{contents:"",loader:"js"};if(e.path.match(/\.(jsx|tsx)$/))try{let s=await eJ(t,e.path,j);"string"==typeof s?t=s:(t=s.code,s.uidInjectedAST&&d&&d(e.path,s.uidInjectedAST))}catch(e){}t.includes("BrowserRouter")&&(t=t.replace(/import\s*{\s*([^}]*?)BrowserRouter([^}]*?)}\s*from\s*["']react-router-dom["']/g,'import { $1MemoryRouter$2 } from "react-router-dom"'),t=m&&"/"!==m?(t=(t=t.replace(/<BrowserRouter>/g,"<MemoryRouter initialEntries={['".concat(m,"']}>"))).replace(/<BrowserRouter\s+([^>]*?)>/g,"<MemoryRouter initialEntries={['".concat(m,"']} $1>"))).replace(/BrowserRouter/g,"MemoryRouter"):t.replace(/BrowserRouter/g,"MemoryRouter")),"src/App.tsx"===e.path&&v["src/App.css"]&&!t.includes("App.css")&&(t="import './App.css';\n".concat(t)),"src/main.tsx"===e.path&&v["styles.css"]&&!t.includes("styles.css")&&(t="import '../styles.css';\n".concat(t)),("src/main.tsx"===e.path||"src/index.tsx"===e.path||"src/App.tsx"===e.path)&&v["__tailwind__.css"]&&!t.includes("__tailwind__.css")&&(t="import './__tailwind__.css';\n".concat(t));let s=e.path.endsWith(".tsx")?"tsx":e.path.endsWith(".ts")?"ts":e.path.endsWith(".jsx")?"jsx":"js";return{contents:t,loader:s}})}}]}),S=null===(x=C.outputFiles)||void 0===x?void 0:null===(g=x[0])||void 0===g?void 0:g.text;if(!S)throw Error("No build output generated");r("Generating preview...");let E=await c(j),T=Date.now(),I=Math.random().toString(36).substring(2,15),A='\n<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>React App Preview</title>\n  \x3c!-- CACHE BUSTER: Build '.concat(I," at ").concat(T," --\x3e\n  <style>\n    body { margin: 0; padding: 0; font-family: system-ui, -apple-system, sans-serif; background: white; }\n    #root { margin: 0; padding: 0; max-width: none; text-align: left; }\n    .loading {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      height: 100vh;\n    }\n    .spinner {\n      width: 32px;\n      height: 32px;\n      border: 3px solid #f3f3f3;\n      border-top: 3px solid #3b82f6;\n      border-radius: 50%;\n      animation: spin 1s linear infinite;\n    }\n    @keyframes spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n\n    /* TODO: ESBuild preview was not respecting sr-only and other hiding classes\n       This caused elements visible in edit mode but hidden in view mode\n       Added standard CSS utilities so preview behaves like real browsers */\n    .sr-only {\n      position: absolute !important;\n      width: 1px !important;\n      height: 1px !important;\n      padding: 0 !important;\n      margin: -1px !important;\n      overflow: hidden !important;\n      clip: rect(0, 0, 0, 0) !important;\n      white-space: nowrap !important;\n      border: 0 !important;\n    }\n\n    .hidden { display: none !important; }\n    .invisible { visibility: hidden !important; }\n    .opacity-0 { opacity: 0 !important; }\n\n    /* Inject CSS variables for Tailwind custom colors */\n    ").concat(t,"\n  </style>\n  ").concat(Object.keys(y).length>0?'\n  <script type="importmap">\n  '.concat(JSON.stringify({imports:y},null,2),"\n  <\/script>"):"",'\n\n  \x3c!-- Tailwind Play CDN --\x3e\n  <script src="https://cdn.tailwindcss.com"><\/script>\n  ').concat(e?"\n  <script>\n    // Apply Tailwind configuration\n    tailwind.config = ".concat(e,";\n  <\/script>"):"","\n\n  \x3c!-- Inspector Script --\x3e\n  ").concat(E,"\n</head>\n<body>\n  <div id=\"root\">\n    <div class=\"loading\">\n      <div class=\"spinner\"></div>\n    </div>\n  </div>\n  <script type=\"module\">\n\n    // Error handling\n    window.addEventListener('error', (e) => {\n      console.error('Runtime error:', e.error);\n      document.getElementById('root').innerHTML = '<div class=\"loading\" style=\"color: red;\">Error: ' + e.error.message + '</div>';\n    });\n\n    window.addEventListener('unhandledrejection', (e) => {\n      console.error('Unhandled promise rejection:', e.reason);\n      document.getElementById('root').innerHTML = '<div class=\"loading\" style=\"color: red;\">Promise rejection: ' + e.reason + '</div>';\n    });\n\n\n    // FORCE RETRIGGER: Build ").concat(I," at ").concat(T,"\n    window.__BUILD_ID__ = '").concat(I,"';\n    window.__BUILD_TIMESTAMP__ = ").concat(T,";\n\n\n    // User code\n").concat(S,"\n\n\n\n  <\/script>\n</body>\n</html>");o&&URL.revokeObjectURL(o);let D=m?"_ROUTE_".concat(m.replace(/\//g,"_")):"",P=A+"\n\x3c!-- FORCE_REFRESH_".concat(I,"_").concat(T).concat(D," --\x3e"),M=new Blob([P],{type:"text/html"}),L=URL.createObjectURL(M);if(window.gc)try{window.gc()}catch(e){}l(L),r("Preview ready")}catch(e){n(e.message||"Build failed"),r("Build failed")}},[t,s,m])}};function eq(e){let{onInspectorClick:t,onFileUpdate:s,onUnsavedChangesUpdate:r,projectData:l}=e,o=h(e=>e.files);h(e=>e.changedFiles);let i=h(e=>e.previewMode);h(e=>e.projectId);let c=h(e=>e.inspectorMode),d=h(e=>e.setInspectorMode),u=h(e=>e.editingTool),m=h(e=>e.refreshKey);h(e=>e.updateChangedFile);let g=h(e=>e.setHasUnsavedChanges),x=h(e=>e.setFlushPendingUpdates),p=h(e=>e.getElementText),f=h(e=>e.flushAllPendingChanges),b=h(e=>e.setPendingElementChange),y=h(e=>e.selectElement),v=h(e=>e.setEditingText),j=h(e=>e.selectedPageRoute),[w,N]=(0,a.useState)(""),[k,C]=(0,a.useState)("Initializing..."),[S,E]=(0,a.useState)(""),T=h(e=>e.selectedElement),I=h(e=>e.setSelectedElement),A=h(e=>e.aiSelectionMode),D=h(e=>e.setTaggedSelection),P=h(e=>e.setIsTaggingElement),M=h(e=>e.setAiSelectionMode),L=(0,a.useCallback)(e=>{let t=h.getState().selectedTextColor,s=h.getState().selectedTextSize,n=h.getState().selectedBgColor,a=h.getState().selectedBgImage,r=h.getState().selectedBgSize,l=h.getState().selectedBgPosition,o=h.getState().selectedPadding,i=h.getState().selectedMargin;return function(e,t,s,n,a,r,l,o,i,c,d,u,m){var g;if(!e)return"";let h=(null===(g=e.styleData)||void 0===g?void 0:g.className)||"",x={},p=(null==m?void 0:m.textColor)!==void 0?m.textColor:t,f=(null==m?void 0:m.textSize)!==void 0?m.textSize:s,b=(null==m?void 0:m.bgColor)!==void 0?m.bgColor:n,y=(null==m?void 0:m.bgImage)!==void 0?m.bgImage:a,v=(null==m?void 0:m.bgSize)!==void 0?m.bgSize:r,j=(null==m?void 0:m.bgPosition)!==void 0?m.bgPosition:l,w=(null==m?void 0:m.padding)!==void 0?m.padding:o,N=(null==m?void 0:m.margin)!==void 0?m.margin:i,k=(null==m?void 0:m.textAlign)!==void 0?m.textAlign:c,C=(null==m?void 0:m.justify)!==void 0?m.justify:d,S=(null==m?void 0:m.alignItems)!==void 0?m.alignItems:u;return p&&(x.textColor=p),f&&(x.textSize=f),b&&(x.bgColor=b),y&&(x.bgImage=y),v&&(x.bgSize=v),j&&(x.bgPosition=j),w&&(x.padding=w),N&&(x.margin=N),k&&(x.textAlign=k),C&&(x.justify=C),S&&(x.alignItems=S),q.buildFromState(h,x)}(T,t,s,n,a,r,l,o,i,h.getState().selectedTextAlign,h.getState().selectedJustify,h.getState().selectedAlignItems,e)},[T]),[O,R]=(0,a.useState)(null),[F,B]=(0,a.useState)(o),U=h(e=>e.setUidInjectedAST);h(e=>e.getUidInjectedAST);let z=(0,a.useRef)(null);(0,a.useEffect)(()=>{B(o)},[o]),(0,a.useMemo)(()=>{let e={};return Object.keys(F).forEach(t=>{F[t]!==o[t]&&(e[t]=F[t])}),e},[F,o]);let{initializeEsbuild:W}=et(),{buildPreview:_}=e$({localFiles:F,initializeEsbuild:W,setError:E,setStatus:C,setPreviewUrl:N,previewUrl:w,injectInspectorSupport:K,createInspectorScript:Q,onASTCapture:(0,a.useCallback)((e,t)=>{U(e,t)},[U]),projectData:l,selectedPageRoute:j}),H=(0,a.useCallback)((e,t,s)=>{O&&O.contentWindow&&O.contentWindow.postMessage({type:"text-update",uid:e,newText:t,instanceIndex:s},"*")},[O]),G=(0,a.useCallback)((e,t)=>{O&&O.contentWindow&&O.contentWindow.postMessage({type:"style-update",uid:e,newClasses:t},"*")},[O]),V=(0,a.useCallback)((e,t)=>{O&&O.contentWindow&&O.contentWindow.postMessage({type:"image-update",uid:e,newSrc:t},"*")},[O]),J=(0,a.useCallback)((e,t,s,n)=>{O&&O.contentWindow&&O.contentWindow.postMessage({type:"background-style-update",uid:e,backgroundImage:t,backgroundSize:s,backgroundPosition:n},"*")},[O]);(0,a.useEffect)(()=>(x(()=>{f()}),()=>{x(null)}),[x,f]);let $=(0,a.useRef)(null),X=(0,a.useRef)(new Map),Y=(0,a.useCallback)(e=>{var t,s,n,a,r;if(console.log("\uD83D\uDD04 [TEXT-CHANGE] handleRealTimeTextChange called:",{newTextLength:e.length,newText:e.substring(0,50)+(e.length>50?"...":""),hasSelectedElement:!!T}),!T){console.error("❌ [TEXT-CHANGE] No selected element");return}console.log("\uD83D\uDCDD [TEXT-CHANGE] Selected element:",{uid:T.uid,tagName:T.tagName,text:null===(t=T.text)||void 0===t?void 0:t.substring(0,50),textSource:T.textSource,mapping:T.mapping,staticValue:T.staticValue}),(null===(s=T.textSource)||void 0===s?void 0:s.line)||null===(n=T.mapping)||void 0===n||n.line,Date.now(),v(e),e!==(T.originalText||T.text)?(console.log("✅ [TEXT-CHANGE] Text changed, setting unsaved indicator"),g(!0)):console.log("⏭️  [TEXT-CHANGE] Text unchanged from original");let l=(null===(a=T.textSource)||void 0===a?void 0:a.file)||(null===(r=T.mapping)||void 0===r?void 0:r.file)||T.path;l&&(console.log("\uD83D\uDCBE [IMMEDIATE-STORE] Storing pending change for navigation:",{uid:T.uid,filePath:l,textLength:e.length,instanceIndex:T.instanceIndex}),b(T.uid,l,{textChange:e,instanceIndex:T.instanceIndex})),console.log("\uD83D\uDCE4 [INSTANCE-SEND] Sending instant text update:",{uid:T.uid,textLength:e.length,instanceIndex:T.instanceIndex,hasInstance:void 0!==T.instanceIndex}),H(T.uid,e,T.instanceIndex),$.current&&clearTimeout($.current),$.current=setTimeout(()=>{var t,s;T.originalText||(T.originalText=T.text.trim());let n=(null===(t=T.textSource)||void 0===t?void 0:t.file)||(null===(s=T.mapping)||void 0===s?void 0:s.file)||T.path;if(!n)return;console.log("\uD83D\uDCBE [INSTANCE-STORE] Batching text change:",{uid:T.uid,filePath:n,textLength:e.length,instanceIndex:T.instanceIndex,hasInstance:void 0!==T.instanceIndex}),b(T.uid,n,{textChange:e,instanceIndex:T.instanceIndex});let a=T.uid;X.current.set(a,e.trim()),$.current=null},50)},[T,H,b,g,v]);return(0,a.useEffect)(()=>{let e=e=>{var s,n,a,r,l;if(((null===(s=e.data)||void 0===s?void 0:s.type)==="inspector-click"||(null===(n=e.data)||void 0===n?void 0:n.type)==="inspector-ready")&&console.log("\uD83D\uDCE5 [MESSAGE-HANDLER] Received:",e.data.type),e.data&&"inspector-click"===e.data.type){let s=e.data.data;console.log("\uD83D\uDCE5 [INSPECTOR-CLICK] Received inspector click:",{uid:s.uid,isMultiInstance:s.isMultiInstance,instanceIndex:s.instanceIndex,instanceCount:s.instanceCount,textLength:null===(a=s.text)||void 0===a?void 0:a.length,tagName:s.tagName,hasMapping:!!s.mapping});let n=s.uid,o=n&&void 0!==p(n)?p(n):s.text||"",i=null===(r=s.tagName)||void 0===r?void 0:r.toLowerCase(),c={...s,originalText:s.text,text:o,isImage:"img"===i,isMultiInstance:s.isMultiInstance||!1,instanceCount:s.instanceCount||1,instanceIndex:s.instanceIndex,groupUID:s.groupUID||null,isSVG:"svg"===i||(null===(l=s.styleData)||void 0===l?void 0:l.className)&&s.styleData.className.includes("lucide")};A&&(P(!0),setTimeout(()=>{var e,t,a,r,l,c,d,u,m,g;let h="img"===i,x="";if(h){let e=null===(u=s.styleData)||void 0===u?void 0:u.alt,t=null===(m=s.styleData)||void 0===m?void 0:m.src,n=t?null===(g=t.split("/").pop())||void 0===g?void 0:g.split("?")[0]:null;x=e&&e.trim()?"Image: ".concat(e):n?"Image: ".concat(n):"Selected image"}else x=o||s.text||"";D({text:x,elementId:n,elementType:s.tagName||"element",filePath:(null===(e=s.mapping)||void 0===e?void 0:e.file)||"unknown",className:(null===(t=s.styleData)||void 0===t?void 0:t.className)||"",astPosition:{line:(null===(a=s.mapping)||void 0===a?void 0:a.line)||0,column:(null===(r=s.mapping)||void 0===r?void 0:r.column)||0,startIndex:0,endIndex:0},mapping:s.mapping,textSource:s.textSource,styleData:s.styleData,isImage:h,imageSrc:h?null===(l=s.styleData)||void 0===l?void 0:l.src:void 0,imageAlt:h?null===(c=s.styleData)||void 0===c?void 0:c.alt:void 0,imageTitle:h?null===(d=s.styleData)||void 0===d?void 0:d.title:void 0}),P(!1)},500)),A||(y(c),v(o));let d=s.uid;d&&X.current.set(d,s.text||""),t&&t(s)}else e.data&&e.data.type};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[t,v,y,p,A,D,P,M]),(0,a.useEffect)(()=>{if(!T&&!c)return;let e=e=>{if("Escape"===e.key){if(e.preventDefault(),e.stopPropagation(),T){if(I(null),v(""),O&&O.contentWindow){var t;null===(t=O.contentWindow)||void 0===t||t.postMessage({type:"editor-closed"},"*")}}else c&&d(!1)}};return document.addEventListener("keydown",e,!0),window.addEventListener("keydown",e,!0),()=>{document.removeEventListener("keydown",e,!0),window.removeEventListener("keydown",e,!0)}},[T,c,d]),(0,a.useEffect)(()=>{if(T){let e=document.querySelector("[data-inspect-dialog]");e&&e.focus(),z.current&&setTimeout(()=>{var e,t;null===(e=z.current)||void 0===e||e.focus(),null===(t=z.current)||void 0===t||t.setSelectionRange(z.current.value.length,z.current.value.length)},100);let t=e=>{let t=e.target,s=document.querySelector("[data-inspect-dialog]");s&&!s.contains(t)&&(e.preventDefault(),e.stopPropagation(),s.focus())};return document.addEventListener("focusin",t,!0),()=>{document.removeEventListener("focusin",t,!0)}}},[T]),(0,a.useEffect)(()=>{if(O&&O.contentWindow){let e=()=>{try{var e,t;if(T){let t=T.uid;t&&(null===(e=O.contentWindow)||void 0===e||e.postMessage({type:"inspector-element-selected",uid:t},"*"))}else null===(t=O.contentWindow)||void 0===t||t.postMessage({type:"inspector-element-deselected"},"*")}catch(e){}};e();let t=setTimeout(e,200);return()=>clearTimeout(t)}},[T,O]),(0,a.useEffect)(()=>{if(!O||!O.contentWindow)return;let e=c&&("select"===u||"ai"===u);try{O.contentWindow.postMessage({type:"inspector-toggle",enabled:e},"*"),O.contentWindow.postMessage({type:"editing-tool-change",tool:u},"*")}catch(e){}},[c,u]),(0,a.useEffect)(()=>{_()},[_]),(0,a.useEffect)(()=>{void 0!==m&&m>0&&(B(o),setTimeout(()=>{_()},10))},[m,_,o]),(0,a.useEffect)(()=>()=>{w&&URL.revokeObjectURL(w)},[w]),(0,n.jsxs)("div",{className:"w-full h-full flex overflow-hidden",style:{maxHeight:"calc(100vh - 120px)"},"data-sentry-component":"EsbuildPreview","data-sentry-source-file":"EsbuildPreview.tsx",children:[(0,n.jsxs)("div",{className:"flex-1 flex flex-col transition-all duration-300",children:[S&&(0,n.jsx)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4",children:(0,n.jsxs)("div",{className:"text-red-700",children:[(0,n.jsx)("span",{className:"font-medium",children:"Error:"})," ",S]})}),(0,n.jsx)(es,{previewUrl:w,previewMode:i,error:S,status:k,currentInspectorMode:c,editingTool:u,onIframeRef:R,selectedPageRoute:j,"data-sentry-element":"PreviewFrame","data-sentry-source-file":"EsbuildPreview.tsx"})]}),(0,n.jsx)(eV,{iframeRef:O,textareaRef:z,handleRealTimeTextChange:Y,buildCurrentClassName:L,sendInstantStyleUpdate:G,sendInstantImageUpdate:V,sendInstantBackgroundUpdate:J,"data-sentry-element":"InspectorDrawer","data-sentry-source-file":"EsbuildPreview.tsx"})]})}var eX=s(64251);function eY(e){var t;let{previewSlug:s,onConsoleLog:r,onTryToFixIt:l,onInspectorClick:o,onSaveAllChanges:i,onFilesUpdate:c,onUnsavedChangesUpdate:d,platform:u="website",projectData:m}=e,g=h(e=>e.projectId),x=h(e=>e.files),p=h(e=>e.previewMode),f=h(e=>e.inspectorMode),b=h(e=>e.setInspectorMode),y=h(e=>e.previewType),v=h(e=>e.refreshKey),j=h(e=>e.selectedPageRoute);h(e=>e.navigationType);let w=(0,a.useRef)(null),[N,k]=(0,a.useState)(new Map),[C,S]=(0,a.useState)(!1),[E,T]=(0,a.useState)(null),[I,A]=(0,a.useState)(!1),[D,P]=(0,a.useState)(null),[M,L]=(0,a.useState)(""),[O,R]=(0,a.useState)(!1),[F,B]=(0,a.useState)(!1),U=(0,a.useRef)([]),z=(0,a.useRef)([]),W=(0,a.useRef)([]),_="website"===u&&x&&Object.keys(x).length>0&&"new"===y,H=async e=>{var t,s;let n=e||D,a=(null==e?void 0:e.newText)||M;if("update_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),n&&g&&(null==a?void 0:a.trim())){R(!0);try{let e=null===(t=n.mapping)||void 0===t?void 0:t.file;if(!e)throw Error("Cannot determine which file contains this element");let s=x[e];if(!s)throw Error("File ".concat(e," not found in project"));let r=s,l=n.text,o=[">".concat(l,"<"),'"'.concat(l,'"'),"'".concat(l,"'"),"{".concat(l,"}"),"{'".concat(l,"'}"),'{"'.concat(l,'"}')],c=!1;for(let e=0;e<o.length;e++){let t=o[e];if(r.includes(t)){let e=t.replace(l,a);r=r.replace(t,e),c=!0;break}}if(!c&&r.includes(l)&&(r=r.replace(l,a),c=!0),!c)throw Error("Could not find text to replace");let d=await fetch("/api/projects/change-files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:g,changedFiles:{[e]:r}})});if(429===d.status){let e=await d.json();throw Error(e.message||"Rate limit exceeded")}if(!d.ok){let e=await d.json();throw Error(e.error||"Failed to save changes")}P(null),L(""),i&&await i(),b(!1)}catch(e){eX.Cp(e,{tags:{component:"AppPreview",action:"text_update",projectId:g||"unknown"},extra:{elementData:D,newText:a,filePath:null==D?void 0:null===(s=D.mapping)||void 0===s?void 0:s.file}}),alert("Failed to update text: ".concat(e.message))}finally{R(!1)}}};(0,a.useEffect)(()=>{if(F&&w.current&&w.current.contentWindow)try{w.current.contentWindow.postMessage({type:"famous-inspector-toggle",enabled:f},"*")}catch(e){}},[f,F]),(0,a.useEffect)(()=>{v>0&&(k(new Map),S(!1),T(null),B(!1),U.current=[],z.current=[],W.current=[])},[v]);let G=e=>{let t;let s=e.find(e=>e instanceof Error||"object"==typeof e&&null!==e&&"message"in e&&"stack"in e);return s&&(s instanceof Error?t=s.stack:"object"==typeof s&&"stack"in s&&(t=String(s.stack))),{message:e.map(e=>"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)).join(" "),stack:t}},V=()=>{S(e=>!e)},J=e=>{T(t=>t===e?null:e)},$=async()=>{let e=Array.from(N.values()).slice(0,5).map(e=>({message:(e.message||"Unknown browser console error").substring(0,300)})).map((e,t)=>"Error ".concat(t+1,": ").concat(e.message)).join("\n\n");try{await navigator.clipboard.writeText(e),A(!0),setTimeout(()=>{A(!1)},2e3)}catch(e){}};(0,a.useEffect)(()=>{let e=e=>{if(_)return;let t=new URL("https://".concat(s,".").concat("deploypad.app")).origin;if(e.origin===t){if(e.data&&"famous-inspector-click"===e.data.type){let t=e.data.data;P(t),L(t.text||""),o&&o(t);return}if(e.data&&"user-event"===e.data.type){let t=e.data;U.current=[...U.current,t].slice(-50);return}if(e.data&&"network"===e.data.type){let t=e.data;z.current=[...z.current,t].slice(-100);return}if(e.data&&"source-context"===e.data.type){let t=e.data.contexts||[],s=e.data.errorMessage,n=e.data.timestamp||Date.now();t.forEach(e=>{let t={filename:e.filename,lineno:e.lineno,colno:e.colno,totalLines:e.totalLines,contextLines:e.contextLines||[],errorMessage:s,timestamp:n};W.current=[...W.current,t].slice(-10)});return}if(e.data&&"console"===e.data.type){let t=e.data.method,s=e.data.args;switch(null==r||r({method:t,args:s}),t){case"warn":case"info":break;case"error":let{message:n,stack:a}=G(s),l=s.find(e=>"object"==typeof e&&null!==e&&"_source"in e);k(e=>{let t=new Map(e),s=t.get(n);return s?t.set(n,{...s,count:s.count+1,timestamp:Date.now()}):t.size<5&&t.set(n,{message:n,stack:a,count:1,timestamp:Date.now(),source:null==l?void 0:l._source,filename:null==l?void 0:l.filename,lineno:null==l?void 0:l.lineno,colno:null==l?void 0:l.colno}),t})}}}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[_,s,r,l]);let q=a.useMemo(()=>{let e="https://".concat(s,".").concat("deploypad.app");if(j&&"/"!==j){let t=j.startsWith("/")?j:"/".concat(j);return"".concat(e).concat(t)}return e},[s,j]);if(console.log("\uD83C\uDFAF [AppPreview] useEsbuildPreview:",_,"platform:",u,"previewType:",y),_)return console.log("✅ [AppPreview] Rendering EsbuildPreview"),(0,n.jsx)(eq,{onInspectorClick:o,onFileUpdate:c,onUnsavedChangesUpdate:d,projectData:m});if(console.log("✅ [AppPreview] Rendering SSR iframe"),!s)return(0,n.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 w-full h-full flex items-center justify-center rounded-md",children:(0,n.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No preview available"})});let X=Array.from(N.values()).sort((e,t)=>t.timestamp-e.timestamp);return(0,n.jsxs)("div",{className:"w-full h-full relative flex flex-col","data-sentry-component":"AppPreview","data-sentry-source-file":"AppPreview.tsx",children:[(0,n.jsx)("div",{className:"\n          w-full h-full flex items-center justify-center\n          transition-all duration-300 ease-in-out\n          ".concat("mobile"===p?"bg-gray-100 p-8":"p-0 bg-transparent","\n        "),children:(0,n.jsxs)("div",{className:"\n            relative overflow-hidden\n            transition-all duration-300 ease-in-out\n            ".concat("mobile"===p?"w-[375px] h-[812px] max-h-full border-[14px] border-gray-900 rounded-[50px] shadow-2xl bg-black":"w-full h-full border-0 rounded-none shadow-none bg-transparent","\n          "),style:{transformOrigin:"center center"},children:[(0,n.jsx)("div",{className:"\n              absolute top-0 left-1/2 w-[150px] h-[30px] bg-gray-900 rounded-b-[20px] z-10\n              transition-all duration-300 ease-in-out transform -translate-x-1/2\n              ".concat("mobile"===p?"opacity-100 scale-100":"opacity-0 scale-75","\n            ")}),(0,n.jsx)("iframe",{ref:w,src:q,className:"\n              w-full h-full border-0\n              transition-all duration-300 ease-in-out\n              ".concat("mobile"===p?"rounded-[36px]":"rounded-none","\n            "),title:"Preview of ".concat(s),sandbox:"allow-scripts allow-forms allow-same-origin allow-popups allow-modals allow-popups-to-escape-sandbox allow-top-navigation-by-user-activation",allow:"payment; camera; microphone; geolocation; clipboard-write; cross-origin-isolated",loading:"lazy",onLoad:()=>{B(!0)}},"iframe-".concat(s,"-").concat(j,"-").concat(v))]})}),N.size>0&&(0,n.jsxs)("div",{className:"absolute bottom-0 left-0 w-full transition-all duration-300 pointer-events-auto z-[1000] ".concat(C?"h-48":"h-10"),children:[(0,n.jsxs)("div",{className:"w-full bg-black/80 text-white h-10 flex items-center justify-between px-4",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)("div",{className:"flex items-center cursor-pointer text-sm",onClick:V,children:[(0,n.jsx)("span",{className:"text-red-500 mr-2",children:"●"}),(0,n.jsxs)("span",{children:[N.size," ",1===N.size?"error":"errors"," ","detected"]})]}),l&&(0,n.jsx)("button",{onClick:()=>{if(l&&N.size>0){let e=Array.from(N.values()).sort((e,t)=>t.timestamp-e.timestamp).slice(0,5),t=U.current.slice(-10),n=z.current.slice(-10),a=z.current.filter(e=>!e.ok||e.status>=400).slice(-10),r=W.current.slice(-5),o={errors:e.map(e=>{var t;return{message:(e.message||"Unknown browser console error").substring(0,500),stack:null===(t=e.stack)||void 0===t?void 0:t.substring(0,2e3),source:e.source,filename:e.filename,lineno:e.lineno,colno:e.colno,count:e.count,timestamp:e.timestamp}}),userEvents:t,networkEvents:n,failedNetworkEvents:a,sourceContexts:r,projectMeta:{previewSlug:s,platform:u,previewMode:p,selectedPageRoute:j||"/"}},i=e.map((e,t)=>{let s="Error ".concat(t+1,": ").concat((e.message||"Unknown browser console error").substring(0,300));return e.stack&&(s+="\nStack trace:\n".concat(e.stack.substring(0,500))),s}).join("\n\n");if(t.length>0){let e=t.filter(e=>"click"===e.eventType).slice(-5).map(e=>"  - Clicked: ".concat(e.text||e.selector||"unknown element")).join("\n");e&&(i+="\n\nUser actions before error:\n".concat(e))}a.length>0&&(i+="\n\n**Failed Network Requests:**",a.slice(-2).forEach((e,t)=>{if(i+="\n\n--- Request ".concat(t+1," ---"),i+="\n".concat(e.method," ").concat(e.url),i+="\nStatus: ".concat(e.status," ").concat(e.statusText||e.errorMessage||""),e.requestHeaders&&Object.keys(e.requestHeaders).length>0&&(i+="\n\nRequest Headers:",Object.entries(e.requestHeaders).forEach(e=>{let[t,s]=e;i+="\n  ".concat(t,": ").concat(s)})),e.requestBody){let t=e.requestBody.length>800?e.requestBody.substring(0,800)+"...":e.requestBody;i+="\n\nRequest Body:\n".concat(t)}if(e.responseHeaders&&Object.keys(e.responseHeaders).length>0&&(i+="\n\nResponse Headers:",Object.entries(e.responseHeaders).forEach(e=>{let[t,s]=e;i+="\n  ".concat(t,": ").concat(s)})),e.responseBody){let t=e.responseBody.length>800?e.responseBody.substring(0,800)+"...":e.responseBody;i+="\n\nResponse Body:\n".concat(t)}})),r.length>0&&(i+="\n\n**Source code around error location:**",r.slice(0,2).forEach(e=>{let t=e.filename.split("/").pop()||e.filename;i+="\n\nFile: ".concat(t," (line ").concat(e.lineno).concat(e.colno?":".concat(e.colno):"",")"),i+="\n```javascript",e.contextLines.forEach(e=>{let t=e.isErrorLine?">>>":"   ",s=String(e.lineNum).padStart(4," ");i+="\n".concat(t," ").concat(s," | ").concat(e.code)}),i+="\n```"})),l(i,o)}},className:"ml-4 px-2 py-0.5 text-sm font-medium bg-gray-100 hover:bg-gray-200 text-black rounded",children:"Try to fix it"}),(0,n.jsx)("button",{onClick:$,className:"ml-3 text-gray-400 hover:text-white focus:outline-none transition-colors","aria-label":I?"Copied!":"Copy to clipboard",children:I?(0,n.jsx)("svg",{className:"w-4 h-4 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),(0,n.jsxs)("div",{className:"flex space-x-3",children:[(0,n.jsx)("button",{onClick:()=>{k(new Map),S(!1),T(null)},className:"text-xs text-gray-400 hover:text-white",children:"Clear"}),(0,n.jsx)("button",{className:"text-xs cursor-pointer",onClick:V,children:C?"Hide":"Show"})]})]}),C&&(0,n.jsx)("div",{className:"w-full h-40 bg-black/80 p-4 overflow-y-auto",children:(0,n.jsx)("div",{className:"space-y-3",children:X.map((e,t)=>(0,n.jsxs)("div",{className:"text-sm",children:[(0,n.jsxs)("div",{className:"flex cursor-pointer",onClick:()=>e.stack&&J(e.message),children:[(0,n.jsx)("div",{className:"text-red-500 min-w-8 flex-shrink-0",children:e.count>1?"(".concat(e.count,")"):""}),(0,n.jsxs)("div",{className:"text-white break-words flex-grow",children:[(0,n.jsx)("span",{className:"font-semibold",children:e.message}),e.stack&&(0,n.jsxs)("span",{className:"text-gray-400 ml-2 text-xs",children:[E===e.message?"▼":"▶",e.stack?"Stack trace available":""]})]})]}),e.stack&&E===e.message&&(0,n.jsx)("div",{className:"mt-1 ml-8 p-2 bg-gray-900 rounded text-xs text-gray-300 font-mono whitespace-pre-wrap overflow-x-auto",children:e.stack})]},t))})})]}),D&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 w-96 max-w-[90vw]",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Edit Text"}),(0,n.jsx)("button",{onClick:()=>{P(null),L("")},className:"text-gray-400 hover:text-gray-600",children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Element"}),(0,n.jsxs)("div",{className:"text-sm text-gray-500 bg-gray-50 p-2 rounded font-mono",children:["<",D.tagName,">",(null===(t=D.mapping)||void 0===t?void 0:t.file)&&(0,n.jsxs)("span",{className:"ml-2 text-xs text-blue-600",children:[D.mapping.file,":",D.mapping.line]})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Text"}),(0,n.jsx)("textarea",{value:M,onChange:e=>L(e.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Enter new text..."})]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,n.jsx)("button",{onClick:()=>{P(null),L("")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),(0,n.jsx)("button",{onClick:()=>H(),disabled:O||!M.trim()||M===D.text,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:O?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Updating..."]}):"Update Text"})]})]})]})})]})}var eK=s(46745),eQ=s(47835),eZ=s(41262),e0=s(41649),e1=s(14186),e2=s(35492),e4=s(34164),e3=s(28475);function e5(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,e3.QP)((0,e4.$)(t))}let e6=e2.Kq,e8=e2.bL,e7=e2.l9,e9=a.forwardRef((e,t)=>{let{className:s,sideOffset:a=4,...r}=e;return(0,n.jsx)(e2.ZL,{children:(0,n.jsx)(e2.UC,{ref:t,sideOffset:a,className:e5("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",s),...r})})});e9.displayName=e2.UC.displayName;var te=s(33515);let tt=te.bL;te.l9;let ts=te.ZL;te.bm;let tn=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)(te.hJ,{ref:t,className:e5("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a})});tn.displayName=te.hJ.displayName;let ta=a.forwardRef((e,t)=>{let{className:s,children:a,...r}=e;return(0,n.jsxs)(ts,{children:[(0,n.jsx)(tn,{}),(0,n.jsxs)(te.UC,{ref:t,className:e5("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...r,children:[a,(0,n.jsxs)(te.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,n.jsx)(eC.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});ta.displayName=te.UC.displayName;let tr=e=>{let{className:t,...s}=e;return(0,n.jsx)("div",{className:e5("flex flex-col space-y-1.5 text-center sm:text-left",t),...s,"data-sentry-component":"DialogHeader","data-sentry-source-file":"dialog.tsx"})};tr.displayName="DialogHeader";let tl=e=>{let{className:t,...s}=e;return(0,n.jsx)("div",{className:e5("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s,"data-sentry-component":"DialogFooter","data-sentry-source-file":"dialog.tsx"})};tl.displayName="DialogFooter";let to=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)(te.hE,{ref:t,className:e5("text-lg font-semibold leading-none tracking-tight",s),...a})});to.displayName=te.hE.displayName;let ti=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)(te.VY,{ref:t,className:e5("text-sm text-muted-foreground",s),...a})});ti.displayName=te.VY.displayName;var tc=s(27357);function td(e){let{isOpen:t,onClose:s,onSave:a,onAfterSave:r,onAfterDiscard:l}=e,{projectId:o,changedFiles:i,files:c,isSaving:d,setIsSaving:u,clearChangedFiles:m,clearSelectedElement:g,setFiles:x,setHasUnsavedChanges:p,incrementRefreshKey:f,setPreviewType:b,setInspectorMode:y,executeFlushPendingUpdates:v,pendingStyleChanges:w,clearPendingStyleChanges:N}=h(),k=async()=>{v(),await new Promise(e=>setTimeout(e,100));let{projectId:e,changedFiles:t,pendingElementChanges:n,setIsLoading:l,setLoadingText:o}=h.getState(),i=Object.keys(t).length>0||Object.keys(n).length>0;if(!e||!i){console.log("[UnsavedChangesModal] No changes to save, closing dialog"),s();return}if(l(!0),o("Saving changes..."),a){console.log("[UnsavedChangesModal] Using provided onSave handler"),u(!0);try{await a(),s(),r&&r()}catch(e){console.error("[UnsavedChangesModal] Error during save:",e),l(!1),o("")}finally{u(!1)}}else{console.log("[UnsavedChangesModal] Using internal save logic"),u(!0);try{await j({projectId:e,changedFiles:t,setLoadingText:o,onPollingComplete:e=>{e.files&&x(e.files);let n={...c,...t};x(n),m(),p(!1),Object.keys(w).forEach(e=>{N(e)}),g(),b("old"),y(!1),f(),l(!1),o(""),s(),r&&r()}})}catch(e){console.error("[UnsavedChangesModal] Error during save:",e),l(!1),o("")}finally{u(!1)}}};return(0,n.jsx)(tt,{open:t,onOpenChange:e=>!e&&s(),"data-sentry-element":"Dialog","data-sentry-component":"UnsavedChangesModal","data-sentry-source-file":"UnsavedChangesModal.tsx",children:(0,n.jsxs)(ta,{className:"sm:max-w-md","data-sentry-element":"DialogContent","data-sentry-source-file":"UnsavedChangesModal.tsx",children:[(0,n.jsx)(tr,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"UnsavedChangesModal.tsx",children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-orange-100 dark:bg-orange-900",children:(0,n.jsx)(tc.A,{className:"h-5 w-5 text-orange-600 dark:text-orange-400","data-sentry-element":"AlertTriangle","data-sentry-source-file":"UnsavedChangesModal.tsx"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)(to,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"UnsavedChangesModal.tsx",children:"Unsaved Changes"}),(0,n.jsx)(ti,{"data-sentry-element":"DialogDescription","data-sentry-source-file":"UnsavedChangesModal.tsx",children:"You have unsaved changes. What would you like to do?"})]})]})}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Your changes will be lost if you discard them. You can save them before leaving edit mode."})}),(0,n.jsxs)(tl,{className:"flex-col sm:flex-row gap-2 sm:gap-0","data-sentry-element":"DialogFooter","data-sentry-source-file":"UnsavedChangesModal.tsx",children:[(0,n.jsx)("button",{onClick:s,className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors font-medium order-3 sm:order-1",disabled:d,children:"Cancel"}),(0,n.jsxs)("div",{className:"flex gap-2 flex-col sm:flex-row order-1 sm:order-2",children:[(0,n.jsx)("button",{onClick:()=>{m(),Object.keys(w).forEach(e=>{N(e)}),g(),p(!1),f(),l&&l(),s()},disabled:d,"data-testid":"discard-changes-button",className:"px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-lg font-medium transition-colors",children:"Discard Changes"}),(0,n.jsx)("button",{onClick:k,disabled:d,"data-testid":"save-changes-button",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg font-medium transition-colors flex items-center justify-center",children:d?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})]})]})]})})}var tu=s(82742),tm=s(46075);function tg(e){let{onSaveAllChanges:t}=e,[s,r]=a.useState(!1),[l,o]=a.useState(!1),[i,c]=a.useState(null),d=h(e=>e.availablePages),u=h(e=>e.selectedPageRoute);h(e=>e.navigationType),h(e=>e.previewType);let m=h(e=>e.setSelectedPageRoute),g=h(e=>e.hasUnsavedChanges),x=h(e=>e.inspectorMode),p=d.find(e=>e.path===u);return 0===d.length?null:(0,n.jsxs)(e6,{delayDuration:300,"data-sentry-element":"TooltipProvider","data-sentry-component":"PageSelector","data-sentry-source-file":"PageSelector.tsx",children:[(0,n.jsxs)(tm.bL,{open:s,onOpenChange:r,"data-sentry-element":"DropdownMenu.Root","data-sentry-source-file":"PageSelector.tsx",children:[(0,n.jsxs)(e8,{"data-sentry-element":"Tooltip","data-sentry-source-file":"PageSelector.tsx",children:[(0,n.jsx)(e7,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"PageSelector.tsx",children:(0,n.jsx)(tm.l9,{asChild:!0,"data-sentry-element":"DropdownMenu.Trigger","data-sentry-source-file":"PageSelector.tsx",children:(0,n.jsxs)("button",{className:"flex items-center gap-2 px-3 py-2 bg-gray-800/50 backdrop-blur-sm rounded-lg border border-white/5 text-gray-300 hover:text-white hover:bg-gray-700/50 transition-all duration-200","data-testid":"page-selector-trigger","data-no-inspector":"true",style:{pointerEvents:"auto",position:"relative",zIndex:9999},children:[(0,n.jsx)(tu.A,{className:"w-4 h-4","data-sentry-element":"FileText","data-sentry-source-file":"PageSelector.tsx"}),(0,n.jsx)("span",{className:"text-xs font-medium",children:(null==p?void 0:p.name)||"Select Page"}),(0,n.jsx)(eo.A,{className:"w-3 h-3 opacity-70","data-sentry-element":"ChevronDown","data-sentry-source-file":"PageSelector.tsx"})]})})}),(0,n.jsx)(e9,{"data-sentry-element":"TooltipContent","data-sentry-source-file":"PageSelector.tsx",children:(0,n.jsx)("p",{children:"Select page to view/edit"})})]}),(0,n.jsx)(tm.ZL,{"data-sentry-element":"DropdownMenu.Portal","data-sentry-source-file":"PageSelector.tsx",children:(0,n.jsx)(tm.UC,{className:"bg-gray-800 border border-white/10 rounded-lg p-1 shadow-xl min-w-[200px]",sideOffset:5,"data-testid":"page-selector-content","data-no-inspector":"true",style:{pointerEvents:"auto",zIndex:99999},"data-sentry-element":"DropdownMenu.Content","data-sentry-source-file":"PageSelector.tsx",children:d.map(e=>(0,n.jsx)(tm.q7,{onSelect:()=>{if(e.path===u){r(!1);return}let t=Object.keys(h.getState().pendingElementChanges).length>0;(g||t)&&x?(c(e.path),o(!0)):m(e.path),r(!1)},className:"\n                  px-3 py-2 text-sm rounded cursor-pointer outline-none\n                  transition-colors duration-150\n                  ".concat(e.path===u?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","\n                "),"data-testid":"page-option-".concat(e.path),children:(0,n.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,n.jsx)("div",{className:"font-medium",children:e.name}),(0,n.jsx)("div",{className:"text-xs opacity-70",children:e.path})]})},e.path))})})]}),(0,n.jsx)(td,{isOpen:l,onClose:()=>{o(!1),c(null)},onSave:t,onAfterSave:()=>{i&&(m(i),c(null))},onAfterDiscard:()=>{i&&(m(i),c(null))},"data-sentry-element":"UnsavedChangesModal","data-sentry-source-file":"PageSelector.tsx"})]})}var th=s(33013);function tx(e){var t;let{onRefreshPreview:s,onDownload:r,onSaveAllChanges:l,projectPlatform:o="website",projectSlug:i,isDownloading:c=!1,whitelabelConfig:d,isWhitelabel:u=!1,forceView:m}=e,{projectId:g,activeView:x,previewMode:p,inspectorMode:f,previewType:b,editingTool:y,isRefreshing:v,isSaving:j,hasUnsavedChanges:w,isMobile:N,aiSelectionMode:k,setPreviewMode:C,setInspectorMode:S,setPreviewType:I,setEditingTool:A,setAiSelectionMode:D,clearChangedFiles:P,clearSelectedElement:M,clearTaggedSelection:L}=h(),[O,R]=(0,a.useState)(!1),{data:F}=(0,th.useSession)(),B="website"===o&&"new"===b&&f,U=()=>{B?w?R(!0):(I("old"),S(!1),D(!1),M(),L()):(I("new"),S(!0),A("select"))};return"preview"===(m||x)?(0,n.jsxs)(e6,{delayDuration:300,children:[(0,n.jsx)("div",{className:"relative bg-gray-900/80 backdrop-blur-xl border-b border-white/10",children:(0,n.jsx)("div",{className:"px-4 py-2",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:["website"===o&&(0,n.jsx)(tg,{onSaveAllChanges:l}),"website"===o&&(0,n.jsxs)("div",{className:"flex items-center bg-gray-800/50 backdrop-blur-sm rounded-lg p-0.5 border border-white/5",children:[(0,n.jsxs)(e8,{children:[(0,n.jsx)(e7,{asChild:!0,children:(0,n.jsxs)("button",{onClick:()=>{B&&U()},"data-testid":"view-mode-button",className:"\n                            relative px-3 py-2 rounded-md transition-all duration-200 flex items-center gap-1\n                            ".concat(B?"text-gray-400 hover:text-gray-200 hover:bg-gray-700/50":"bg-blue-600 text-white","\n                          "),children:[(0,n.jsx)(eK.A,{className:"w-4 h-4"}),(0,n.jsx)("span",{className:"text-xs font-medium",children:"View"})]})}),(0,n.jsx)(e9,{children:(0,n.jsx)("p",{children:"View mode (saved version)"})})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsxs)(e8,{children:[(0,n.jsx)(e7,{asChild:!0,children:(0,n.jsxs)("button",{onClick:()=>{B||U()},"data-testid":"edit-mode-button",className:"\n                              relative px-3 py-2 rounded-l-md transition-all duration-200 flex items-center gap-1\n                              ".concat(B?"bg-blue-600 text-white":"text-gray-400 hover:text-gray-200 hover:bg-gray-700/50","\n                              ").concat(B?"rounded-r-none":"rounded-md","\n                            "),children:["select"===y&&(0,n.jsx)(ea.A,{className:"w-4 h-4"}),"navigate"===y&&(0,n.jsx)(eQ.A,{className:"w-4 h-4"}),"ai"===y&&(0,n.jsx)(er.A,{className:"w-4 h-4"}),(0,n.jsx)("span",{className:"text-xs font-medium",children:"Edit"})]})}),(0,n.jsx)(e9,{children:(0,n.jsx)("p",{children:"Edit mode (make changes)"})})]}),(0,n.jsxs)("div",{className:"\n                        flex items-center bg-blue-700 rounded-r-md h-full overflow-hidden\n                        transition-all duration-300 ease-in-out\n                        ".concat(B?"w-auto opacity-100":"w-0 opacity-0","\n                      "),children:[(0,n.jsxs)(e8,{children:[(0,n.jsx)(e7,{asChild:!0,children:(0,n.jsx)("button",{onClick:()=>{A("select"),k&&(D(!1),L()),M()},"data-testid":"select-tool-button",className:"\n                                relative px-2.5 py-2 h-full transition-all duration-200 border-r border-blue-800\n                                ".concat(B?"scale-100":"scale-0","\n                                ").concat("select"===y?"bg-white text-blue-600 shadow-inner":"text-blue-200 hover:text-white hover:bg-blue-600","\n                              "),style:{transitionDelay:B?"150ms":"0ms"},children:(0,n.jsx)(ea.A,{className:"w-4 h-4"})})}),(0,n.jsx)(e9,{children:(0,n.jsx)("p",{children:"Edit tool (click to edit elements)"})})]}),(0,n.jsxs)(e8,{children:[(0,n.jsx)(e7,{asChild:!0,children:(0,n.jsx)("button",{onClick:()=>{A("navigate"),k&&(D(!1),L()),M()},"data-testid":"navigate-tool-button",className:"\n                                relative px-2.5 py-2 h-full transition-all duration-200 border-r border-blue-800\n                                ".concat(B?"scale-100":"scale-0","\n                                ").concat("navigate"===y?"bg-white text-blue-600 shadow-inner":"text-blue-200 hover:text-white hover:bg-blue-600","\n                              "),style:{transitionDelay:B?"200ms":"0ms"},children:(0,n.jsx)(eQ.A,{className:"w-4 h-4"})})}),(0,n.jsx)(e9,{children:(0,n.jsx)("p",{children:"Navigate tool (interact with app)"})})]}),(0,n.jsxs)(e8,{children:[(0,n.jsx)(e7,{asChild:!0,children:(0,n.jsx)("button",{onClick:()=>{A("ai"),D(!0),M()},"data-testid":"ai-tool-button",className:"\n                                relative px-2.5 py-2 h-full rounded-r-md transition-all duration-200\n                                ".concat(B?"scale-100":"scale-0","\n                                ").concat("ai"===y?"bg-white text-blue-600 shadow-inner":"text-blue-200 hover:text-white hover:bg-blue-600","\n                              "),style:{transitionDelay:B?"250ms":"0ms"},children:(0,n.jsx)(er.A,{className:"w-4 h-4"})})}),(0,n.jsx)(e9,{children:(0,n.jsx)("p",{children:"AI tool (point to an element)"})})]})]})]})]})]}),(0,n.jsx)("div",{className:"flex items-center justify-center flex-1",children:w&&(0,n.jsxs)("div",{className:"flex items-center gap-3 bg-orange-500/10 backdrop-blur-sm px-4 py-1.5 rounded-lg border border-orange-500/20",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"}),(0,n.jsx)("span",{className:"text-sm font-medium text-orange-400",children:"Unsaved changes"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:()=>{P(),M(),L(),s&&s()},className:"p-1 text-gray-400 hover:text-white transition-colors",title:"Discard changes",children:(0,n.jsx)(eC.A,{className:"w-4 h-4"})}),(0,n.jsxs)("button",{onClick:()=>{console.log("\uD83D\uDCBE [SAVE-BUTTON] Save button clicked!",{hasCallback:!!l,callbackName:null==l?void 0:l.name,activeView:x,previewType:b,inspectorMode:f}),l?(console.log("\uD83D\uDCBE [SAVE-BUTTON] Calling onSaveAllChanges..."),l(),console.log("\uD83D\uDCBE [SAVE-BUTTON] onSaveAllChanges returned")):console.error("❌ [SAVE-BUTTON] No onSaveAllChanges callback!")},disabled:j,className:"px-3 py-1 text-xs bg-blue-600 text-white hover:bg-blue-700 rounded-md transition-colors font-medium flex items-center gap-1",children:[(0,n.jsx)(E.A,{className:"w-3 h-3"}),"Save"]})]})]})}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[!N&&(0,n.jsxs)("div",{className:"flex items-center bg-gray-800/50 backdrop-blur-sm rounded-lg p-0.5 border border-white/5",children:[(0,n.jsxs)(e8,{children:[(0,n.jsx)(e7,{asChild:!0,children:(0,n.jsx)("button",{onClick:()=>C("desktop"),"data-testid":"viewport-desktop-button",className:"\n                            relative p-2 rounded-md transition-all duration-200\n                            ".concat("desktop"===p?"bg-blue-600 text-white":"text-gray-400 hover:text-gray-200 hover:bg-gray-700/50","\n                          "),children:(0,n.jsx)(eZ.A,{className:"w-4 h-4"})})}),(0,n.jsx)(e9,{children:(0,n.jsx)("p",{children:"Desktop view"})})]}),(0,n.jsxs)(e8,{children:[(0,n.jsx)(e7,{asChild:!0,children:(0,n.jsx)("button",{onClick:()=>C("mobile"),"data-testid":"viewport-mobile-button",className:"\n                            relative p-2 rounded-md transition-all duration-200\n                            ".concat("mobile"===p?"bg-blue-600 text-white":"text-gray-400 hover:text-gray-200 hover:bg-gray-700/50","\n                          "),children:(0,n.jsx)(e0.A,{className:"w-4 h-4"})})}),(0,n.jsx)(e9,{children:(0,n.jsx)("p",{children:"Mobile view"})})]})]}),s&&(0,n.jsxs)(e8,{children:[(0,n.jsx)(e7,{asChild:!0,children:(0,n.jsx)("button",{onClick:s,disabled:v,className:"p-2 text-gray-400 hover:text-white bg-gray-800/50 hover:bg-gray-700/50 border border-white/5 rounded-lg transition-all duration-200",children:(0,n.jsx)(e1.A,{className:"w-4 h-4 ".concat(v?"animate-spin":"")})})}),(0,n.jsx)(e9,{children:(0,n.jsx)("p",{children:"Refresh preview"})})]})]})]})})}),(0,n.jsx)(td,{isOpen:O,onClose:()=>R(!1),onSave:l,onAfterSave:()=>{I("old"),S(!1),D(!1),M(),L()},onAfterDiscard:()=>{I("old"),S(!1),D(!1),L(),s&&s()}})]}):(0,n.jsx)(e6,{delayDuration:300,"data-sentry-element":"TooltipProvider","data-sentry-component":"SecondaryToolbar","data-sentry-source-file":"SecondaryToolbar.tsx",children:(0,n.jsx)("div",{className:"relative bg-gray-900/80 backdrop-blur-xl border-b border-white/10",children:(0,n.jsx)("div",{className:"px-4 py-2",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Code Editor"})}),(0,n.jsx)("div",{className:"flex items-center justify-center flex-1",children:w&&(0,n.jsxs)("div",{className:"flex items-center gap-3 bg-orange-500/10 backdrop-blur-sm px-4 py-1.5 rounded-lg border border-orange-500/20",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"}),(0,n.jsx)("span",{className:"text-sm font-medium text-orange-400",children:"Unsaved changes"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:()=>{P(),M(),L(),s&&s()},className:"p-1 text-gray-400 hover:text-white transition-colors",title:"Discard changes",children:(0,n.jsx)(eC.A,{className:"w-4 h-4"})}),(null==F?void 0:null===(t=F.user)||void 0===t?void 0:t.isAdmin)===!0&&(0,n.jsx)("button",{onClick:()=>{console.log("\uD83D\uDC1B [DEBUG] ========== DEBUG DUMP ==========");let e=h.getState();console.log("\uD83D\uDC1B [DEBUG] Pending Element Changes:",e.pendingElementChanges),console.log("\uD83D\uDC1B [DEBUG] Pending Element Changes Count:",Object.keys(e.pendingElementChanges||{}).length),console.log("\uD83D\uDC1B [DEBUG] Selected Element:",e.selectedElement),console.log("\uD83D\uDC1B [DEBUG] Editing Text:",e.editingText),console.log("\uD83D\uDC1B [DEBUG] Has Unsaved Changes:",e.hasUnsavedChanges),console.log("\uD83D\uDC1B [DEBUG] Changed Files:",e.changedFiles),e.pendingElementChanges&&Object.entries(e.pendingElementChanges).forEach(e=>{let[t,s]=e;console.log("\uD83D\uDC1B [DEBUG] Change for UID ".concat(t,":"),{filePath:s.filePath,textChange:s.textChange,styleChanges:s.styleChanges,instanceIndex:s.instanceIndex,timestamp:s.timestamp})}),console.log("\uD83D\uDC1B [DEBUG] ===================================")},className:"px-2 py-1 text-xs bg-yellow-600 text-white hover:bg-yellow-700 rounded-md transition-colors font-medium flex items-center gap-1",title:"Debug: Log pending changes without saving",children:"\uD83D\uDC1B Debug"}),(0,n.jsxs)("button",{onClick:()=>{console.log("\uD83D\uDCBE [SAVE-BUTTON] Save button clicked (code view)!",{hasCallback:!!l,callbackName:null==l?void 0:l.name,activeView:x}),l?(console.log("\uD83D\uDCBE [SAVE-BUTTON] Calling onSaveAllChanges..."),l(),console.log("\uD83D\uDCBE [SAVE-BUTTON] onSaveAllChanges returned")):console.error("❌ [SAVE-BUTTON] No onSaveAllChanges callback!")},disabled:j,className:"px-3 py-1 text-xs bg-blue-600 text-white hover:bg-blue-700 rounded-md transition-colors font-medium flex items-center gap-1",children:[(0,n.jsx)(E.A,{className:"w-3 h-3"}),"Save"]})]})]})}),(0,n.jsx)("div",{className:"flex items-center gap-2",children:g&&r&&(0,n.jsxs)(e8,{children:[(0,n.jsx)(e7,{asChild:!0,children:(0,n.jsxs)("button",{onClick:r,disabled:c,className:"px-3 py-1.5 text-sm font-medium text-gray-400 hover:text-white bg-gray-800/50 hover:bg-gray-700/50 border border-white/5 rounded-lg transition-all duration-200 flex items-center gap-2",children:[(0,n.jsx)(T.A,{className:"w-4 h-4 ".concat(c?"animate-pulse":"")}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"Download"})]})}),(0,n.jsx)(e9,{children:(0,n.jsx)("p",{children:"Download project files"})})]})})]})})})})}var tp=s(50802),tf=s(16449),tb=s(23925);function ty(e){let{isOpen:t,onClose:s,onSuccess:r,projectId:l}=e,[o,i]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0),[u,m]=(0,a.useState)(null),[g,h]=(0,a.useState)(null),x=(0,a.useCallback)(async()=>{try{d(!0),m(null);let e=await fetch("/api/projects/stripe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:l,createAccount:!0})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to create connected account")}let{stripeAccountId:t}=await e.json();h(t);let s=await fetch("/api/projects/stripe-account-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:l,stripeAccountId:t})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to create account session")}let{clientSecret:n,publishableKey:a}=await s.json(),r=await (0,tf.e)({publishableKey:a,fetchClientSecret:async()=>n,appearance:{variables:{colorPrimary:"#3b82f6",colorBackground:"#1f2937",colorText:"#f3f4f6",colorSecondaryText:"#9ca3af",colorBorder:"#374151",colorDanger:"#ef4444",borderRadius:"8px",spacingUnit:"4px",fontFamily:'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'}}});i(r)}catch(e){console.error("Error setting up embedded onboarding:",e),m(e instanceof Error?e.message:"Failed to set up Stripe onboarding")}finally{d(!1)}},[l]);(0,a.useEffect)(()=>{t&&!o&&x()},[t,o,x]),(0,a.useEffect)(()=>{t||(i(null),d(!0),m(null),h(null))},[t]);let p=()=>{g&&r(g)},f=()=>{i(null),m(null),d(!0),x()};return t?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50","data-sentry-component":"CreateStripeAccountModal","data-sentry-source-file":"CreateStripeAccountModal.tsx",children:(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Set Up A Payments Profile"}),(0,n.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Complete the onboarding to start accepting payments in your app"})]}),(0,n.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 transition-colors",children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","data-sentry-element":"svg","data-sentry-source-file":"CreateStripeAccountModal.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12","data-sentry-element":"path","data-sentry-source-file":"CreateStripeAccountModal.tsx"})})})]}),(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[c&&(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,n.jsxs)("svg",{className:"animate-spin h-10 w-10 text-blue-600 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,n.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Setting up payments profile..."})]}),u&&(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,n.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-4 max-w-md",children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("svg",{className:"w-5 h-5 text-red-600 dark:text-red-400 mt-0.5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-red-800 dark:text-red-200 font-medium",children:"Setup Failed"}),(0,n.jsx)("p",{className:"text-red-700 dark:text-red-300 text-sm mt-1",children:u})]})]})}),(0,n.jsx)("button",{onClick:f,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Try Again"})]}),!c&&!u&&o&&(0,n.jsx)(tb.MT,{connectInstance:o,children:(0,n.jsx)("div",{className:"stripe-onboarding-container",children:(0,n.jsx)(tb.hw,{onExit:()=>{p()}})})}),!c&&!u&&!o&&(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,n.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Unable to load Stripe onboarding component."}),(0,n.jsx)("button",{onClick:f,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Retry"})]})]}),(0,n.jsx)("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400",children:[(0,n.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","data-sentry-element":"svg","data-sentry-source-file":"CreateStripeAccountModal.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z","data-sentry-element":"path","data-sentry-source-file":"CreateStripeAccountModal.tsx"})}),"Secured by Stripe"]}),(0,n.jsx)("button",{onClick:s,className:"px-4 py-2 text-sm text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-white transition-colors",children:"Cancel"})]})})]})}):null}var tv=function(e){return e.LOADING="loading",e.COMPLETED="completed",e.ERROR="error",e.STATUS="status",e.NEED_SUPABASE_KEY="need_supabase_key",e.CHOOSE_SUPABASE_PROJECT="choose_supabase_project",e.NEED_SECRETS="need_secrets",e.NEED_STRIPE="need_stripe",e.NEED_ANSWERS="need_answers",e}({}),tj=s(74243),tw=s(33191);let tN=e=>{let{messageId:t,preview:s,projectPreview:r,restoringPreview:l,onRestorePreview:o,timestamp:i,messageContent:d,actions:u,totalCost:m,duration:g,suggestions:h,onSuggestionClick:x,isLastCheckpoint:p=!1}=e,f=r&&s===r,b=!!l&&l===s,[y,v]=(0,a.useState)(null);return(0,n.jsx)("div",{className:"flex justify-center mt-2","data-sentry-component":"Checkpoint","data-sentry-source-file":"Checkpoint.tsx",children:(0,n.jsxs)("div",{className:"w-[85%]",children:[(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm",children:[(0,n.jsx)("div",{className:"p-3 border-b border-gray-100 dark:border-gray-700",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2.5",children:[(0,n.jsx)("div",{className:"w-8 h-8 bg-green-50 dark:bg-green-900/20 rounded-full flex items-center justify-center",children:(0,n.jsx)("svg",{className:"w-4 h-4 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","data-sentry-element":"svg","data-sentry-source-file":"Checkpoint.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z","data-sentry-element":"path","data-sentry-source-file":"Checkpoint.tsx"})})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"Checkpoint"}),i&&(0,n.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",title:(e=>e?("string"==typeof e?new Date(e):e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"")(i),children:(e=>{if(!e)return"";let t="string"==typeof e?new Date(e):e,s=t.toLocaleDateString("en-US",{month:"short"}),n=t.getDate(),a=t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return"".concat(s," ").concat(n,", ").concat(a)})(i)})]})]}),f&&(0,n.jsx)("div",{className:"px-2.5 py-0.5 bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-400 rounded-full text-xs font-medium",children:"Current"})]})}),u&&u.length>0&&(0,n.jsx)("div",{className:"border-b border-gray-100 dark:border-gray-700",children:(0,n.jsxs)("details",{className:"group",children:[(0,n.jsx)("summary",{className:"px-3 py-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors flex items-center justify-between select-none",children:(0,n.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,n.jsx)("svg",{className:"w-3.5 h-3.5 text-gray-500 dark:text-gray-400 group-open:rotate-90 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,n.jsxs)("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:[u.filter(e=>"finish"!==e.type).length," actions"]})]})}),(0,n.jsx)("div",{className:"px-3 pt-2 pb-2 border-t border-gray-100 dark:border-gray-700",children:(0,n.jsx)("ul",{className:"text-xs space-y-1 pl-5",children:u.filter(e=>"finish"!==e.type).map((e,t)=>(0,n.jsx)("li",{className:"text-gray-600 dark:text-gray-400",children:e.description},t))})})]})}),(0,n.jsx)("div",{className:"p-3 border-b border-gray-100 dark:border-gray-700",children:(0,n.jsxs)("div",{className:"flex gap-1.5",children:[!f&&(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),o(s)},className:"flex-1 flex items-center justify-center gap-1.5 px-2.5 py-1.5 rounded-md text-xs font-medium transition-all ".concat(b?"bg-gray-100 dark:bg-gray-800 text-gray-400 dark:text-gray-500 cursor-not-allowed":"bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600"),disabled:b,children:b?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{className:"animate-spin w-3.5 h-3.5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,n.jsx)("span",{children:"Rolling back..."})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-3.5 h-3.5",children:[(0,n.jsx)("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),(0,n.jsx)("path",{d:"M3 3v5h5"})]}),(0,n.jsx)("span",{children:"Rollback here"})]})}),(0,n.jsxs)(c(),{href:"https://".concat(s,".").concat("deploypad.app"),className:"".concat(f?"flex-1":""," flex items-center justify-center gap-1.5 px-2.5 py-1.5 rounded-md text-xs font-medium transition-all bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600"),target:"_blank",rel:"noopener noreferrer","data-sentry-element":"Link","data-sentry-source-file":"Checkpoint.tsx",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-3.5 h-3.5","data-sentry-element":"svg","data-sentry-source-file":"Checkpoint.tsx",children:[(0,n.jsx)("path",{d:"M15 3h6v6","data-sentry-element":"path","data-sentry-source-file":"Checkpoint.tsx"}),(0,n.jsx)("path",{d:"M10 14 21 3","data-sentry-element":"path","data-sentry-source-file":"Checkpoint.tsx"}),(0,n.jsx)("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6","data-sentry-element":"path","data-sentry-source-file":"Checkpoint.tsx"})]}),(0,n.jsx)("span",{children:"Preview"})]})]})}),void 0!==g&&(0,n.jsxs)("details",{className:"group",children:[(0,n.jsx)("summary",{className:"px-3 py-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors rounded-b-lg flex items-center justify-between select-none",children:(0,n.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,n.jsx)("svg",{className:"w-3.5 h-3.5 text-gray-500 dark:text-gray-400 group-open:rotate-90 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,n.jsxs)("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:[g<60?"".concat(g," seconds"):"".concat(Math.floor(g/60)," minutes ").concat(g%60," seconds")," of work"]})]})}),(0,n.jsx)("div",{className:"px-3 pt-2 pb-2 rounded-b-lg border-t border-gray-100 dark:border-gray-700",children:(0,n.jsxs)("div",{className:"space-y-1.5 pl-5",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center text-xs",children:[(0,n.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Time worked"}),(0,n.jsx)("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:g<60?"".concat(g," seconds"):"".concat(Math.floor(g/60),"m ").concat(g%60,"s")})]}),u&&u.length>0&&(0,n.jsxs)("div",{className:"flex justify-between items-center text-xs",children:[(0,n.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Work done"}),(0,n.jsxs)("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:[u.filter(e=>"finish"!==e.type).length," actions"]})]}),void 0!==m&&(0,n.jsxs)("div",{className:"flex justify-between items-center text-xs",children:[(0,n.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Build Usage"}),(0,n.jsxs)("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:["$",m<.01?m.toFixed(4):m.toFixed(2)]})]})]})})]})]}),h&&h.length>0&&(0,n.jsxs)("div",{className:"mt-1.5 space-y-1.5",children:[(0,n.jsx)("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 px-1",children:"Do Next:"}),h.map((e,t)=>(0,n.jsxs)("div",{className:"relative group",children:[(0,n.jsxs)("div",{className:"flex gap-1.5",children:[(0,n.jsx)("button",{onClick:t=>{t.stopPropagation(),x&&x(e.prompt)},className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-2 rounded-md text-sm font-medium transition-all bg-green-50 hover:bg-green-100 dark:bg-green-900/20 dark:hover:bg-green-900/40 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-700/50 hover:border-green-300 dark:hover:border-green-600",children:(0,n.jsx)("span",{children:e.shortTitle})}),(0,n.jsx)("button",{onClick:s=>{s.stopPropagation(),navigator.clipboard.writeText(e.prompt),v(t),setTimeout(()=>v(null),2e3)},className:"flex items-center justify-center px-2.5 py-2 rounded-md text-sm font-medium transition-all bg-green-50 hover:bg-green-100 dark:bg-green-900/20 dark:hover:bg-green-900/40 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-700/50 hover:border-green-300 dark:hover:border-green-600",title:"Copy to clipboard",children:y===t?(0,n.jsx)(eT.A,{className:"w-3.5 h-3.5"}):(0,n.jsx)(tw.A,{className:"w-3.5 h-3.5"})})]}),(0,n.jsx)("div",{className:"opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-200 absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-60 max-w-sm bg-gray-900 text-white text-xs rounded-md p-3 shadow-lg z-10 pointer-events-none",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("p",{className:"whitespace-pre-wrap",children:e.prompt}),(0,n.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-2 h-2 bg-gray-900 rotate-45"})]})})]},t))]})]})})};var tk=s(45299);function tC(e){let{percentage:t,remainingTime:s,className:r=""}=e,[l,o]=(0,a.useState)(0),[i,c]=(0,a.useState)(0),[d,u]=(0,a.useState)(!1),m=(0,a.useRef)({startPercentage:0,totalSeconds:0,elapsedSeconds:0});if((0,a.useEffect)(()=>{if(!d&&t>0&&s&&s>0){let e=Math.min(99,t);m.current={startPercentage:e,totalSeconds:s,elapsedSeconds:0},o(e),c(s),u(!0)}},[t,s,d]),(0,a.useEffect)(()=>{if(!d)return;let e=setInterval(()=>{m.current.elapsedSeconds+=1,c(e=>e<=1?1:e-1),o(()=>{let{startPercentage:e,totalSeconds:t,elapsedSeconds:s}=m.current;return Math.min(99,e+(99-e)*(1-Math.exp(-(s/t*3))))})},1e3);return()=>clearInterval(e)},[d]),!d)return null;let g=Math.round(l);return(0,n.jsxs)("div",{className:r,"data-sentry-component":"BuildProgressBarMovingFixed","data-sentry-source-file":"BuildProgressBarMovingFixed.tsx",children:[(0,n.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mb-1",children:[(0,n.jsxs)("span",{children:[g,"% complete"]}),i>0&&(0,n.jsxs)("span",{children:[(e=>{let t=Math.floor(e/60),s=Math.floor(e%60);return"".concat(t,":").concat(s.toString().padStart(2,"0"))})(i)," remaining"]})]}),(0,n.jsx)("div",{className:"w-full bg-gray-500/40 rounded-full h-3 overflow-hidden",children:(0,n.jsx)("div",{className:"progress-bar-animated h-3 rounded-full transition-all duration-1000 ease-linear",style:{width:"".concat(Math.min(100,l),"%")}})})]})}let tS=e=>{let{message:t,onUpgradeClick:s}=e,[r,l]=(0,a.useState)(!1),o=t.hasElementContext||!1,i=t.taggedText||null,c=t.content,d=c.length>300;if(t.status===tv.NEED_SUPABASE_KEY||t.status===tv.CHOOSE_SUPABASE_PROJECT||t.status===tv.NEED_SECRETS||t.status===tv.NEED_STRIPE||t.status===tv.NEED_ANSWERS)return null;if(t.status===tv.ERROR)return(0,n.jsx)("div",{className:"whitespace-pre-wrap text-sm break-words",children:"Build unsuccessful"});if(t.status===tv.STATUS&&t.content.startsWith("Waiting for priority builds")&&s)return(0,n.jsxs)("div",{className:"whitespace-pre-wrap text-sm break-words",children:["Waiting for priority builds to finish."," ",(0,n.jsx)("span",{className:"underline cursor-pointer",onClick:e=>{e.stopPropagation(),s()},children:"Upgrade now"})," ","to get ahead of the line."]});if(t.status===tv.STATUS&&t.content.startsWith("Waiting for priority responses")&&s)return(0,n.jsxs)("div",{className:"whitespace-pre-wrap text-sm break-words",children:["Waiting for priority responses to finish."," ",(0,n.jsx)("span",{className:"underline cursor-pointer",onClick:e=>{e.stopPropagation(),s()},children:"Upgrade now"})," ","to get ahead of the line."]});if((t.status===tv.COMPLETED||t.status===tv.STATUS)&&t.content.startsWith("You have reached your build credit limit")&&s)return(0,n.jsxs)("div",{className:"whitespace-pre-wrap text-sm break-words",children:["You have reached your build credit limit for this billing cycle."," ",(0,n.jsx)("span",{className:"underline cursor-pointer",onClick:e=>{e.stopPropagation(),s()},children:"Upgrade now"})," ","to continue."]});let u=e=>e.split("\\n").map((t,s)=>(0,n.jsxs)(a.Fragment,{children:[t,s<e.split("\\n").length-1&&(0,n.jsx)("br",{})]},s));if("user"===t.role&&d&&!r){let e=t.content.substring(0,300);return(0,n.jsxs)("div",{className:"whitespace-pre-wrap text-sm break-words",children:[u(e),(0,n.jsx)("span",{children:"..."}),(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),l(!0)},className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-xs font-medium",children:"Show more"})]})}return(0,n.jsxs)("div",{className:"whitespace-pre-wrap text-sm break-words","data-sentry-component":"MessageContent","data-sentry-source-file":"Chat.tsx",children:["user"===t.role&&o&&i&&(0,n.jsxs)("div",{className:"flex items-center space-x-1 mb-2 text-blue-600 dark:text-blue-400",children:[(0,n.jsx)(er.A,{className:"w-3 h-3"}),(0,n.jsxs)("span",{className:"text-xs font-medium",children:['"',i.length>30?i.substring(0,30)+"...":i,'"']})]}),u(c),"user"===t.role&&d&&r&&(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),l(!1)},className:"block mt-2 text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-xs font-medium",children:"Show less"}),"user"===t.role&&(t.maxMode||t.geniusMode)&&(0,n.jsxs)("div",{className:"flex items-center gap-3 mt-2 text-gray-400 dark:text-gray-500 select-none",children:[t.maxMode&&(0,n.jsxs)("div",{className:"inline-flex items-center text-xs",children:[(0,n.jsx)(tk.A,{className:"w-3 h-3 mr-1.5",strokeWidth:1.5}),(0,n.jsx)("span",{children:"Bulldozer"})]}),t.geniusMode&&(0,n.jsxs)("div",{className:"inline-flex items-center text-xs",children:[(0,n.jsx)("svg",{className:"w-3 h-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),(0,n.jsx)("span",{children:"Genius"})]})]})]})},tE=(0,a.forwardRef)((e,t)=>{let{initialPrompt:s,onSendMessage:r,onBeforeSendMessage:l,onStopProject:o,isLoading:i,projectId:c,projectStatus:u,projectPreview:m,onRestorePreview:g,restoringPreview:x,hideHeader:p=!1,onErrorClick:f,onTryToFixIt:b,isMobile:y=!1,platform:j="website",statusPercentage:w,statusRemainingTime:N}=e,[k,C]=(0,a.useState)([]),[S,E]=(0,a.useState)(""),[T,I]=(0,a.useState)([]),[A,D]=(0,a.useState)(!1),[P,M]=(0,a.useState)(""),[L,O]=(0,a.useState)(!1),[R,F]=(0,a.useState)(!1),[B,U]=(0,a.useState)({}),[z,W]=(0,a.useState)({}),[_,H]=(0,a.useState)({}),[G,V]=(0,a.useState)({}),[J,$]=(0,a.useState)({}),[q,X]=(0,a.useState)(!1),[Y,K]=(0,a.useState)(!1),[Q,Z]=(0,a.useState)(null),{data:ee}=(0,th.useSession)(),{aiSelectionMode:et,taggedSelection:es,isTaggingElement:en,setAiSelectionMode:ea,clearTaggedSelection:el,clearSelectedElement:eo,setInspectorMode:ei,setEditingTool:ec,setPreviewType:ed,setSelectedElement:eu}=h(),[em,eg]=(0,a.useState)(!1),[eh,ex]=(0,a.useState)(!1),[ep,ef]=(0,a.useState)(0),[eb,ey]=(0,a.useState)(""),[ev,ej]=(0,a.useState)(""),[ew,eN]=(0,a.useState)(!1);(0,a.useRef)(null);let[eS,eE]=(0,a.useState)(!1),[eT,eI]=(0,a.useState)(!1),[eA,eD]=(0,a.useState)(()=>!1),[eP,eM]=(0,a.useState)(()=>{{let e=localStorage.getItem("chatImageGeneration");return!e||JSON.parse(e)}}),[eL,eO]=(0,a.useState)(()=>{{let e=localStorage.getItem("chatWebSearch");return!e||JSON.parse(e)}}),[eR,eF]=(0,a.useState)(()=>!1),eB=(0,a.useRef)(null),eU=(0,a.useRef)(null),ez=(0,a.useRef)(!1),eW=(0,a.useRef)(!1),e_=(0,a.useRef)(null),[eH,eG]=(0,a.useState)(!0),{isWhitelabel:eV,whitelabelConfig:eJ}=(0,d.p)();(0,a.useEffect)(()=>{let e=setTimeout(()=>{eG(!1)},3e3);return()=>clearTimeout(e)},[]),(0,a.useEffect)(()=>{localStorage.setItem("chatMaxMode",JSON.stringify(eA))},[eA]),(0,a.useEffect)(()=>{localStorage.setItem("chatImageGeneration",JSON.stringify(eP))},[eP]),(0,a.useEffect)(()=>{localStorage.setItem("chatWebSearch",JSON.stringify(eL))},[eL]),(0,a.useEffect)(()=>{localStorage.setItem("chatGeniusMode",JSON.stringify(eR))},[eR]),(0,a.useEffect)(()=>{eB.current&&(eB.current.focus(),eB.current.style.height="auto",eB.current.style.height="".concat(eB.current.scrollHeight,"px"))},[S]);let[e$,eq]=(0,a.useState)(!1),[eX,eY]=(0,a.useState)(null),[eK,eQ]=(0,a.useState)(!1),eZ=(0,a.useRef)(!1),e0=(0,a.useCallback)(async e=>{try{let t=await fetch("/api/uploads/signed-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileType:e.type,fileName:e.name||"image-".concat(Date.now(),".").concat(e.type.split("/")[1])})});if(!t.ok)throw Error("Failed to get signed URL");let{signedUrl:s,fileUrl:n}=await t.json();if(!(await fetch(s,{method:"PUT",body:e,headers:{"Content-Type":e.type},mode:"cors"})).ok)throw Error("Failed to upload file");return n}catch(e){return console.error("Error uploading file:",e),null}},[]),e1=(0,tj.VB)(),e2=(0,a.useRef)(null),e4=(0,a.useRef)([]);(0,a.useEffect)(()=>{e4.current=T},[T]),(0,a.useEffect)(()=>{if(!e2.current)return e2.current=e1.registerHandler({uploadFiles:async e=>{console.log("Chat: Handling ".concat(e.length," dropped files")),D(!0);try{let t=[...e4.current];for(let s of e){let e=await e0(s);e&&t.push(e)}I(t)}catch(e){console.error("Error uploading dropped files:",e)}finally{D(!1)}}}),()=>{e2.current&&(e1.unregisterHandler(e2.current),e2.current=null)}},[e1,e0]);let e3=(0,a.useCallback)(async e=>{if(e.preventDefault(),e.stopPropagation(),!i&&(console.log("Chat: Files dropped directly on chat component"),e.dataTransfer.files&&e.dataTransfer.files.length>0)){let t=Array.from(e.dataTransfer.files).filter(e=>e.type.startsWith("image/")&&e.size<=5242880);if(t.length>0){D(!0);try{let e=[...T];for(let s of t){let t=await e0(s);t&&e.push(t)}I(e)}catch(e){console.error("Error uploading dropped files:",e)}finally{D(!1)}}}},[i,T,e0]),e5=(0,a.useCallback)(async()=>{if(!eZ.current)try{eZ.current=!0,eQ(!0);let e=await fetch("/api/subscription");if(e.ok){let t=await e.json();t.subscription&&eY(t.subscription)}else console.error("Failed to fetch subscription data")}catch(e){console.error("Error fetching subscription data:",e)}finally{eQ(!1),eZ.current=!1}},[]),te=(0,a.useCallback)(async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"completed",n=arguments.length>3?arguments[3]:void 0;if(c){if("status"===s)return null;try{let a=!1,r=!1;localStorage.getItem("chatMaxMode"),localStorage.getItem("chatGeniusMode"),a=!1,r=!1;let l=await fetch("/api/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:c,role:e,content:t,status:s,attachments:n,maxMode:a,geniusMode:r})});if(!l.ok){if(402===l.status&&(await l.json()).requiresUpgrade){eq(!0);let e={id:"assistant-".concat(Date.now().toString()),role:"assistant",content:"You have reached your build credit limit. Upgrade now to continue.",status:tv.COMPLETED};throw C(t=>[...t,e]),Error("Subscription limit reached")}throw Error("Failed to save message")}return await l.json()}catch(e){throw console.error("Error saving message:",e),e}}},[c]),tt=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(c&&!eW.current){eW.current=!0;try{var n;let a=await fetch("/api/messages?projectId=".concat(c,"&offset=").concat(e,"&limit=60"));if(!a.ok)throw Error("Failed to fetch messages");let r=await a.json();if(console.log("Messages:",r),eg(r.hasMore||!1),ef(e+((null===(n=r.messages)||void 0===n?void 0:n.length)||0)),r.messages&&r.messages.length>0){let e=r.messages.map(e=>{let{hasElementContext:t,taggedText:s,displayContent:n}=(e=>{let t=e.match(/^AI_CONTEXT:(.+?)\|\|([\s\S]*)$/);if(t)try{let e=JSON.parse(t[1]);return{hasElementContext:!0,taggedText:e.text,displayContent:t[2]}}catch(e){}return{hasElementContext:!1,taggedText:null,displayContent:e}})(e.content);if(e.content.includes("AI_CONTEXT:")){console.log("\uD83D\uDD04 Loading message with AI context:",e.content),console.log("\uD83D\uDD04 Parsed result:",{hasElementContext:t,taggedText:s,displayContent:n});let a=e.content.match(/^AI_CONTEXT:(.+?)\|\|([\s\S]*)$/);console.log("\uD83D\uDD04 Regex test match:",a)}return{id:e._id,role:e.role,content:n,status:e.status||"completed",attachments:e.attachments||[],supabaseProjects:e.supabaseProjects||[],stripeAccounts:e.stripeAccounts||[],preview:e.preview||null,createdAt:e.createdAt||null,secrets:e.secrets||[],experiment:e.experiment||void 0,variation:e.variation||void 0,forceExperiment:e.forceExperiment||void 0,forceVariation:e.forceVariation||void 0,outcome:e.outcome||void 0,questions:e.questions||[],actions:e.actions||[],totalCost:e.totalCost||void 0,duration:e.duration||void 0,suggestions:e.suggestions||[],hasElementContext:t,taggedText:s,maxMode:e.maxMode||!1,geniusMode:e.geniusMode||!1}});t?C(t=>[...e,...t].filter((e,t,s)=>t===s.findIndex(t=>t.id===e.id))):(C(e),ez.current=!0,"assistant"===e[e.length-1].role?(ey(e[e.length-1].forceExperiment||""),ej(e[e.length-1].forceVariation||"")):(ey(""),ej("")),setTimeout(()=>{var e;null===(e=eU.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100))}else if(s&&!ez.current&&!t)try{await te("user",s),ez.current=!0}catch(e){ez.current=!0}}catch(e){console.error("Error loading messages:",e)}finally{eW.current=!1}}},[c,s,te]),ts=(0,a.useCallback)(async()=>{if(em&&!eh){ex(!0);try{await tt(ep,!0)}catch(e){console.error("Error loading more messages:",e)}finally{ex(!1)}}},[em,eh,ep,tt]);(0,a.useEffect)(()=>{c&&tt()},[c,tt]),(0,a.useEffect)(()=>{i&&k.length>0&&!eH&&setTimeout(()=>{var e;null===(e=eU.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100)},[i,k,eH]),(0,a.useEffect)(()=>{e5()},[e5]),(0,a.useImperativeHandle)(t,()=>({addAssistantMessage:async(e,t,s)=>{let n={id:"assistant-".concat(Date.now().toString()),role:"assistant",content:e,status:t};if(C(e=>[...e,n]),setTimeout(()=>{var e;null===(e=eU.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100),s)try{let s=await te("assistant",e,t);s&&C(e=>e.map(e=>e.id===n.id?{...e,id:s.message._id}:e))}catch(e){console.error("Error saving assistant message:",e)}},updateLastAssistantMessage:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tv.COMPLETED;C(s=>{let n=s.filter(e=>"assistant"===e.role);return 0===n.length?[...s,{id:"assistant-".concat(Date.now().toString()),role:"assistant",content:e,status:t}]:s.map(s=>s.id===n[n.length-1].id?{...s,content:e,status:t}:s)}),setTimeout(()=>{var e;null===(e=eU.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100);try{await te("assistant",e,t)}catch(e){console.error("Error updating assistant message:",e)}},fetchAndUpdateMessages:async()=>{try{console.log("Fetching and updating messages"),eW.current=!1,ef(0),eg(!1),await tt()}catch(e){console.error("Error fetching and updating messages:",e)}},submitHumanMessage:e=>{if(l&&!l(e,[])){E(e),I([]);return}E(e),I([]),setTimeout(()=>{E("");let t={id:"user-".concat(Date.now().toString()),role:"user",content:e,maxMode:eA,geniusMode:eR};C(e=>[...e,t]),setTimeout(()=>{var e;null===(e=eU.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100),te("user",e,"completed").then(s=>{s&&C(e=>e.map(e=>e.id===t.id?{...e,id:s.message._id}:e)),r(e,[],!1,!1,!1,s.message._id,!1,[],eb,ev)}).catch(e=>{console.error("Error sending message:",e)})},0)}}));let tn=async e=>{var t;if(!(null===(t=e.target.files)||void 0===t?void 0:t.length))return;D(!0);let s=Array.from(e.target.files).filter(e=>["image/jpeg","image/png","image/gif","image/webp"].includes(e.type)&&e.size<=5242880);if(0===s.length){D(!1);return}try{let e=[...T];for(let t of s){let s=await e0(t);s&&e.push(s)}I(e)}finally{D(!1),e_.current&&(e_.current.value="")}},ta=async e=>{D(!0);try{let t=await e0(e);t?I(e=>[...e,t]):v.oR.error("Failed to upload pasted image")}catch(e){console.error("Error uploading pasted image:",e),v.oR.error("Failed to upload pasted image")}finally{D(!1)}};(0,a.useEffect)(()=>{es&&setTimeout(()=>{if(eB.current){eB.current.focus();let e=eB.current.value.length;eB.current.setSelectionRange(e,e)}},100)},[es]);let tr=async()=>{if(!S.trim()&&0===T.length||i)return;let e=[...T];if(console.log("Chat sending selectedElementData:",es),l&&!l(S,e))return;let t={id:"user-".concat(Date.now().toString()),role:"user",content:S,attachments:T.length>0?[...T]:void 0,hasElementContext:!!es,taggedText:null==es?void 0:es.text,maxMode:eA,geniusMode:eR};C(e=>[...e,t]),E(""),I([]),es&&(el(),ei(!1),ec("navigate"),ed("old"),eu(null),et&&ea(!1)),setTimeout(()=>{var e;null===(e=eU.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100);try{let s=S;if(null==es?void 0:es.text){let e={text:es.text,isImage:es.isImage||!1,...es.isImage&&{imageSrc:es.imageSrc,imageAlt:es.imageAlt,imageTitle:es.imageTitle}};s="AI_CONTEXT:".concat(JSON.stringify(e),"||").concat(S)}let n=await te("user",s,"completed",e);n&&C(e=>e.map(e=>e.id===t.id?{...e,id:n.message._id}:e)),r(S,e.length>0?e:[],!1,!1,!1,n.message._id,!1,[],eb,ev,es)}catch(e){console.error("Error sending message:",e)}},tl=async e=>{if(P.trim()&&!L){O(!0);try{let t=await fetch("/api/users/supabase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:P})});if(!t.ok||200!==t.status){let e=await t.json();throw Error(e.error||"Failed to save Supabase key")}C(t=>t.map(t=>t.id===e?{...t,status:tv.COMPLETED,content:"Successfully added access token. Continuing.."}:t)),M("");let s="",n=[],a="";for(let e=k.length-1;e>=0;e--)if("user"===k[e].role){s=k[e].content,n=k[e].attachments||[],a=k[e].id;break}s.trim()&&setTimeout(()=>{r(s,n,!0,!1,!1,a,!1,[],eb,ev)},500)}catch(e){v.oR.error((null==e?void 0:e.message)||"Failed to save Supabase key. Please try again.")}finally{O(!1)}}},to=async(e,t,s,n)=>{if(!R){F(!0);try{if(n){C(t=>t.map(t=>t.id===e?{...t,status:tv.STATUS,content:"Setting up database..."}:t));let s=await fetch("/api/projects/databasepad",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c,id:t})});if(!s.ok||200!==s.status){let e=await s.json();throw Error(e.error||"Failed to set up database")}C(t=>t.map(t=>t.id===e?{...t,status:tv.STATUS,content:"Database ready. Continuing..."}:t))}else{let s=await fetch("/api/projects/supabase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c,id:t,isInternal:!1})});if(!s.ok||200!==s.status){let e=await s.json();throw Error(e.error||"Failed to set up database")}C(t=>t.map(t=>t.id===e?{...t,status:tv.STATUS,content:"Setting up database. Please wait..."}:t));let n=!1,a=0;for(;!n;){let e=await fetch("/api/projects/supabase-status?projectId=".concat(c),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok||200!==e.status)throw Error("Failed to check project health status");if(n=(await e.json()).isHealthy)break;if(++a>60)throw Error("Failed to check project health status");await new Promise(e=>setTimeout(e,5e3))}let r=await fetch("/api/projects/supabase-keys",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c})});if(!r.ok||200!==r.status){let e=await r.json();throw Error(e.error||"Failed to set up database")}}C(t=>t.map(t=>t.id===e?{...t,status:tv.STATUS,content:"Successfully set up database. Continuing..."}:t));let s="",a=[],l="";for(let e=k.length-1;e>=0;e--)if("user"===k[e].role){s=k[e].content,a=k[e].attachments||[],l=k[e].id;break}s.trim()&&setTimeout(()=>{r(s,a,!0,!1,!1,l,!1,[],eb,ev)},500)}catch(e){v.oR.error((null==e?void 0:e.message)||"Failed to set up database. Please try again.",{duration:1e4})}finally{F(!1)}}},ti=async(e,t)=>{var s;if((null===(s=B[t])||void 0===s?void 0:s.trim())&&!z[t]){W(e=>({...e,[t]:!0}));try{let s=k.find(t=>t.id===e),n=(null==s?void 0:s.secrets)?s.secrets.filter(e=>e.name!==t).length:0,a=0===n,l=await fetch("/api/projects/secrets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c,secretName:t,secretValue:B[t],hasMoreSecrets:!a})});if(!l.ok||200!==l.status){let e=await l.json();throw Error(e.error||"Failed to save secret")}if(C(s=>s.map(s=>{if(s.id===e){let e=(s.secrets||[]).filter(e=>e.name!==t);return 0===e.length?{...s,status:tv.COMPLETED,content:"Successfully added secrets. Continuing...",secrets:[]}:{...s,secrets:e}}return s})),U(e=>{let s={...e};return delete s[t],s}),a){let e="",t=[],s="";for(let n=k.length-1;n>=0;n--)if("user"===k[n].role){e=k[n].content,t=k[n].attachments||[],s=k[n].id;break}e.trim()&&setTimeout(()=>{r(e,t,!0,!1,!0,s,!1,[],eb,ev)},500)}}catch(e){v.oR.error((null==e?void 0:e.message)||"Failed to save secret. Please try again.")}finally{W(e=>({...e,[t]:!1}))}}},tc=async(e,t)=>{let s=k.find(t=>t.id===e),n=0===((null==s?void 0:s.secrets)?s.secrets.filter(e=>e.name!==t).length:0);C(s=>s.map(s=>{if(s.id===e){let e=(s.secrets||[]).filter(e=>e.name!==t);return 0===e.length?{...s,status:tv.COMPLETED,content:"Skipped secrets. Continuing.",secrets:[]}:{...s,secrets:e}}return s})),U(e=>{let s={...e};return delete s[t],s});try{let s=await fetch("/api/projects/skipsecrets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c,messageId:e,secretName:t,hasMoreSecrets:!n})});if(!s.ok||200!==s.status){let e=await s.json();throw Error(e.error||"Failed to skip secret")}if(n){let e="",t=[],s="";for(let n=k.length-1;n>=0;n--)if("user"===k[n].role){e=k[n].content,t=k[n].attachments||[],s=k[n].id;break}e.trim()&&setTimeout(()=>{r(e,t,!0,!1,!0,s,!1,[],eb,ev)},500)}}catch(e){v.oR.error((null==e?void 0:e.message)||"Failed to skip secret. Please try again.")}},td=async e=>{try{C(t=>t.map(t=>t.id===e?{...t,status:tv.COMPLETED,content:"Skipped database integration. Continuing."}:t));let t=await fetch("/api/users/skipsupabase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c,messageId:e})});if(!t.ok||200!==t.status){let e=await t.json();throw Error(e.error||"Failed to skip database integration")}let s="",n=[],a="";for(let e=k.length-1;e>=0;e--)if("user"===k[e].role){s=k[e].content,n=k[e].attachments||[],a=k[e].id;break}s.trim()&&setTimeout(()=>{r(s,n,!1,!0,!1,a,!1,[],eb,ev)},500)}catch(e){v.oR.error((null==e?void 0:e.message)||"Failed to skip database integration. Please try again.")}},tu=async e=>{try{C(t=>t.map(t=>t.id===e?{...t,status:tv.COMPLETED,content:"Skipped database selection. Continuing."}:t));let t=await fetch("/api/projects/skipsupabase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c,messageId:e})});if(!t.ok||200!==t.status){let e=await t.json();throw Error(e.error||"Failed to skip database project selection")}let s="",n=[],a="";for(let e=k.length-1;e>=0;e--)if("user"===k[e].role){s=k[e].content,n=k[e].attachments||[],a=k[e].id;break}s.trim()&&setTimeout(()=>{r(s,n,!1,!0,!1,a,!1,[],eb,ev)},500)}catch(e){v.oR.error((null==e?void 0:e.message)||"Failed to skip database project selection. Please try again.")}},tm=async(e,t)=>{if(!q){X(!0);try{let s=await fetch("/api/projects/stripe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c,stripeAccountId:t})});if(!s.ok||200!==s.status){let e=await s.json();throw Error(e.error||"Failed to set Stripe account")}C(t=>t.map(t=>t.id===e?{...t,status:tv.STATUS,content:"Payments profile connected. Continuing..."}:t));let n="",a=[],l="";for(let e=k.length-1;e>=0;e--)if("user"===k[e].role){n=k[e].content,a=k[e].attachments||[],l=k[e].id;break}n.trim()&&setTimeout(()=>{r(n,a,!1,!0,!0,l,!1,[],eb,ev)},500)}catch(e){v.oR.error((null==e?void 0:e.message)||"Failed to set Stripe account. Please try again.")}finally{X(!1)}}},tg=e=>{Z(e),K(!0)},tx=async e=>{K(!1),Q&&await tm(Q,e),Z(null)},tf=async e=>{try{C(t=>t.map(t=>t.id===e?{...t,status:tv.COMPLETED,content:"Skipped payment profile selection. Continuing."}:t));let t=await fetch("/api/projects/skipstripe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c,messageId:e})});if(!t.ok||200!==t.status){let e=await t.json();throw Error(e.error||"Failed to skip payment profile selection")}let s="",n=[],a="";for(let e=k.length-1;e>=0;e--)if("user"===k[e].role){s=k[e].content,n=k[e].attachments||[],a=k[e].id;break}s.trim()&&setTimeout(()=>{r(s,n,!1,!0,!0,a,!1,[],eb,ev)},500)}catch(e){v.oR.error((null==e?void 0:e.message)||"Failed to skip payment profile selection. Please try again.")}},tb=async e=>{if(i)return;if(l&&!l(e,[])){E(e);return}let t={id:"user-".concat(Date.now().toString()),role:"user",content:e,attachments:void 0,maxMode:eA,geniusMode:eR};C(e=>[...e,t]),E(""),I([]),setTimeout(()=>{var e;null===(e=eU.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100);try{let s=await te("user",e,"completed",[]);s&&C(e=>e.map(e=>e.id===t.id?{...e,id:s.message._id}:e)),r(e,[],!1,!1,!1,s.message._id,!1,[],eb,ev)}catch(e){console.error("Error sending suggestion message:",e)}},tw=async(e,t)=>{try{C(s=>s.map(s=>s.id===e?{...s,outcome:t}:s)),v.oR.success("Thank you for your feedback!",{duration:4e3});let s=await fetch("/api/messages/vote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messageId:e,outcome:t})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to record vote")}}catch(e){console.error(e)}},tk=async e=>{try{$(t=>({...t,[e]:!0}));let t=_[e]||{},s=G[e]||{},n=Object.entries(t).filter(e=>{let[t,n]=e;return!s[t]&&n.trim()}).map(e=>{let[t,s]=e;return{question:t,answer:s}});C(t=>t.map(t=>t.id===e?{...t,status:tv.COMPLETED,content:n.length>0?"Answers provided. Continuing...":"Questions skipped. Continuing..."}:t));let a="",l=[],o="";for(let e=k.length-1;e>=0;e--)if("user"===k[e].role){a=k[e].content,l=k[e].attachments||[],o=k[e].id;break}a.trim()&&setTimeout(()=>{r(a,l,!1,!1,!1,o,!0,n,eb,ev)},500)}catch(e){v.oR.error((null==e?void 0:e.message)||"Failed to submit answers. Please try again.")}finally{$(t=>({...t,[e]:!1}))}};return(0,n.jsx)(e6,{children:(0,n.jsxs)("div",{className:"flex flex-col h-full overflow-hidden ".concat(y?"pb-safe":""),onDragOver:e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},onDrop:e3,children:[!p&&(0,n.jsx)("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:(0,n.jsx)("h2",{className:"text-base font-semibold text-gray-900 dark:text-white",children:"Chat"})}),(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-2 sm:p-4 space-y-3 sm:space-y-4 ".concat(y?"pb-safe":""),children:[0===k.length?(0,n.jsx)("div",{className:"flex items-center justify-center h-full text-gray-400 text-sm",children:(0,n.jsx)("p",{children:"No messages yet. Start by suggesting a change."})}):(0,n.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[em&&(0,n.jsx)("div",{className:"flex justify-center pb-2",children:(0,n.jsx)("button",{onClick:ts,disabled:eh,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat(eh?"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 border border-gray-200 dark:border-gray-600"),children:eh?(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsxs)("svg",{className:"animate-spin w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,n.jsx)("span",{children:"Loading..."})]}):(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),(0,n.jsx)("span",{children:"Load More Messages"})]})})}),k.map((e,t)=>{var s,r,l,o;return(0,n.jsxs)(a.Fragment,{children:[(0,n.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,n.jsxs)("div",{className:"max-w-[92%] sm:max-w-[85%] rounded-lg p-2 sm:p-3 overflow-hidden ".concat("user"===e.role?"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200":e.status===tv.LOADING?"bg-primary text-white":e.status===tv.ERROR?"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-300 border border-red-200 dark:border-red-900/50":e.status===tv.STATUS?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-300 border border-blue-200 dark:border-blue-900/50":e.status===tv.NEED_SUPABASE_KEY||e.status===tv.CHOOSE_SUPABASE_PROJECT||e.status===tv.NEED_STRIPE?"bg-white text-black":e.status===tv.NEED_ANSWERS?"bg-purple-50 dark:bg-purple-900/20 text-purple-900 dark:text-purple-200 border border-purple-200 dark:border-purple-900/50":"bg-primary text-white"),children:[e.status===tv.ERROR&&(0,n.jsx)("div",{className:"flex items-center justify-between mb-1",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"mr-2 text-red-500",children:(0,n.jsx)("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,n.jsx)("span",{className:"text-xs text-red-500",children:"Error occurred"})]})}),e.status===tv.STATUS&&(0,n.jsxs)("div",{className:"flex items-center mb-1",children:[(0,n.jsx)("div",{className:"mr-2 text-blue-500",children:(0,n.jsx)("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,n.jsx)("span",{className:"text-xs text-blue-500",children:"Status update"})]}),e.status===tv.NEED_SUPABASE_KEY&&(0,n.jsxs)("div",{className:"flex flex-col space-y-2 mb-1",children:[(0,n.jsxs)("div",{className:"text-sm mb-2",children:[(0,n.jsx)("p",{children:"You'll need to have a Supabase account to add backend functionality:"}),(0,n.jsxs)("ol",{className:"list-decimal list-inside mt-2 ml-1 space-y-1",children:[(0,n.jsxs)("li",{children:["Go to"," ",(0,n.jsx)("a",{href:"https://supabase.com",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline",children:"Supabase.com"})," ","to log in or sign up for a free account"]}),(0,n.jsxs)("li",{children:["Go to"," ",(0,n.jsx)("a",{href:"https://supabase.com/dashboard/account/tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline",children:"Access Tokens"})]}),(0,n.jsx)("li",{children:"Generate a new token"}),(0,n.jsx)("li",{children:"Paste it below"})]})]}),(0,n.jsxs)("div",{className:"mt-3",children:[(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)("input",{type:"password",value:P,onChange:e=>M(e.target.value),placeholder:"Paste token",className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-white text-gray-900 text-sm focus:outline-none focus:ring-1 focus:ring-gray-500 focus:border-gray-500",disabled:L})}),(0,n.jsx)("button",{onClick:()=>tl(e.id),disabled:!P.trim()||L,className:"px-4 py-2 rounded-md text-sm font-medium ".concat(!P.trim()||L?"bg-gray-400 text-white cursor-not-allowed":"bg-black text-white"),children:L?(0,n.jsxs)("svg",{className:"animate-spin w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Submit"})]}),(0,n.jsxs)("div",{className:"mt-3 flex justify-between items-center",children:[(0,n.jsxs)("div",{className:"relative group",children:[(0,n.jsxs)("span",{className:"text-xs text-blue-500 hover:text-blue-700 cursor-help flex items-center",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Why do I need this?"]}),(0,n.jsx)("div",{className:"opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-200 absolute bottom-full left-28 transform -translate-x-1/2 mb-2 w-[180%] bg-gray-900 text-white text-xs rounded-md p-3 shadow-lg z-10",children:(0,n.jsx)("div",{className:"relative",children:(0,n.jsx)("p",{className:"mb-2",children:"Supabase is a platform that lets you build web apps quickly by providing a hosted database, user login system, file storage, and other features that need to run on a secure server. The cloud version at supabase.com manages all the setup and infrastructure for you, so you can focus on building your app without worrying about backend servers."})})})]}),(0,n.jsx)("div",{className:"text-xs text-gray-500 hover:text-gray-700 hover:underline cursor-pointer",onClick:t=>{t.stopPropagation(),td(e.id)},children:"Skip"})]})]})]}),e.status===tv.CHOOSE_SUPABASE_PROJECT&&(0,n.jsx)("div",{className:"flex flex-col space-y-2 mb-1",children:(0,n.jsxs)("div",{className:"text-sm",children:[(0,n.jsx)("p",{children:"Choose or create a database for your backend:"}),e.supabaseProjects&&e.supabaseProjects.length>0&&(0,n.jsx)("div",{className:"mt-3 space-y-2",children:(0,n.jsx)("div",{className:"grid grid-cols-1 gap-2",children:e.supabaseProjects.map(t=>(0,n.jsxs)("button",{onClick:()=>to(e.id,t.id,t.isInternalSupabase,t.isInternalDatabase),disabled:R,className:"flex flex-col items-start px-4 py-3 border border-gray-300 rounded-md bg-white text-gray-800 text-sm hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-gray-500 focus:border-gray-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,n.jsxs)("div",{className:"flex items-center w-full mb-1",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 text-emerald-500 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M12 5l7 7-7 7"})}),(0,n.jsx)("span",{className:"font-medium",children:t.name})]}),(0,n.jsx)("div",{className:"ml-6 text-xs text-gray-500",children:t.id})]},t.id))})}),((null==ee?void 0:null===(s=ee.user)||void 0===s?void 0:s.isAdmin)===!0||(null==ee?void 0:null===(r=ee.user)||void 0===r?void 0:r.flagDatabase)===!0)&&(0,n.jsxs)("div",{className:"mt-2",children:[(0,n.jsxs)("button",{onClick:()=>to(e.id,null,!1,!0),disabled:R,className:"w-full flex items-center justify-center px-4 py-4 border-2 border-emerald-600 rounded-lg bg-emerald-600 text-white text-md font-semibold hover:bg-emerald-700 hover:border-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 transition-all shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,n.jsxs)("span",{children:["Create a new"," ",eV?null==eJ?void 0:eJ.siteName:"Famous.ai"," ","database"]})]}),(null==ee?void 0:null===(l=ee.user)||void 0===l?void 0:l.encryptedSupabaseKey)&&(0,n.jsx)("div",{className:"mt-1 text-xs text-center text-gray-500",children:"Recommended: Faster setup and managed for you"})]}),(null==ee?void 0:null===(o=ee.user)||void 0===o?void 0:o.encryptedSupabaseKey)&&(0,n.jsx)("div",{className:"mt-3",children:(0,n.jsxs)("button",{onClick:()=>to(e.id,null,!1,!1),disabled:R,className:"w-full flex items-center justify-center px-4 py-2.5 border border-gray-300 rounded-md bg-white text-gray-700 text-sm hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-gray-400 focus:border-gray-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,n.jsx)("span",{className:"font-normal",children:"Create a new Supabase database"})]})}),(0,n.jsxs)("div",{className:"mt-3 flex justify-between items-center",children:[(0,n.jsxs)("div",{className:"relative group",children:[(0,n.jsxs)("span",{className:"text-xs text-blue-500 hover:text-blue-700 cursor-help flex items-center",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Which should I choose?"]}),(0,n.jsx)("div",{className:"opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-200 absolute bottom-full left-32 transform -translate-x-1/2 mb-2 w-[180%] bg-gray-900 text-white text-xs rounded-md p-3 shadow-lg z-10",children:(0,n.jsx)("div",{className:"relative",children:(0,n.jsx)("p",{className:"mb-2",children:"Choose an existing project if you want to connect to a backend or database you've already set up. Create a new project if this integration is for a separate app or feature, so you can keep things organized and avoid conflicts in your database or backend."})})})]}),(0,n.jsx)("div",{className:"text-xs text-gray-500 hover:text-gray-700 hover:underline cursor-pointer",onClick:t=>{t.stopPropagation(),tu(e.id)},children:"Skip"})]})]})}),e.status===tv.NEED_STRIPE&&(0,n.jsx)("div",{className:"flex flex-col space-y-2 mb-1",children:(0,n.jsxs)("div",{className:"text-sm",children:[(0,n.jsx)("p",{children:"Choose or create a payments profile to accept payments in your app:"}),e.stripeAccounts&&e.stripeAccounts.length>0&&(0,n.jsx)("div",{className:"mt-3 space-y-2",children:(0,n.jsx)("div",{className:"grid grid-cols-1 gap-2",children:e.stripeAccounts.map(t=>(0,n.jsxs)("button",{onClick:()=>tm(e.id,t.id),disabled:q,className:"flex flex-col items-start px-4 py-3 border border-gray-300 rounded-md bg-white text-gray-800 text-sm hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-gray-500 focus:border-gray-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,n.jsxs)("div",{className:"flex items-center w-full mb-1",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 text-purple-500 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),(0,n.jsx)("span",{className:"font-medium",children:t.name||t.id})]}),(0,n.jsxs)("div",{className:"ml-6 text-xs text-gray-500 space-y-0.5 text-left",children:[(0,n.jsx)("div",{className:"font-mono text-gray-400",children:t.id}),t.projects&&t.projects.length>0&&(0,n.jsxs)("div",{className:"text-left",children:["Used by: ",t.projects.map(e=>e.name||e.slug).join(", ")]})]})]},t.id))})}),(0,n.jsx)("div",{className:"mt-3",children:(0,n.jsxs)("button",{onClick:()=>tg(e.id),disabled:q,className:"w-full flex items-center justify-start px-4 py-4 border-2 border-blue-600 rounded-lg bg-blue-600 text-white text-md font-semibold hover:bg-blue-700 hover:border-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,n.jsx)("span",{children:"Create a new payments profile"})]})}),(0,n.jsxs)("div",{className:"mt-3 flex justify-between items-center",children:[(0,n.jsxs)("div",{className:"relative group",children:[(0,n.jsxs)("span",{className:"text-xs text-blue-500 hover:text-blue-700 cursor-help flex items-center",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"What is this?"]}),(0,n.jsx)("div",{className:"opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-200 absolute bottom-full left-32 transform -translate-x-1/2 mb-2 w-[180%] bg-gray-900 text-white text-xs rounded-md p-3 shadow-lg z-10",children:(0,n.jsx)("div",{className:"relative",children:(0,n.jsx)("p",{className:"mb-2",children:"Stripe Connect lets you accept payments directly in your app. Choose an existing account to reuse your payment setup, or create a new one if this is a separate business or project."})})})]}),(0,n.jsx)("div",{className:"text-xs text-gray-500 hover:text-gray-700 hover:underline cursor-pointer",onClick:t=>{t.stopPropagation(),tf(e.id)},children:"Skip"})]})]})}),e.status===tv.NEED_SECRETS&&e.secrets&&e.secrets.length>0&&(0,n.jsxs)("div",{className:"flex flex-col space-y-2 mb-1",children:[(0,n.jsx)("div",{className:"text-sm mb-2",children:(0,n.jsx)("p",{children:"To add this functionality, you'll need to add some secrets:"})}),e.secrets.map(t=>{var s,a;return(0,n.jsxs)("div",{className:"mt-3 p-3 border border-gray-200 dark:border-gray-700 rounded-md bg-white",children:[(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsx)("div",{className:"font-medium text-black",children:t.name}),(0,n.jsx)("div",{className:"text-xs text-gray-800 mt-1",children:t.reason})]}),(0,n.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)("input",{type:"password",value:B[t.name]||"",onChange:e=>U(s=>({...s,[t.name]:e.target.value})),placeholder:"Enter value for ".concat(t.name),className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-white text-gray-900 text-sm focus:outline-none focus:ring-1 focus:ring-gray-500 focus:border-gray-500",disabled:z[t.name]})}),(0,n.jsx)("button",{onClick:()=>ti(e.id,t.name),disabled:!(null===(s=B[t.name])||void 0===s?void 0:s.trim())||z[t.name],className:"px-4 py-2 rounded-md text-sm font-medium ".concat((null===(a=B[t.name])||void 0===a?void 0:a.trim())&&!z[t.name]?"bg-black text-white hover:bg-gray-800":"bg-gray-400 text-white cursor-not-allowed"),children:z[t.name]?(0,n.jsxs)("svg",{className:"animate-spin w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Submit"})]}),(0,n.jsxs)("div",{className:"mt-2 flex justify-between items-center",children:[(0,n.jsxs)("div",{className:"relative group",children:[(0,n.jsxs)("div",{className:"text-xs text-blue-600 hover:text-blue-700 cursor-help flex items-center",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,n.jsx)("span",{children:"How to get this?"})]}),(0,n.jsx)("div",{className:"opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-200 absolute bottom-full left-24 transform -translate-x-1/2 mb-2 w-[180%] bg-gray-900 text-white text-xs rounded-md p-3 shadow-lg z-10",children:(0,n.jsx)("div",{className:"relative",children:(0,n.jsx)("p",{className:"mb-2",children:t.instructions})})})]}),(0,n.jsx)("div",{className:"text-xs text-gray-500 hover:text-gray-700 hover:underline cursor-pointer",onClick:s=>{s.stopPropagation(),tc(e.id,t.name)},children:"Skip"})]})]},t.name)})]}),e.status===tv.NEED_ANSWERS&&e.questions&&e.questions.length>0&&(0,n.jsxs)("div",{className:"flex flex-col space-y-2 mb-1",children:[(0,n.jsx)("div",{className:"text-sm mb-2 text-purple-900 dark:text-purple-200",children:(0,n.jsx)("p",{children:"I have a few questions to better understand your request."})}),e.questions.map((t,s)=>{var a,r;return(null===(a=G[e.id])||void 0===a?void 0:a[t])?null:(0,n.jsxs)("div",{className:"mt-3 p-3 border border-purple-200 dark:border-purple-700 rounded-md bg-white dark:bg-gray-800",children:[(0,n.jsx)("div",{className:"mb-2",children:(0,n.jsx)("div",{className:"font-medium text-purple-900 dark:text-purple-200",children:t})}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("textarea",{value:(null===(r=_[e.id])||void 0===r?void 0:r[t])||"",onChange:s=>H(n=>({...n,[e.id]:{...n[e.id]||{},[t]:s.target.value}})),placeholder:"Type your answer here...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm focus:outline-none focus:ring-1 focus:ring-purple-500 focus:border-purple-500 resize-none",rows:3,disabled:J[e.id]}),(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hover:underline cursor-pointer",onClick:s=>{s.stopPropagation(),V(s=>({...s,[e.id]:{...s[e.id]||{},[t]:!0}}))},children:"Skip this question"})})]})]},s)}),e.questions.some(t=>{var s;return!(null===(s=G[e.id])||void 0===s?void 0:s[t])})&&(0,n.jsx)("div",{className:"mt-4 flex justify-center",children:(0,n.jsx)("button",{onClick:()=>tk(e.id),disabled:J[e.id],className:"px-6 py-2 rounded-md text-sm font-medium ".concat(J[e.id]?"bg-gray-400 text-white cursor-not-allowed":"bg-purple-600 hover:bg-purple-700 text-white"),children:J[e.id]?(0,n.jsxs)("svg",{className:"animate-spin w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Submit Answers"})}),e.questions.every(t=>{var s;return null===(s=G[e.id])||void 0===s?void 0:s[t]})&&(0,n.jsxs)("div",{className:"mt-4 flex flex-col items-center",children:[(0,n.jsx)("button",{onClick:()=>tk(e.id),disabled:J[e.id],className:"px-6 py-2 rounded-md text-sm font-medium ".concat(J[e.id]?"bg-gray-400 text-white cursor-not-allowed":"bg-gray-600 hover:bg-gray-700 text-white"),children:J[e.id]?(0,n.jsxs)("svg",{className:"animate-spin w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Continue Without Answers"}),(0,n.jsx)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"(refresh the page to see questions again)"})]})]}),e.attachments&&e.attachments.length>0&&(0,n.jsx)("div",{className:"mb-2",children:(0,n.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.attachments.map((e,t)=>(0,n.jsx)("div",{className:"relative w-24 h-24 bg-gray-100 dark:bg-gray-600 rounded overflow-hidden",children:(0,n.jsx)("img",{src:e,alt:"Attachment ".concat(t+1),className:"w-full h-full object-cover"})},t))})}),(0,n.jsx)(tS,{message:e,onUpgradeClick:()=>eq(!0)}),e.status===tv.ERROR&&f&&(0,n.jsxs)("div",{className:"flex space-x-2 mt-3",children:[(0,n.jsxs)("button",{onClick:t=>{t.stopPropagation();let s=e.createdAt?new Date(e.createdAt):void 0;f(e.content,s)},className:"flex items-center space-x-1 px-3 py-1 rounded-full text-xs transition-colors border border-gray-50 hover:bg-gray-50 text-gray-50 hover:text-gray-800",children:[(0,n.jsxs)("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),(0,n.jsx)("span",{children:"View error"})]}),(0,n.jsxs)("button",{onClick:t=>{t.stopPropagation(),b&&b(e.content)},className:"flex items-center space-x-1 px-3 py-1 rounded-full text-xs transition-colors border border-gray-50 hover:bg-gray-50 text-gray-50 hover:text-gray-800",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-3 h-3",children:[(0,n.jsx)("path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72"}),(0,n.jsx)("path",{d:"m14 7 3 3"}),(0,n.jsx)("path",{d:"M5 6v4"}),(0,n.jsx)("path",{d:"M19 14v4"}),(0,n.jsx)("path",{d:"M10 2v2"}),(0,n.jsx)("path",{d:"M7 8H3"}),(0,n.jsx)("path",{d:"M21 16h-4"})]}),(0,n.jsx)("span",{children:"Try to fix it"})]})]})]})}),e.preview&&(0,n.jsx)(tN,{messageId:e.id,preview:e.preview,projectPreview:m,restoringPreview:x,onRestorePreview:g,timestamp:e.createdAt,messageContent:"assistant"!==e.role||e.status!==tv.COMPLETED||e.content.startsWith("Build successful")||e.content.startsWith("Successfully")||e.content.startsWith("Build unsuccessful")?void 0:e.content,actions:e.actions,totalCost:e.totalCost,duration:e.duration,suggestions:e.suggestions,onSuggestionClick:tb,isLastCheckpoint:t===k.length-1})]},e.id)})]}),(()=>{let e=k.filter(e=>"assistant"===e.role).slice(-1)[0];return e&&e.experiment&&e.variation&&!e.outcome?(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-3 shadow-sm",children:[(0,n.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center mb-2",children:"How was this change?"}),(0,n.jsxs)("div",{className:"flex space-x-3 justify-center",children:[(0,n.jsxs)("button",{onClick:async()=>{await tw(e.id,"up")},className:"flex items-center space-x-2 px-4 py-2 rounded-lg text-sm transition-colors bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600",children:[(0,n.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[(0,n.jsx)("path",{d:"M7 10v12"}),(0,n.jsx)("path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z"})]}),(0,n.jsx)("span",{children:"Good"})]}),(0,n.jsxs)("button",{onClick:async()=>{await tw(e.id,"down")},className:"flex items-center space-x-2 px-4 py-2 rounded-lg text-sm transition-colors bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600",children:[(0,n.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[(0,n.jsx)("path",{d:"M17 14V2"}),(0,n.jsx)("path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z"})," "]}),(0,n.jsx)("span",{children:"Bad"})]})]})]})}):null})(),y&&i&&k.length>0&&!eH&&(0,n.jsx)("div",{className:"flex flex-col items-center justify-center py-2",children:(0,n.jsxs)("svg",{className:"animate-spin h-4 w-4 text-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),(0,n.jsx)("div",{ref:eU})]}),y&&i&&void 0!==w&&w>0&&(0,n.jsx)(tC,{className:"px-4 pb-4 pt-0",percentage:w,remainingTime:N}),(0,n.jsx)("div",{className:"p-2 sm:p-3 border-t border-gray-200 dark:border-gray-700 ".concat(y?"pb-safe":""),children:(0,n.jsxs)("div",{className:"flex flex-col",children:[en&&(0,n.jsx)("div",{className:"mb-3 px-1",children:(0,n.jsx)("div",{className:"flex items-center justify-center bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-2",children:(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("div",{className:"animate-spin w-4 h-4 border-2 border-yellow-600 dark:border-yellow-400 border-t-transparent rounded-full"}),(0,n.jsx)("span",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"Capturing element text..."})]})})}),es&&(0,n.jsx)("div",{className:"mb-3 px-1",children:(0,n.jsxs)("div",{className:"flex items-center justify-between bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-2",children:[es.isImage?(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)(ek.A,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 flex-shrink-0"}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[es.imageSrc&&(0,n.jsx)("img",{src:es.imageSrc,alt:es.imageAlt||"Selected image",className:"w-8 h-8 object-cover rounded border border-blue-200 dark:border-blue-700"}),(0,n.jsx)("span",{className:"text-sm text-blue-800 dark:text-blue-200",children:es.text})]})]}):(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(er.A,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),(0,n.jsxs)("span",{className:"text-sm text-blue-800 dark:text-blue-200",children:['"',es.text,'"']})]}),(0,n.jsx)("button",{onClick:el,className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 flex-shrink-0",children:(0,n.jsx)(eC.A,{className:"w-4 h-4"})})]})}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsxs)("div",{className:"flex-1 relative",children:[(0,n.jsx)("textarea",{ref:eB,className:"w-full min-h-[60px] sm:min-h-[76px] max-h-40 border border-gray-300 dark:border-gray-600 rounded-lg p-2 pr-10 resize-none bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-1 focus:ring-primary focus:border-transparent text-sm",style:{maxHeight:"200px",fontSize:y?"16px":void 0},placeholder:"Suggest a change or ask a question...",value:S,onChange:e=>E(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.shiftKey?e.stopPropagation():(e.preventDefault(),tr()))},onPaste:e=>{let{items:t}=e.clipboardData;for(let s=0;s<t.length;s++)if(-1!==t[s].type.indexOf("image")){let n=t[s].getAsFile();n&&(e.preventDefault(),ta(n));break}},rows:3}),(0,n.jsx)("input",{type:"file",ref:e_,className:"hidden",accept:"image/jpeg,image/png,image/gif,image/webp",multiple:!0,onChange:tn,disabled:i||A}),(0,n.jsxs)(e8,{children:[(0,n.jsx)(e7,{asChild:!0,children:(0,n.jsx)("button",{type:"button",onClick:()=>{var e;null===(e=e_.current)||void 0===e||e.click()},className:"absolute right-1 top-1 p-1 text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400",disabled:i||A,children:A?(0,n.jsxs)("svg",{className:"animate-spin w-5 h-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),(0,n.jsx)(e9,{children:(0,n.jsx)("p",{children:"Upload image"})})]}),"website"===j&&(0,n.jsxs)(e8,{children:[(0,n.jsx)(e7,{asChild:!0,children:(0,n.jsx)("button",{onClick:()=>{let e=!et;ea(e),e?(ei(!0),ec("ai"),ed("new")):(ei(!1),ec("navigate"),ed("old"),el(),eo())},className:"absolute right-1 bottom-2 p-1.5 transition-colors ".concat(et?"text-blue-600 dark:text-blue-400":"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400"),disabled:i,children:(0,n.jsx)(er.A,{className:"w-4 h-4"})})}),(0,n.jsx)(e9,{children:(0,n.jsx)("p",{children:"Point to an element"})})]})]}),(0,n.jsx)("button",{className:"p-2 rounded-lg ".concat(i&&k.length>0&&!eH?"bg-gray-600 text-gray-300 hover:text-gray-200 hover:bg-gray-700":S.trim()||0!==T.length?"".concat(!eV&&"bg-blue-600 hover:bg-blue-700"," text-white"):"bg-gray-200 dark:bg-gray-700 text-gray-400 dark:text-gray-500 cursor-not-allowed"," transition-colors"),style:{backgroundColor:!(i&&k.length>0&&!eH)&&!(!S.trim()&&0===T.length)&&eV&&(null==eJ?void 0:eJ.tertiaryColor)||void 0},onClick:i&&k.length>0?()=>{o()}:tr,disabled:!i&&!S.trim()&&0===T.length,children:i&&k.length>0&&!eH?(0,n.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("rect",{x:"3",y:"3",width:"18",height:"18"})}):(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),T.length>0&&(0,n.jsx)("div",{className:"mt-2 flex flex-wrap gap-3",children:T.map((e,t)=>(0,n.jsxs)("div",{className:"relative",style:{width:"64px",height:"64px",margin:"4px"},children:[(0,n.jsx)("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-600 rounded overflow-hidden",children:(0,n.jsx)("img",{src:e,alt:"Attachment ".concat(t+1),className:"w-full h-full object-cover"})}),(0,n.jsx)("div",{className:"absolute",style:{top:"-7px",right:"-7px"},children:(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),I(e=>e.filter((e,s)=>s!==t))},className:"bg-gray-500 text-white rounded-full w-5 h-5 flex items-center justify-center hover:bg-gray-600 shadow-md z-10","aria-label":"Remove image",children:(0,n.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})})]},t))})]})}),eX&&(0,n.jsx)(tp.A,{isOpen:e$,onClose:()=>{eq(!1)},currentTier:null==eX?void 0:eX.tier,currentUsage:null==eX?void 0:eX.messageCount,currentLimit:null==eX?void 0:eX.limit,subscriptionData:eX}),(0,n.jsx)(ty,{isOpen:Y,onClose:()=>{K(!1),Z(null)},onSuccess:tx,projectId:c})]})})});function tT(e){let{isOpen:t,onClose:s,errorMessage:r,onTryToFixIt:l,timestamp:o}=e,[i,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{let e=()=>{u(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),!t)return null;let m=e=>e.replace(/^\d+\.\d+\s+/gm,"").replace(/^#\d+\s+\d+\.\d+\s+/gm,""),g=o?o.toLocaleString("en-US",{weekday:"long",hour:"numeric",minute:"numeric"}):"",h=async()=>{let e=m(r);try{await navigator.clipboard.writeText(e),c(!0),setTimeout(()=>{c(!1)},2e3)}catch(e){console.error("Failed to copy error message: ",e)}},x=()=>{l&&l()};return(0,n.jsx)("div",{className:"absolute inset-0 bg-gray-900 shadow-lg rounded-lg overflow-hidden","data-sentry-component":"ErrorOverlay","data-sentry-source-file":"ErrorOverlay.tsx",children:(0,n.jsxs)("div",{className:"flex h-full flex-col",children:[d?(0,n.jsxs)("div",{className:"p-4 border-b border-gray-700",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,n.jsx)("h2",{className:"text-lg font-medium text-white",children:"Build error"}),(0,n.jsx)("button",{onClick:s,className:"text-gray-400",children:(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-gray-400 text-sm font-normal",children:g}),(0,n.jsx)("button",{onClick:x,className:"inline-flex items-center px-3 py-1.5 border border-gray-700 rounded-md shadow-sm text-sm font-medium text-gray-800 bg-white hover:bg-gray-100 hover:text-gray-800 focus:outline-none",disabled:!l,children:"Try to fix it"})]})]}):(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("button",{onClick:s,className:"mr-4 px-3 py-1 text-sm text-gray-200 hover:bg-gray-800 rounded-md transition-colors border border-gray-700",children:(0,n.jsxs)("span",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"w-3 h-3 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),"Close"]})}),(0,n.jsxs)("h2",{className:"text-lg font-medium text-white flex items-center",children:["Build error",(0,n.jsx)("span",{className:"text-gray-400 ml-4 text-sm font-normal",children:g})]})]}),(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)("button",{onClick:x,className:"inline-flex items-center px-3 py-1.5 border border-gray-700 rounded-md shadow-sm text-sm font-medium text-gray-800 bg-white hover:bg-gray-100 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-blue-500",disabled:!l,children:"Try to fix it"})})]}),(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto bg-gray-900 p-0",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between py-2 px-4 border-b border-gray-800 bg-gray-800/70",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("svg",{className:"text-gray-400 w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","data-sentry-element":"svg","data-sentry-source-file":"ErrorOverlay.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z","data-sentry-element":"path","data-sentry-source-file":"ErrorOverlay.tsx"})}),(0,n.jsx)("span",{className:"text-sm text-gray-300 font-mono",children:"Build Log"})]}),(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)("button",{onClick:h,className:"text-gray-400 hover:text-white focus:outline-none transition-colors","aria-label":i?"Copied!":"Copy to clipboard",children:i?(0,n.jsx)("svg",{className:"w-4 h-4 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})})]}),(0,n.jsx)("pre",{className:"font-mono text-xs text-white whitespace-pre-wrap p-4 overflow-x-auto",children:m(r)})]})]})})}function tI(e){let{activeTab:t,onTabChange:s,isLoading:a}=e;return(0,n.jsx)("div",{className:"lg:hidden sticky top-[48px] z-0 bg-gray-900 border-b border-gray-700 px-1 py-1 flex justify-between","data-sentry-component":"MobileNavTabs","data-sentry-source-file":"MobileNavTabs.tsx",children:(0,n.jsxs)("div",{className:"flex w-full bg-gray-800 rounded-md p-1 shadow-inner",children:[(0,n.jsxs)("button",{onClick:()=>s("chat"),className:"flex-1 flex items-center justify-center py-2 px-2 rounded-md text-sm font-medium transition-colors ".concat("chat"===t?"bg-primary text-white":"text-gray-400"),children:[(0,n.jsx)("svg",{className:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"MobileNavTabs.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z","data-sentry-element":"path","data-sentry-source-file":"MobileNavTabs.tsx"})}),"Chat"]}),(0,n.jsxs)("button",{onClick:()=>s("code"),className:"flex-1 flex items-center justify-center py-2 px-2 rounded-md text-sm font-medium transition-colors ".concat("code"===t?"bg-primary text-white":"text-gray-400"),children:[(0,n.jsx)("svg",{className:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"MobileNavTabs.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4","data-sentry-element":"path","data-sentry-source-file":"MobileNavTabs.tsx"})}),"Code"]}),(0,n.jsxs)("button",{onClick:()=>s("preview"),className:"flex-1 flex items-center justify-center py-2 px-2 rounded-md text-sm font-medium transition-colors ".concat("preview"===t?"bg-primary text-white":"text-gray-400"),children:[(0,n.jsxs)("svg",{className:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"MobileNavTabs.tsx",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z","data-sentry-element":"path","data-sentry-source-file":"MobileNavTabs.tsx"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z","data-sentry-element":"path","data-sentry-source-file":"MobileNavTabs.tsx"})]}),"Preview"]})]})})}function tA(e){let{previewSlug:t,activeTab:s,onTabChange:r}=e,[l,o]=(0,a.useState)(!1),[i,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{t&&t!==i&&("preview"===s||d||o(!0),c(t)),"preview"===s&&o(!1)},[t,i,s,d]),(0,a.useEffect)(()=>{let e=setTimeout(()=>{u(!1)},1e4);return()=>clearTimeout(e)},[s]),(0,n.jsxs)("div",{"data-sentry-component":"MobileFooterNav","data-sentry-source-file":"MobileFooterNav.tsx",className:"jsx-b62c4cefca792037 lg:hidden fixed bottom-0 left-0 right-0 z-30 bg-gray-900 border-t border-gray-700 pb-safe h-14",children:[(0,n.jsx)(b(),{id:"b62c4cefca792037",children:"@-webkit-keyframes pulseGlow{0%,100%{-webkit-transform:scale(1);transform:scale(1);opacity:.7}50%{-webkit-transform:scale(1.1);transform:scale(1.1);opacity:1;-webkit-box-shadow:0 0 4px 1px rgba(34,197,94,.7);box-shadow:0 0 4px 1px rgba(34,197,94,.7)}}@-moz-keyframes pulseGlow{0%,100%{-moz-transform:scale(1);transform:scale(1);opacity:.7}50%{-moz-transform:scale(1.1);transform:scale(1.1);opacity:1;-moz-box-shadow:0 0 4px 1px rgba(34,197,94,.7);box-shadow:0 0 4px 1px rgba(34,197,94,.7)}}@-o-keyframes pulseGlow{0%,100%{-o-transform:scale(1);transform:scale(1);opacity:.7}50%{-o-transform:scale(1.1);transform:scale(1.1);opacity:1;box-shadow:0 0 4px 1px rgba(34,197,94,.7)}}@keyframes pulseGlow{0%,100%{-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1);opacity:.7}50%{-webkit-transform:scale(1.1);-moz-transform:scale(1.1);-o-transform:scale(1.1);transform:scale(1.1);opacity:1;-webkit-box-shadow:0 0 4px 1px rgba(34,197,94,.7);-moz-box-shadow:0 0 4px 1px rgba(34,197,94,.7);box-shadow:0 0 4px 1px rgba(34,197,94,.7)}}.pulse-indicator.jsx-b62c4cefca792037{-webkit-animation:pulseGlow 2s infinite ease-in-out;-moz-animation:pulseGlow 2s infinite ease-in-out;-o-animation:pulseGlow 2s infinite ease-in-out;animation:pulseGlow 2s infinite ease-in-out}"}),(0,n.jsxs)("div",{className:"jsx-b62c4cefca792037 flex items-center justify-around h-full px-2",children:[(0,n.jsxs)("button",{onClick:()=>r("chat"),className:"jsx-b62c4cefca792037 "+"flex flex-col items-center justify-center w-1/3 h-full transition-colors ".concat("chat"===s?"text-blue-500":"text-gray-400 hover:text-gray-300"),children:[(0,n.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"MobileFooterNav.tsx",className:"jsx-b62c4cefca792037 w-6 h-6 mb-1",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z","data-sentry-element":"path","data-sentry-source-file":"MobileFooterNav.tsx",className:"jsx-b62c4cefca792037"})}),(0,n.jsx)("span",{className:"jsx-b62c4cefca792037 text-xs",children:"Chat"})]}),(0,n.jsxs)("button",{onClick:()=>r("code"),className:"jsx-b62c4cefca792037 "+"flex flex-col items-center justify-center w-1/3 h-full transition-colors ".concat("code"===s?"text-blue-500":"text-gray-400 hover:text-gray-300"),children:[(0,n.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"MobileFooterNav.tsx",className:"jsx-b62c4cefca792037 w-6 h-6 mb-1",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4","data-sentry-element":"path","data-sentry-source-file":"MobileFooterNav.tsx",className:"jsx-b62c4cefca792037"})}),(0,n.jsx)("span",{className:"jsx-b62c4cefca792037 text-xs",children:"Code"})]}),(0,n.jsxs)("button",{onClick:()=>r("preview"),className:"jsx-b62c4cefca792037 "+"flex flex-col items-center justify-center w-1/3 h-full transition-colors ".concat("preview"===s?"text-blue-500":"text-gray-400 hover:text-gray-300"," relative"),children:[(0,n.jsxs)("div",{className:"jsx-b62c4cefca792037 relative",children:[l&&(0,n.jsx)("span",{className:"jsx-b62c4cefca792037 absolute -top-0.5 -right-2 h-2 w-2 bg-green-500 rounded-full pulse-indicator"}),(0,n.jsxs)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"MobileFooterNav.tsx",className:"jsx-b62c4cefca792037 w-6 h-6 mb-1",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z","data-sentry-element":"path","data-sentry-source-file":"MobileFooterNav.tsx",className:"jsx-b62c4cefca792037"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z","data-sentry-element":"path","data-sentry-source-file":"MobileFooterNav.tsx",className:"jsx-b62c4cefca792037"})]})]}),(0,n.jsx)("span",{className:"jsx-b62c4cefca792037 text-xs",children:"Preview"})]})]})]})}tE.displayName="Chat";var tD=s(66010),tP=s(36347),tM=s(22926);let tL=(0,tP.c)("pk_live_9eBOACiG83hSt0n4y7Kg9Exo"),tO=(0,tP.c)("pk_live_51OJhJBHdGQpsHqInIzu7c6PzGPSH0yImD4xfpofvxvFZs0VFhPRXZCyEgYkkhOtBOXFWvssYASs851mflwQvjnrl00T6DbUwWZ");function tR(e){let{onSuccess:t,totalAmount:s,onError:r}=e,l=(0,tM.useStripe)(),o=(0,tM.useElements)(),[i,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=()=>{u(document.documentElement.classList.contains("dark"))};e();let t=new MutationObserver(e);return t.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>t.disconnect()},[]);let m=async e=>{if(e.preventDefault(),!l||!o)return;let s=o.getElement(tM.CardElement);if(s){c(!0);try{let{error:e,paymentMethod:n}=await l.createPaymentMethod({type:"card",card:s});if(e)throw Error(e.message);let a=await fetch("/api/invoice/retry-failed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentMethodId:n.id})}),r=await a.json();if(!a.ok)throw Error(r.error||"Payment failed");if(r.requiresAction){let{error:e,paymentIntent:t}=await l.confirmCardPayment(r.clientSecret);if(e)throw Error(e.message);if(a=await fetch("/api/invoice/retry-failed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentIntentId:t.id,paymentConfirmed:!0})}),r=await a.json(),!a.ok)throw Error(r.error||"Payment confirmation failed")}v.oR.success("Payment successful!"),t()}catch(t){let e=t.message||"Payment failed";r(e),v.oR.error(e)}finally{c(!1)}}};return(0,n.jsxs)("form",{onSubmit:m,className:"space-y-4","data-sentry-component":"PaymentForm","data-sentry-source-file":"PendingUsageChargeModal.tsx",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Card Details"}),(0,n.jsx)("div",{className:"p-3 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-900",children:(0,n.jsx)(tM.CardElement,{options:{style:{base:{fontSize:"16px",color:d?"#ffffff":"#374151",backgroundColor:"transparent","::placeholder":{color:d?"#9CA3AF":"#6B7280"}},invalid:{color:"#EF4444"}}},"data-sentry-element":"CardElement","data-sentry-source-file":"PendingUsageChargeModal.tsx"})})]}),(0,n.jsx)("button",{type:"submit",disabled:!l||i,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50",children:i?"Processing...":"Pay Now"})]})}function tF(e){let{isOpen:t,onClose:s,onPaymentSuccess:r,totalUnpaidAmount:l,failedCharges:o}=e,[i,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),[g,h]=(0,a.useState)(null),{isWhitelabel:x,isClient:p}=(0,d.p)();if(!t)return null;let f=async()=>{m(!0),h(null);try{let a=await fetch("/api/invoice/retry-failed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),l=await a.json();if(!a.ok){var e,t,n;if((null===(e=l.error)||void 0===e?void 0:e.includes("payment method"))||(null===(t=l.error)||void 0===t?void 0:t.includes("missing a payment method"))||(null===(n=l.error)||void 0===n?void 0:n.includes("No payment method found"))){c(!0);return}throw Error(l.error||"Payment failed")}if(l.requiresAction){let e=x?await tL:await tO;if(e){let{error:t,paymentIntent:s}=await e.confirmCardPayment(l.clientSecret);if(t)throw Error(t.message);let n=await fetch("/api/invoice/retry-failed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentIntentId:s.id,paymentConfirmed:!0})}),a=await n.json();if(!n.ok)throw Error(a.error||"Payment confirmation failed")}}v.oR.success("Payment successful!"),r(),s()}catch(t){let e=t.message||"Payment failed";h(e),c(!0),v.oR.error(e)}finally{m(!1)}};return(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50","data-sentry-component":"PendingUsageChargeModal","data-sentry-source-file":"PendingUsageChargeModal.tsx",children:(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Payment Required"}),(0,n.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors",children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"PendingUsageChargeModal.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12","data-sentry-element":"path","data-sentry-source-file":"PendingUsageChargeModal.tsx"})})})]}),(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsxs)("div",{className:"flex items-center mb-3",children:[(0,n.jsx)("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mr-3",children:(0,n.jsx)("svg",{className:"w-5 h-5 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"PendingUsageChargeModal.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z","data-sentry-element":"path","data-sentry-source-file":"PendingUsageChargeModal.tsx"})})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"Recent Usage Payment Failed"}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["You currently have a pending usage amount of ",(0,n.jsxs)("strong",{children:["$",l.toFixed(2)]})]})]})]}),(0,n.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Please complete your payment to continue sending messages."})]}),g&&(0,n.jsx)("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded-lg text-sm",children:g}),i?(0,n.jsx)(n.Fragment,{children:p&&(0,n.jsx)(n.Fragment,{children:x?(0,n.jsx)(tM.Elements,{stripe:tL,children:(0,n.jsx)(tR,{onSuccess:()=>{r(),s()},totalAmount:l,onError:h})}):(0,n.jsx)(tM.Elements,{stripe:tO,children:(0,n.jsx)(tR,{onSuccess:()=>{r(),s()},totalAmount:l,onError:h})})})}):(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)("button",{onClick:()=>{window.open("/dashboard#billing","_blank")},className:"text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 underline",children:"View Usage"})}),(0,n.jsx)("button",{onClick:f,disabled:u,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors disabled:opacity-50",children:u?"Processing...":"Pay Now"})]})]})})}function tB(e){let{isOpen:t,onClose:s,onWakeUp:l,subscriptionData:o}=e,{id:i}=(0,r.useRouter)().query,[c,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1);if(!t)return null;let g=async()=>{if(!i||"string"!=typeof i){v.oR.error("Invalid project ID");return}if(!(null==o?void 0:o.tier)||o.tier===x.i.FREE){m(!0);return}d(!0);try{let e=await fetch("/api/projects/sleep",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:i,isSleeping:!1})}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to wake up project");v.oR.success("Project woken up successfully!"),l(),s()}catch(e){console.error("Error waking up project:",e),v.oR.error(e.message||"Failed to wake up project")}finally{d(!1)}};return(0,n.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50","data-sentry-component":"SleepingModal","data-sentry-source-file":"SleepingModal.tsx",children:[(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Project Sleeping"}),(0,n.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors",disabled:c,children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"SleepingModal.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12","data-sentry-element":"path","data-sentry-source-file":"SleepingModal.tsx"})})})]}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsxs)("div",{className:"flex items-center mb-4",children:[(0,n.jsx)("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center mr-3",children:(0,n.jsx)("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","data-sentry-element":"svg","data-sentry-source-file":"SleepingModal.tsx",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z","data-sentry-element":"path","data-sentry-source-file":"SleepingModal.tsx"})})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"This project is sleeping"}),(0,n.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"You'll need to wake it up before continuing"})]})]}),(0,n.jsxs)("p",{className:"text-gray-700 dark:text-gray-300 text-sm mb-4",children:["Your project has been put to sleep to save resources. ",(null==o?void 0:o.tier)&&o.tier!==x.i.FREE?"Wake it up to continue working on it or send messages.":"Upgrade to a paid plan to wake it up and continue working on it."]})]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,n.jsx)("button",{onClick:s,className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",disabled:c,children:"Cancel"}),(0,n.jsx)("button",{onClick:g,disabled:c,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg font-medium transition-colors flex items-center",children:c?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Waking Up..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),(null==o?void 0:o.tier)&&o.tier!==x.i.FREE?"Wake Up":"Upgrade to Wake Up"]})})]})]}),o&&(0,n.jsx)(tp.A,{isOpen:u,onClose:()=>{m(!1)},currentTier:null==o?void 0:o.tier,currentUsage:null==o?void 0:o.messageCount,currentLimit:null==o?void 0:o.limit,subscriptionData:o})]})}function tU(){let e=(0,r.useRouter)(),{id:t}=e.query,{isAuthenticated:l,isLoading:i}=(0,tD.A)(),{data:c}=(0,th.useSession)(),{projectData:u,files:m,changedFiles:g,isSaving:x,activeView:p,previewMode:f,inspectorMode:b,previewType:y,refreshKey:j,isRefreshing:w,isLoading:N,loadingText:k,isMobile:E,mobileActiveTab:T,setProjectId:I,setProjectData:A,updateProjectData:D,setFiles:P,setChangedFiles:M,clearChangedFiles:L,setIsSaving:O,setHasUnsavedChanges:R,setActiveView:F,setPreviewMode:B,setInspectorMode:U,setPreviewType:z,incrementRefreshKey:W,setIsRefreshing:_,setIsLoading:H,setLoadingText:V,setIsMobile:J,setMobileActiveTab:q,handleProjectNavigation:X,setAvailablePages:Y,setSelectedPageRoute:K,selectedPageRoute:Q}=h(),[Z,ee]=(0,a.useState)(""),[et,es]=(0,a.useState)(null),[en,ea]=(0,a.useState)(!1),[er,el]=(0,a.useState)([]),[eo,ei]=(0,a.useState)(!1),[ec,ed]=(0,a.useState)(null),[eu,em]=(0,a.useState)(!1),eg=(0,a.useRef)(!1),[eh,ex]=(0,a.useState)(null),{isWhitelabel:ep,whitelabelConfig:ef}=(0,d.p)(),[eb,ey]=(0,a.useState)(null),[ev,ej]=(0,a.useState)(!1),[ew,eN]=(0,a.useState)(!1),[ek,eC]=(0,a.useState)(!1),[eS,eE]=(0,a.useState)(""),[eT,eI]=(0,a.useState)(void 0),[eA,eD]=(0,a.useState)(!1),[eP,eM]=(0,a.useState)(!1),[eL,eO]=(0,a.useState)({}),eR=(0,a.useRef)(null),eF=(0,a.useRef)(!1),eB=(0,a.useRef)(null),eU=(0,a.useRef)(0),ez=(0,a.useRef)("");(0,a.useEffect)(()=>{(null==c?void 0:c.user)?localStorage.setItem("user",JSON.stringify(c.user)):localStorage.removeItem("user")},[c]),(0,a.useEffect)(()=>{let e=localStorage.getItem("previewType");"new"===e?localStorage.removeItem("previewType"):"old"===e&&z(e)},[z]),(0,a.useEffect)(()=>{let e=()=>{let e=window.innerWidth<1024;J(e),e||"code"!==p||F("preview")};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[J,E,p,F]);let eW=(0,a.useCallback)(e=>{"function"==typeof e?F(e(p)):F(e)},[p,F]);(0,a.useEffect)(()=>{E||"code"!==p||F("preview")},[E,p,F]);let e_=e=>{q(e),("code"===e||"preview"===e)&&F(e)};(0,a.useEffect)(()=>{i||l||!t||e.push("/login?redirect=".concat(encodeURIComponent("/project/".concat(t))))},[i,l,t,e]);let eH=(e,t)=>{eR.current&&(eR.current.submitHumanMessage("I get the following error in the browser. Can you diligently work the issue and carefully implement a fix:\n```\n".concat(e,"\n```")),eC(!1),E&&q("chat"))},eG=(0,a.useCallback)(async()=>{if(!eg.current)try{eg.current=!0,em(!0);let e=await fetch("/api/subscription");if(e.ok){let t=await e.json();t.subscription&&ed(t.subscription)}else console.error("Failed to fetch subscription data")}catch(e){console.error("Error fetching subscription data:",e)}finally{em(!1),eg.current=!1}},[]),eV=(0,a.useCallback)(async()=>{if(l)try{let e=await fetch("/api/invoice/check-unpaid");if(e.ok){let t=await e.json();ey(t)}else console.error("Failed to check unpaid charges")}catch(e){console.error("Error checking unpaid charges:",e)}},[l]);(0,a.useEffect)(()=>{eG()},[eG]),(0,a.useEffect)(()=>{eV()},[eV]),(0,a.useEffect)(()=>(t&&"string"==typeof t&&(I(t),E||(console.log("\uD83D\uDDA5️ [DESKTOP] Setting activeView to preview"),F("preview"))),()=>{console.log("\uD83D\uDE80 [CLEANUP] Project page unmounting - resetting to view mode"),X(),I(null)}),[t,I,X,E,F]),(0,a.useEffect)(()=>()=>{eB.current&&clearTimeout(eB.current)},[]);let eJ=(0,a.useCallback)(async e=>{try{let t=await fetch("/api/projects/".concat(e));if(!t.ok)throw Error("Failed to load project");let s=await t.json();A(s.project),ee(s.project.prompt||""),s.project.statusMessage&&s.project.statusMessage!==ez.current&&eR.current&&("building"===s.project.status||"answering"===s.project.status)&&(eR.current.addAssistantMessage(s.project.statusMessage,tv.STATUS,!1),ez.current=s.project.statusMessage),"mobile"===s.project.platform?B("mobile"):B("desktop");let n=(s.project.contracts||[]).filter(e=>e.artifactUrl&&!e.actualAddress&&e.isUsed);if(el(n),n.length>0&&"building"!==s.project.status&&"answering"!==s.project.status&&ei(!0),s.files&&(console.log("\uD83D\uDCE6 [FILES-LOAD] Setting files from API:",{fileCount:Object.keys(s.files).length,fileKeys:Object.keys(s.files),hasAppLayout:!!s.files["src/components/AppLayout.tsx"],hasContactForm:!!s.files["src/components/ContactForm.tsx"],sampleFile:Object.keys(s.files)[0]}),P(s.files)),"completed"===s.project.status||"live"===s.project.status)return H(!1),V(""),console.log("DONE"),eV(),eG(),!0;if("error"===s.project.status)return H(!1),V(""),es("An error occurred during generation. Please try again."),!0;if("building"===s.project.status)V("Building your app...");else if("answering"===s.project.status)V("Answering your question...");else if("draft"===s.project.status&&!eF.current){eF.current=!0,V("Starting generation...");let t=localStorage.getItem("activeMessageId:".concat(e));t&&localStorage.removeItem("activeMessageId:".concat(e));try{await fetch("/api/projects/modify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,message:s.project.prompt,attachments:s.project.attachments,activeMessageId:t,maxMode:s.project.maxMode,geniusMode:s.project.geniusMode})})}catch(e){console.error("Failed to start generation:",e)}}return!1}catch(e){return console.error("Error fetching project:",e),es("Failed to load project. Please try again."),H(!1),V(""),!0}},[es,P,H,V,A,ee,B,eV,eG]);(0,a.useEffect)(()=>{if(i||!l||!t||"string"!=typeof t)return;if(eB.current){console.log("Polling already in progress, not restarting");return}console.log("Starting new polling cycle"),H(!0),es(null),V("Loading project..."),eF.current=!1,eU.current=0;let e=async()=>{if(eU.current>=1440){V(""),es("Generation is taking longer than expected. Please refresh the page."),H(!1),eB.current=null;return}eU.current++,console.log("Polling project (".concat(eU.current,"/").concat(1440,")")),!await eJ(t)&&eU.current<1440?eB.current=setTimeout(e,5e3):(eB.current=null,eR.current&&eR.current.fetchAndUpdateMessages())};return e(),()=>{eB.current&&(clearTimeout(eB.current),eB.current=null)}},[t,eJ,i,l,H,V]),(0,a.useEffect)(()=>{if(m&&Object.keys(m).length>0){console.log("[ProjectPage] Gathering pages from project files...");let e=C(m);console.log("[ProjectPage] Found ".concat(e.pages.length," pages (").concat(e.navigationType,"):"),JSON.stringify(e.pages,null,2)),Y(e.pages,e.navigationType),e.pages.length>0&&!Q&&(console.log("[ProjectPage] Setting default page route to: ".concat(e.pages[0].path)),K(e.pages[0].path))}},[m,Y,K]);let e$=async s=>{if(t&&"string"==typeof t){if((null==u?void 0:u.isSleeping)===!0){eN(!0);return}ex(s),H(!0);try{if(!(await fetch("/api/projects/restore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,preview:s})})).ok)throw Error("Failed to restore preview");e.reload()}catch(e){console.error("Error restoring preview:",e),ex(null),H(!1),eR.current&&eR.current.addAssistantMessage("Failed to restore preview. Please try again.",tv.ERROR,!1)}}},eq=(e,t)=>(null==u?void 0:u.isSleeping)===!0?(eN(!0),!1):null==eb||!eb.hasUnpaidCharges||!((null==eb?void 0:eb.totalUnpaidAmount)>0)||(ej(!0),!1),eX=async(e,s,n,a,r,l,o,i,c,d,u)=>{if(t&&"string"==typeof t){console.log("Project page received selectedElement:",u),H(!0);try{eU.current=0;let m=!1,g=!1,h=!0,x=!0;{let e=localStorage.getItem("chatImageGeneration"),t=localStorage.getItem("chatWebSearch");m=!1,g=!1,h=!e||JSON.parse(e),x=!t||JSON.parse(t)}let p={id:t,message:e,attachments:s||[],forceBackendRequest:n,forceFrontEndRequest:a,forceSkipSecrets:r,activeMessageId:l,forceAnsweredQuestions:o||!1,questionsAndAnswers:i||[],forceExperiment:c||"",forceVariation:d||"",maxMode:m,geniusMode:g,imageGeneration:h,webSearch:x,selectedElement:u};console.log("API payload selectedElement:",p.selectedElement);let f=await fetch("/api/projects/modify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!f.ok){if(402===f.status){if((await f.json()).requiresUpgrade){ea(!0),eR.current&&eR.current.addAssistantMessage("You have reached your build credit limit for this billing cycle. Please upgrade your subscription to continue.",tv.STATUS,!1),H(!1);return}let e=await f.json();throw Error(e.error||"Failed to modify app")}{let e=await f.json();throw Error(e.error||"Failed to modify app")}}eB.current&&clearTimeout(eB.current),eU.current=0;let b=async()=>{if(eU.current>=1440){V(""),es("Modification is taking longer than expected. Please refresh the page."),H(!1);return}eU.current++,console.log("Polling for modification (".concat(eU.current,"/").concat(1440,")")),await eJ(t)?eR.current&&eR.current.fetchAndUpdateMessages():eU.current<1440&&(eB.current=setTimeout(b,5e3))};b()}catch(e){if(console.error("Error modifying app:",e),eR.current){var m;(null===(m=e.message)||void 0===m?void 0:m.toLowerCase().includes("listing supabase projects"))?eR.current.addAssistantMessage("I was unable to connect to Supabase. If you revoked your access token, please set a new one in your Dashboard, in the Account tab.",tv.COMPLETED,!0):eR.current.addAssistantMessage("Sorry, I encountered an error while trying to modify the app: ".concat(e.message||"Unknown error",". Please try again with a different request."),tv.COMPLETED,!0)}H(!1)}}},eK=()=>{eR.current&&eR.current.addAssistantMessage("Your app has been published successfully!",tv.COMPLETED,!1),D({status:"live",build:null==u?void 0:u.preview})},eQ=async()=>{if(!t||"string"!=typeof t)return;let e=0,s=async()=>{if(e>=60){console.log("Preview generation polling timeout");return}e++,console.log("Polling for preview generation (".concat(e,"/").concat(60,")"));try{let n=await fetch("/api/projects/".concat(t,"?files=no"));if(!n.ok)return;let a=await n.json();if(A(a.project),a.project.expoPreviewProjectId){console.log("Preview generation completed");return}e<60&&setTimeout(s,1e4)}catch(e){console.error("Error polling for preview:",e)}};s()},eZ=async()=>{if(!t||"string"!=typeof t)return;if((null==u?void 0:u.isSleeping)===!0){eN(!0);return}H(!0),V("Saving changes..."),eB.current&&clearTimeout(eB.current),eU.current=0;let e=async()=>{if(eU.current>=1440){V(""),es("Saving is taking longer than expected. Please refresh the page."),H(!1),eB.current=null;return}eU.current++,console.log("Polling for changed files (".concat(eU.current,"/").concat(1440,")"));try{let s=await fetch("/api/projects/".concat(t));if(!s.ok){console.error("Failed to fetch project during changed files polling");return}let n=await s.json();if(A(n.project),"building"!==n.project.status&&"answering"!==n.project.status){console.log("Changed files completed"),H(!1),V(""),eB.current=null,n.files&&(console.log("\uD83D\uDCE6 [FILES-UPDATE] Updating files after changes:",{fileCount:Object.keys(n.files).length,fileKeys:Object.keys(n.files),status:n.status}),P(n.files)),eR.current&&eR.current.fetchAndUpdateMessages(),F("preview"),eJ(t);return}eU.current<1440?eB.current=setTimeout(e,5e3):eB.current=null}catch(e){console.error("Error polling for changed files:",e),H(!1),V(""),es("Failed to save changes. Please try again."),eB.current=null}};e()},e0=async()=>{if(t&&"string"==typeof t){if((null==u?void 0:u.isSleeping)===!0){eN(!0);return}try{let e=await fetch("/api/publish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t})}),s=await e.json();if(!e.ok)throw Error(s.message||s.error||"Something went wrong");eK()}catch(e){throw console.error("Error publishing app:",e),v.oR.error(e.message||e.error||"Something went wrong"),e}}},e1=(e,t)=>{eE(e),eI(t),eC(!0),q("preview")},e2=async()=>{if(t&&"string"==typeof t)try{if(H(!1),V(""),eB.current&&(clearTimeout(eB.current),eB.current=null),!(await fetch("/api/projects/stop",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t})})).ok)throw Error("Failed to stop project generation")}catch(e){console.error("Error stopping project generation:",e)}},e4=()=>{_(!0);let{resetToSavedState:e}=h.getState();e(),setTimeout(()=>{_(!1)},400)},e3=async()=>{if(t){eD(!0);try{let e=await fetch("/api/projects/".concat(t,"/download"));if(e.ok){let t=await e.blob(),s=window.URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download="".concat((null==u?void 0:u.slug)||"project",".zip"),document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(s),n.remove()}else if(429===e.status){let t=(await e.json()).message||"Rate limit exceeded. Please try again later.";v.oR.error(t)}else v.oR.error("Failed to download project"),console.error("Failed to download project")}catch(e){console.error("Download error:",e),v.oR.error("Failed to download project. Please try again.")}finally{eD(!1)}}},e5=async()=>{if(console.log("UNSAVED",JSON.stringify({event:"save_code_clicked",projectId:t,fileCount:Object.keys(g).length,files:Object.keys(g)})),t&&0!==Object.keys(g).length){O(!0);try{console.log("UNSAVED",JSON.stringify({event:"calling_api_from_code_toolbar",endpoint:"/api/projects/change-files",payload:{projectId:t,changedFiles:g}}));let e=await fetch("/api/projects/change-files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:t,changedFiles:g})});if(console.log("UNSAVED",JSON.stringify({event:"api_response_from_code_toolbar",status:e.status,ok:e.ok})),429===e.status){let t=(await e.json()).message||"Rate limit exceeded. Please try again later.";throw Error(t)}if(!e.ok)throw Error("Failed to save all changes");console.log("UNSAVED",JSON.stringify({event:"api_success_from_code_toolbar",message:"clearing_store"})),L(),R(!1);let s={...m,...g};P(s),await eZ(),h.getState().clearSelectedElement(),h.getState().incrementRefreshKey(),h.getState().setPreviewType("old"),h.getState().setInspectorMode(!1)}catch(e){console.error("UNSAVED",JSON.stringify({event:"save_code_toolbar_error",error:e.message})),v.oR.error(e.message||"Failed to save all changes")}finally{O(!1)}}},e6=async()=>{console.log("\uD83D\uDCBE\uD83D\uDCBE\uD83D\uDCBE [SAVE] ========== handleSavePreviewChanges CALLED =========="),console.log("\uD83D\uDCBE [SAVE] Checking pending changes BEFORE flush:");let e=h.getState().pendingElementChanges;console.log("  Pending count:",Object.keys(e).length),Object.entries(e).forEach(e=>{var t;let[s,n]=e;console.log("  UID ".concat(s,":"),{hasText:!!n.textChange,hasStyle:!!n.styleChanges,text:null===(t=n.textChange)||void 0===t?void 0:t.substring(0,30),styles:n.styleChanges})}),console.log("\uD83D\uDCBE [SAVE] About to call executeFlushPendingUpdates..."),h.getState().executeFlushPendingUpdates(),console.log("\uD83D\uDCBE [SAVE] executeFlushPendingUpdates returned"),console.log("\uD83D\uDCBE [SAVE] Waiting for flush to complete..."),await new Promise(e=>setTimeout(e,100)),console.log("\uD83D\uDCBE [SAVE] Wait complete");let n=h.getState().changedFiles;h.getState().files;let a=h.getState().hasUnsavedChanges,r=h.getState().getAllPendingElementChanges();if(console.log("\uD83D\uDCBE [SAVE] State AFTER flush:",{changedFilesCount:Object.keys(n).length,changedFiles:Object.keys(n),pendingChangesCount:Object.keys(r).length,pendingChanges:Object.keys(r),hasUnsavedChanges:a}),console.log("\uD83D\uDCBE [SAVE] Changed files details:"),Object.entries(n).forEach(e=>{let[t,s]=e;console.log("  File: ".concat(t,", length: ").concat(s.length)),console.log("    Has text-red: ".concat(s.includes("text-red"))),console.log("    Has text-yellow: ".concat(s.includes("text-yellow"))),console.log("    Snippet: ".concat(s.substring(0,200)))}),0===Object.keys(n).length&&(console.error("❌ [SAVE] NO CHANGED FILES! Flush did not populate changedFiles!"),console.log("  But pending changes still has:",Object.keys(r).length)),console.log("UNSAVED",JSON.stringify({event:"save_preview_clicked",projectId:t,fileCount:Object.keys(n).length,files:Object.keys(n)})),!t||0===Object.keys(n).length){console.log("UNSAVED",JSON.stringify({event:"save_skipped",reason:"no_changes_or_no_id"}));return}O(!0);try{console.log("\uD83E\uDDF9 [SAVE] Cleaning UIDs from changed files before sending to server");let{applyUnifiedChanges:e}=await Promise.resolve().then(s.bind(s,42515)),a=h.getState().uidInjectedASTs,r={};for(let[t,s]of Object.entries(n)){let n=a[t];if(n){console.log("\uD83E\uDDF9 [SAVE] Cleaning UIDs from: ".concat(t));let a=e({uidInjectedAST:n,changes:[],cleanupAttributes:!0});a.success&&a.content?(r[t]=a.content,console.log("\uD83E\uDDF9 [SAVE] Cleaned successfully: ".concat(t))):(console.warn("⚠️ [SAVE] Failed to clean ".concat(t,", using original:"),a.error),r[t]=s)}else console.warn("⚠️ [SAVE] No UID AST for ".concat(t,", using original")),r[t]=s}let l={projectId:t,changedFiles:r};console.log("\uD83C\uDFA8 SAVE: About to save changes:",{fileCount:Object.keys(r).length,files:Object.keys(r),cleaned:!0}),Object.entries(r).forEach(e=>{let[t,s]=e;console.log("\uD83C\uDFA8 SAVE: File ".concat(t," preview:"),{length:s.length,hasTextRed:s.includes("text-red"),hasTextBlue:s.includes("text-blue"),hasTextGreen:s.includes("text-green"),snippet:s.substring(0,500)})}),console.log("UNSAVED",JSON.stringify({event:"calling_api_from_preview",endpoint:"/api/projects/change-files",payload:l}));let o=await fetch("/api/projects/change-files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(console.log("UNSAVED",JSON.stringify({event:"api_response_from_preview",status:o.status,ok:o.ok,statusText:o.statusText})),429===o.status){let e=(await o.json()).message||"Rate limit exceeded. Please try again later.";throw console.log("UNSAVED",JSON.stringify({event:"rate_limit_error",message:e})),Error(e)}if(!o.ok){let e=await o.json().catch(()=>({error:"Unknown error"}));throw console.log("UNSAVED",JSON.stringify({event:"api_error",status:o.status,error:e.error||e.message||"Failed to save changes"})),Error(e.error||e.message||"Failed to save changes")}let i=await o.json();console.log("UNSAVED",JSON.stringify({event:"api_success_from_preview",result:i})),console.log("UNSAVED",JSON.stringify({event:"clearing_unsaved_state_before_poll"})),eM(!1),eO({}),L(),R(!1),console.log("\uD83C\uDFA8 SAVE: Files updated after save. Checking for color changes..."),Object.entries(n).forEach(e=>{var t;let[s,n]=e;console.log("\uD83C\uDFA8 SAVE: After save - ".concat(s,":"),{hasColorClasses:/text-(red|blue|green|yellow|purple|pink|gray)-\d{3}/.test(n),colorMatches:null===(t=n.match(/text-(red|blue|green|yellow|purple|pink|gray)-\d{3}/g))||void 0===t?void 0:t.slice(0,5)})});let c={...m,...n};P(c),console.log("UNSAVED",JSON.stringify({event:"starting_poll_after_save"})),await eZ(),h.getState().clearSelectedElement(),h.getState().incrementRefreshKey(),h.getState().setPreviewType("old"),h.getState().setInspectorMode(!1)}catch(e){console.error("UNSAVED",JSON.stringify({event:"save_preview_error",error:e.message})),v.oR.error(e.message||"Failed to save changes")}finally{O(!1)}},e8=async()=>{await eV(),await eG()};return i?(0,n.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsxs)("svg",{className:"animate-spin h-10 w-10 text-blue-500 mx-auto mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,n.jsx)("p",{className:"text-gray-300",children:"Checking authentication..."})]})}):l?t?(0,n.jsxs)("div",{className:"min-h-screen ".concat(!ep&&"bg-gray-50 dark:bg-gray-900"," flex flex-col ").concat(E?"fixed-container":""),style:{backgroundColor:ep&&(null==ef?void 0:ef.primaryColor)||void 0},"data-sentry-component":"ProjectPage","data-sentry-source-file":"index.tsx",children:[(0,n.jsxs)(o(),{"data-sentry-element":"Head","data-sentry-source-file":"index.tsx",children:[(0,n.jsxs)("title",{children:[ep?(null==ef?void 0:ef.siteName)?"".concat(null==ef?void 0:ef.siteName," -"):"":"Famous.ai -"," ",(null==u?void 0:u.slug)||t]}),(0,n.jsx)("meta",{name:"description",content:"Manage and preview your generated app","data-sentry-element":"meta","data-sentry-source-file":"index.tsx"}),(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover","data-sentry-element":"meta","data-sentry-source-file":"index.tsx"})]}),(0,n.jsxs)("header",{className:"".concat(E?"fixed top-0 left-0 right-0 z-30":""," h-[56px]"),children:[(0,n.jsx)($,{activeView:p,mobileActiveTab:T,isMobile:E,setActiveView:eW,projectSlug:null==u?void 0:u.slug,projectId:"string"==typeof t?t:void 0,projectPreview:(null==u?void 0:u.preview)||"",projectBuild:(null==u?void 0:u.build)||"",projectPlatform:(null==u?void 0:u.platform)||"website",projectExpoPreviewProjectId:(null==u?void 0:u.expoPreviewProjectId)||"",projectStatus:null==u?void 0:u.status,onPublish:e0,userSubscription:ec?{tier:ec.tier,messageCount:ec.messageCount,messageLimit:ec.limit,dailyCount:ec.dailyCount||0,monthlyCount:ec.monthlyCount||0,dailyLimit:ec.dailyLimit||0,monthlyLimit:ec.monthlyLimit||0,monthlyBuildSpend:ec.monthlyBuildSpend||0,monthlyBuildCredit:ec.monthlyBuildCredit||0,dailyBuildSpend:ec.dailyBuildSpend||0,dailyBuildCredit:ec.dailyBuildCredit||0}:void 0,domains:(null==u?void 0:u.domains)||[],onSubscriptionClick:()=>ea(!0),onGeneratePreview:eQ,projectContracts:(null==u?void 0:u.contracts)||[],projectSupabaseProjectId:null==u?void 0:u.supabaseProjectId,projectIsInternalDatabase:null==u?void 0:u.isInternalDatabase,projectStripeAccountId:null==u?void 0:u.stripeAccountId,onContractsDeployed:eZ,onTryToFixIt:eH,onSaveAllChanges:e5,"data-sentry-element":"Header","data-sentry-source-file":"index.tsx"}),!E&&(0,n.jsx)(tI,{activeTab:T,onTabChange:e_,isLoading:N})]}),E?(0,n.jsxs)("main",{className:"fixed left-0 right-0 top-[56px] bottom-[56px] overflow-hidden",children:[(0,n.jsx)("div",{className:"".concat("chat"!==T?"hidden":"flex"," h-full flex-col"),children:(0,n.jsx)(tE,{ref:eR,initialPrompt:Z,onSendMessage:eX,onBeforeSendMessage:eq,onStopProject:e2,isLoading:N,projectId:"string"==typeof t?t:"",projectPreview:(null==u?void 0:u.preview)||"",projectStatus:(null==u?void 0:u.status)||"draft",hideHeader:!0,onRestorePreview:e$,restoringPreview:eh||"",onErrorClick:e1,onTryToFixIt:eH,isMobile:E,platform:(null==u?void 0:u.platform)||"website",statusPercentage:null==u?void 0:u.statusPercentage,statusRemainingTime:null==u?void 0:u.statusRemainingTime})}),(0,n.jsx)("div",{className:"".concat("chat"===T?"hidden":"flex"," h-full"),children:(0,n.jsx)("div",{className:"bg-white dark:bg-gray-800 flex-1 flex flex-col h-full rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700",children:N?(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center h-full px-8",children:[(0,n.jsxs)("svg",{className:"animate-spin h-10 w-10 text-primary mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,n.jsx)("p",{className:"text-gray-600 dark:text-gray-300 text-center mb-4",children:k}),(null==u?void 0:u.statusPercentage)!==void 0&&u.statusPercentage>0&&(0,n.jsx)(tC,{percentage:u.statusPercentage,remainingTime:u.statusRemainingTime,className:"w-full max-w-xs"})]}):ek?(0,n.jsx)("div",{className:"h-full relative",children:(0,n.jsx)(tT,{isOpen:!0,onClose:()=>{eC(!1),E&&q("chat")},errorMessage:eS,onTryToFixIt:()=>eH(eS),timestamp:eT})}):"code"===T?(0,n.jsxs)("div",{className:"h-full w-full flex flex-col",children:[(0,n.jsx)(tx,{projectPlatform:(null==u?void 0:u.platform)||"website",projectSlug:null==u?void 0:u.slug,onDownload:e3,isDownloading:eA,onSaveAllChanges:e5,whitelabelConfig:ef,isWhitelabel:ep}),(0,n.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,n.jsx)(S,{onSaveAllChanges:eZ})})]}):"preview"===T?(0,n.jsxs)("div",{className:"h-full flex flex-col",children:[(0,n.jsx)(tx,{onRefreshPreview:e4,projectPlatform:(null==u?void 0:u.platform)||"website",onSaveAllChanges:e6,whitelabelConfig:ef,isWhitelabel:ep}),(0,n.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,n.jsx)(eY,{previewSlug:(null==u?void 0:u.preview)||"",onTryToFixIt:eH,onSaveAllChanges:eZ,onFilesUpdate:e=>{console.log("FILES_UPDATE",JSON.stringify({event:"files_updated_from_inspector",fileCount:Object.keys(e).length})),eO(e),eM(!0)},onUnsavedChangesUpdate:(e,t)=>{console.log("UNSAVED",JSON.stringify({event:"parent_received_update",hasChanges:e,fileCount:Object.keys(t).length})),eM(e),eO(t)},platform:(null==u?void 0:u.platform)||"website",projectData:u?{supabaseProjectUrl:u.supabaseProjectUrl,supabaseAnonKey:u.supabaseAnonKey}:void 0})})]}):null})})]}):(0,n.jsx)("main",{className:"flex-1 w-full px-2",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-7 gap-2 h-[calc(100vh-68px)]",children:[(0,n.jsx)("div",{className:"lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700",children:(0,n.jsx)(tE,{ref:eR,initialPrompt:Z,onSendMessage:eX,onBeforeSendMessage:eq,onStopProject:e2,isLoading:N,projectId:"string"==typeof t?t:"",projectPreview:(null==u?void 0:u.preview)||"",projectStatus:(null==u?void 0:u.status)||"draft",hideHeader:!0,onRestorePreview:e$,restoringPreview:eh||"",onErrorClick:e1,onTryToFixIt:eH,isMobile:E,platform:(null==u?void 0:u.platform)||"website",statusPercentage:null==u?void 0:u.statusPercentage,statusRemainingTime:null==u?void 0:u.statusRemainingTime})}),(0,n.jsx)("div",{className:"lg:col-span-5 flex flex-col h-full",children:(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-800 flex-1 flex flex-col h-full rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700",children:[(0,n.jsx)(tx,{onRefreshPreview:e4,projectPlatform:(null==u?void 0:u.platform)||"website",projectSlug:null==u?void 0:u.slug,onDownload:e3,isDownloading:eA,onSaveAllChanges:e6,whitelabelConfig:ef,isWhitelabel:ep}),(0,n.jsx)("div",{className:"flex-1 overflow-hidden p-0",children:N?(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center h-full px-8",children:[(0,n.jsxs)("svg",{className:"animate-spin h-10 w-10 text-primary mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,n.jsx)("p",{className:"text-gray-600 dark:text-gray-300 text-center mb-4",children:k}),(null==u?void 0:u.statusPercentage)!==void 0&&u.statusPercentage>0&&(0,n.jsx)(tC,{percentage:u.statusPercentage,remainingTime:u.statusRemainingTime,className:"w-full max-w-xs"})]}):ek?(0,n.jsx)("div",{className:"h-full relative",children:(0,n.jsx)(tT,{isOpen:!0,onClose:()=>eC(!1),errorMessage:eS,onTryToFixIt:()=>eH(eS),timestamp:eT})}):(0,n.jsx)("div",{className:"h-full rounded-md overflow-hidden",children:(0,n.jsx)(eY,{previewSlug:(null==u?void 0:u.preview)||"",onTryToFixIt:eH,onSaveAllChanges:eZ,onFilesUpdate:e=>{console.log("FILES_UPDATE",JSON.stringify({event:"files_updated_from_inspector",fileCount:Object.keys(e).length})),eO(e),eM(!0)},onUnsavedChangesUpdate:(e,t)=>{console.log("UNSAVED",JSON.stringify({event:"parent_received_update",hasChanges:e,fileCount:Object.keys(t).length})),eM(e),eO(t)},platform:(null==u?void 0:u.platform)||"website",projectData:u?{supabaseProjectUrl:u.supabaseProjectUrl,supabaseAnonKey:u.supabaseAnonKey}:void 0})})})]})})]})}),E&&(0,n.jsx)(tA,{activeTab:T,onTabChange:e_,previewSlug:(null==u?void 0:u.preview)||""}),ec&&(0,n.jsx)(tp.A,{isOpen:en,onClose:()=>{ea(!1)},currentTier:ec.tier,currentUsage:ec.messageCount,currentLimit:ec.limit,subscriptionData:ec}),er&&er.length>0&&(0,n.jsx)(G,{isOpen:eo,onClose:()=>ei(!1),pendingContracts:er,onContractsDeployed:eZ,onTryToFixIt:eH}),eb&&eb.hasUnpaidCharges&&(0,n.jsx)(tF,{isOpen:ev,onClose:()=>ej(!1),onPaymentSuccess:e8,totalUnpaidAmount:eb.totalUnpaidAmount,failedCharges:eb.failedCharges}),ew&&(0,n.jsx)(tB,{isOpen:ew,onClose:()=>eN(!1),onWakeUp:async()=>{D({isSleeping:!1})},subscriptionData:ec})]}):(0,n.jsx)("div",{className:"p-8 text-center",children:"Loading..."}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[834,1106,2146,8807,2048,8216,9345,802,636,6593,8792],()=>t(60373)),_N_E=e.O()}]);